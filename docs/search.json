[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Occupancy in Protected Areas",
    "section": "",
    "text": "We want to asses the effect of protected areas on the occupancy of the species. We hypothesize that several mammal species have benefited of the conservation actions provided by protected areas, so we expect a decreases in occupancy from the interior of the protected area to the exterior as a function of the distance to the protected area border. We used a multispecies occupancy model incorporating spatial autocorrelation, to asses occupancy as a function of the distance to the protected area border.\nTo account for several ecological factors we also tested and included elevation and forest integrity index (FLII) as occupancy covariates.\nWe used the newly developed R package spOccupancy as approach to modelling the probability of occurrence of each species as a function of fixed effects of measured environmental covariates and random effects designed to account for unobserved sources of spatial dependence (spatial autocorrelation).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe problem we want to asses\n\n\n\nmodel\n\n\n\n\nMay 20, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nFitting a Spatial Factor Multi-Species Occupancy Model\n\n\n\nmodel\n\ncode\n\nanalysis\n\n\n\n\nMay 16, 2025\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "blog/2025-10-10-the-model/index.html",
    "href": "blog/2025-10-10-the-model/index.html",
    "title": "The problem we want to asses",
    "section": "",
    "text": "Codelibrary(grateful) # Facilitate Citation of R Packages\nlibrary(readxl) # Read Excel Files\nlibrary(DT) # A Wrapper of the JavaScript Library 'DataTables'\nlibrary(sf) # Simple Features for R\nlibrary(mapview) # Interactive Viewing of Spatial Data in R\nlibrary(maps) # Draw Geographical Maps\nlibrary(tmap) # Thematic Maps\nlibrary(terra) # Spatial Data Analysis\nlibrary(elevatr) # Access Elevation Data from Various APIs\nlibrary(unmarked) # Models for Data from Unmarked Animals\nlibrary(ubms) # Bayesian Models for Data from Unmarked Animals using 'Stan'\n\nlibrary(tidyverse) # Easily Install and Load the 'Tidyverse'\nWe want to Asses the role of Protected Areas (PA) in the conservation of vertebrates using on the ground data.\nEvaluating whether PA are working is essential as they are perhaps the primary strategy for averting biodiversity loss. Its been suggested that some do no work, paper parks Its crucial to continue working on best methods to evaluate their impact.\nOver a decade ago researchers started evaluating role of PA, mostly focused on the effects of PA in reducing threats (fires, deforestation) and focused on forest cover. However assessments of PA on species comparing inside vs outside is not a common practice.\nEven if we are effective in protecting forests, and the forest is in very good condition, PA could have “empty forests” and loosed biodiversity (by hunting-poaching, diseases or introduced species). So when we say a PA is effective, are we looking at this?\nWe want to compare apples with apples and control for covariates related with occupancy and abundance of species, like elevation, human pressures, ecosystem type, etc.\nOccupancy is a cost effective method for evaluation a population, it is a state variable, representing the proportion of the area occupied by the species, solving the problem of imperfect detection.\nWe compiled camera trap deployment data sets that have intentionally sampled inside and outside PAS, in a quasi-experimental design, using camera traps.\nEach case each camera is adequately matched, in a similar fashion as the remote sensing approaches.\nWe used a multispecies occupancy model, and a variation incorporating spatial autocorrelation, to compare occupancy inside and outside the PA and also as a distance to the protected area border."
  },
  {
    "objectID": "blog/2025-10-10-the-model/index.html#package-citation",
    "href": "blog/2025-10-10-the-model/index.html#package-citation",
    "title": "The problem we want to asses",
    "section": "Package Citation",
    "text": "Package Citation\n\nCodepkgs &lt;- cite_packages(output = \"paragraph\", pkgs=\"Session\", out.dir = \".\")\n# knitr::kable(pkgs)\npkgs\n\nWe used R v. 4.4.2 (R Core Team 2024) and the following R packages: DT v. 0.34.0 (Xie et al. 2025), elevatr v. 0.99.0 (Hollister et al. 2023), maps v. 3.4.3 (Becker et al. 2025), mapview v. 2.11.4 (Appelhans et al. 2025), sf v. 1.0.21 (Pebesma 2018; Pebesma and Bivand 2023), terra v. 1.8.60 (Hijmans 2025), tidyverse v. 2.0.0 (Wickham et al. 2019), tmap v. 4.2 (Tennekes 2018), ubms v. 1.2.7 (Kellner et al. 2021), unmarked v. 1.5.0 (Fiske and Chandler 2011; Kellner et al. 2023)."
  },
  {
    "objectID": "blog/2025-10-10-the-model/index.html#sesion-info",
    "href": "blog/2025-10-10-the-model/index.html#sesion-info",
    "title": "The problem we want to asses",
    "section": "Sesion info",
    "text": "Sesion info\n\n\n\n\n\n\nNote\n\n\n\n\n\n\nCodeprint(sessionInfo(), locale = FALSE)\n\nR version 4.4.2 (2024-10-31 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] lubridate_1.9.4 forcats_1.0.0   stringr_1.5.2   dplyr_1.1.4    \n [5] purrr_1.1.0     readr_2.1.5     tidyr_1.3.1     tibble_3.2.1   \n [9] ggplot2_4.0.0   tidyverse_2.0.0 ubms_1.2.7      unmarked_1.5.0 \n[13] elevatr_0.99.0  terra_1.8-60    tmap_4.2        maps_3.4.3     \n[17] mapview_2.11.4  sf_1.0-21       DT_0.34.0       readxl_1.4.3   \n[21] grateful_0.3.0 \n\nloaded via a namespace (and not attached):\n [1] DBI_1.2.3            pbapply_1.7-2        gridExtra_2.3       \n [4] tmaptools_3.3        s2_1.1.9             inline_0.3.20       \n [7] logger_0.4.0         rlang_1.1.6          magrittr_2.0.3      \n[10] matrixStats_1.5.0    e1071_1.7-16         compiler_4.4.2      \n[13] loo_2.8.0            png_0.1-8            vctrs_0.6.5         \n[16] pkgconfig_2.0.3      wk_0.9.4             fastmap_1.2.0       \n[19] lwgeom_0.2-14        leafem_0.2.4         rmarkdown_2.29      \n[22] tzdb_0.4.0           spacesXYZ_1.6-0      xfun_0.52           \n[25] satellite_1.0.5      jsonlite_2.0.0       parallel_4.4.2      \n[28] R6_2.6.1             stringi_1.8.4        RColorBrewer_1.1-3  \n[31] StanHeaders_2.32.10  cellranger_1.1.0     stars_0.6-8         \n[34] Rcpp_1.1.0           rstan_2.32.6         knitr_1.50          \n[37] base64enc_0.1-3      timechange_0.3.0     Matrix_1.7-1        \n[40] tidyselect_1.2.1     rstudioapi_0.17.1    dichromat_2.0-0.1   \n[43] abind_1.4-8          yaml_2.3.10          maptiles_0.10.0     \n[46] codetools_0.2-20     curl_7.0.0           pkgbuild_1.4.8      \n[49] lattice_0.22-6       leafsync_0.1.0       withr_3.0.2         \n[52] S7_0.2.0             evaluate_1.0.4       units_0.8-7         \n[55] proxy_0.4-27         RcppParallel_5.1.9   pillar_1.11.1       \n[58] KernSmooth_2.23-24   stats4_4.4.2         generics_0.1.3      \n[61] sp_2.2-0             hms_1.1.3            rstantools_2.4.0    \n[64] scales_1.4.0         class_7.3-22         glue_1.8.0          \n[67] tools_4.4.2          leaflegend_1.2.1     data.table_1.17.8   \n[70] RSpectra_0.16-2      XML_3.99-0.18        grid_4.4.2          \n[73] QuickJSR_1.4.0       crosstalk_1.2.1      colorspace_2.1-1    \n[76] cols4all_0.8-1       raster_3.6-32        cli_3.6.5           \n[79] V8_6.0.0             gtable_0.3.6         digest_0.6.37       \n[82] progressr_0.15.0     classInt_0.4-11      htmlwidgets_1.6.4   \n[85] farver_2.1.2         htmltools_0.5.8.1    lifecycle_1.0.4     \n[88] leaflet_2.2.3        microbenchmark_1.5.0 MASS_7.3-61"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html",
    "href": "blog/2025-10-15-analysis/index.html",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "",
    "text": "Single-species occupancy models (MacKenzie et al., 2002) are widely used in ecology to estimate and predict the spatial distribution of a species from data collected in presence–absence repeated surveys. The popularity of these models stems from their ability to estimate the effects of environmental or management covariates on species occurrences, while accounting for false-negative errors in detection, which are common in surveys of natural populations."
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html#multi-species-occupancy-model-using-spoccupancy",
    "href": "blog/2025-10-15-analysis/index.html#multi-species-occupancy-model-using-spoccupancy",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "",
    "text": "Multi-species occupancy models are a powerful tool for combining information from multiple species to estimate both individual and community-level responses to management and environmental variables.\n\nCodelibrary(grateful)\nlibrary(readxl)\nlibrary(DT)\nlibrary(sf)\nlibrary(mapview)\nlibrary(maps)\nlibrary(tmap)\nlibrary(terra)\nlibrary(elevatr)\n#library(spOccupancy)\n\n# library(rjags) # Bayesian Graphical Models using MCMC \nlibrary(bayesplot) # Plotting for Bayesian Models # Plotting for Bayesian Models\nlibrary(tictoc) # Functions for Timing R Scripts, as Well as Implementations of \"Stack\" and \"StackList\" Structures \nlibrary(MCMCvis)\nlibrary(coda)\nlibrary(beepr) # Easily Play Notification Sounds on any Platform \nlibrary(snowfall) # Easier Cluster Computing (Based on 'snow')\n\n#library(ggmcmc)\nlibrary(camtrapR)\nlibrary(spOccupancy)\nlibrary(tidyverse)"
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html#fitting-a-multi-species-spatial-occupancy-model",
    "href": "blog/2025-10-15-analysis/index.html#fitting-a-multi-species-spatial-occupancy-model",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "Fitting a Multi-Species Spatial Occupancy Model",
    "text": "Fitting a Multi-Species Spatial Occupancy Model\nWe use a more computationally efficient approach for fitting spatial multi-species occupancy models. This alternative approach is called a “spatial factor multi-species occupancy model”, and is described in depth in Doser, Finley, and Banerjee (2023). This newer approach also accounts for residual species correlations (i.e., it is a joint species distribution model with imperfect detection). The simulation results from Doser, Finley, and Banerjee (2023) show that this new alternative approach outperforms, or performs equally to spMsPGOcc(), while being substantially faster.\nThe Latent factor multi-species occupancy model is described in detail here\nData fom Bajo Madidi and Heath\nHere we use the tables BOL-008a - BOL-008b and BOL14a - BOL14b\n\nCodesource(\"C:/CodigoR/WCS-CameraTrap/R/organiza_datos_v3.R\")\n\nArea_Madidi &lt;- read_sf(\"C:/CodigoR/Occu_APs/shp/Area_Madidi/WDPA_WDOECM_Jul2025_Public_303894_shp-polygons.shp\")\n\nMadidi_NP &lt;- read_sf(\"C:/CodigoR/Occu_APs/shp/Madidi_NP/WDPA_WDOECM_Jul2025_Public_98183_shp-polygons.shp\")\n#AP_Tahuayo &lt;- read_sf(\"C:/CodigoR/Occu_APs/shp/Tahuayo/WDPA_WDOECM_Jun2025_Public_555555621_shp-polygons.shp\")\n\n# load data and make array_locID column\n#Bol_Pacaya &lt;- read_excel(\"F:/WCS-CameraTrap/data/BDcorregidas/Peru/PER-003_BD_ACRCTT_T0.xlsx\", sheet = \"Image\")\n\n\nBol_Madidi_1 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Bolivia/Guido/BOL-008a.xlsx\") |&gt; mutate(Point.x=as.character(paste(\"M1\",Point.x, sep = \"-\"))) |&gt; mutate(Point.y=as.character(paste(\"M1\",Point.y, sep = \"-\")))\n\n65 cameras in Cameras. \n 61 cameras in Deployment. \n 61 deployments in Deployment. \n 31 points in Deployment. \n 61 cameras in Images. \n 31 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2005 \n Jaguar_Design: yes \n\nCodeBol_Madidi_2 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Bolivia/Guido/BOL-008b.xlsx\") |&gt; mutate(Point.x=as.character(paste(\"M2\",Point.x, sep = \"-\"))) |&gt; mutate(Point.y=as.character(paste(\"M2\",Point.y, sep = \"-\")))\n\n60 cameras in Cameras. \n 52 cameras in Deployment. \n 52 deployments in Deployment. \n 30 points in Deployment. \n 51 cameras in Images. \n 30 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2005 \n Jaguar_Design: yes \n\nCodeBol_Madidi_3 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Bolivia/Guido/BOL-014a.xlsx\")|&gt; mutate(Point.x=as.character(paste(\"M3\",Point.x, sep = \"-\"))) |&gt; mutate(Point.y=as.character(paste(\"M3\",Point.y, sep = \"-\")))\n\n47 cameras in Cameras. \n 44 cameras in Deployment. \n 44 deployments in Deployment. \n 26 points in Deployment. \n 44 cameras in Images. \n 26 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2009 \n Jaguar_Design: yes \n\nCodeBol_Madidi_4 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Bolivia/Guido/BOL-014b.xlsx\")|&gt; mutate(Point.x=as.character(paste(\"M4\",Point.x, sep = \"-\"))) |&gt; mutate(Point.y=as.character(paste(\"M1\",Point.y, sep = \"-\")))\n\n29 cameras in Cameras. \n 22 cameras in Deployment. \n 22 deployments in Deployment. \n 15 points in Deployment. \n 22 cameras in Images. \n 15 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2009 \n Jaguar_Design: yes \n\nCode# get sites\nBol_Madidi_sites1 &lt;-  Bol_Madidi_1 |&gt; \n   dplyr::bind_rows(Bol_Madidi_2) |&gt; \n   dplyr::bind_rows(Bol_Madidi_3) |&gt; \n   dplyr::bind_rows(Bol_Madidi_4) |&gt; \n  select(\"Latitude\", \"Longitude\", \"Point.x\" \n) |&gt; dplyr::distinct( )  \n\nBol_Madidi_sites &lt;- sf::st_as_sf(Bol_Madidi_sites1, coords = c(\"Longitude\",\"Latitude\"))\nst_crs(Bol_Madidi_sites) &lt;- 4326\n\n\n# get elevation map\nelevation_17 &lt;- rast(get_elev_raster(Bol_Madidi_sites, z = 9)) #z =1-14\n\nMosaicing & Projecting\nNote: Elevation units are in meters.\n\nCode# bb &lt;-  st_as_sfc(st_bbox(elevation_17)) # make bounding box \n\n\n\n# extract covs using points and add to _sites\ncovs_Bol_Madidi_sites &lt;- cbind(Bol_Madidi_sites, terra::extract(elevation_17, Bol_Madidi_sites))\n# covs_Ecu_17_sites &lt;- cbind(Ecu_17_sites, terra::extract(elevation_17, Ecu_17_sites))\n\n\n# get which are in and out\ncovs_Bol_Madidi_sites$in_AP = st_intersects(covs_Bol_Madidi_sites, Madidi_NP, sparse = FALSE)\n# covs_Ecu_17_sites$in_AP = st_intersects(covs_Ecu_17_sites, AP_Machalilla, sparse = FALSE)\n\n\n# make a map\nmapview (elevation_17, alpha=0.7) + \n  mapview (Madidi_NP, color = \"green\", col.regions = \"green\", alpha = 0.5) +\n  mapview (Area_Madidi, color = \"yellow\", col.regions = \"yellow\", alpha = 0.5) +\n  #mapview (AP_Tahuayo, color = \"green\", col.regions = \"green\", alpha = 0.5) +\n  mapview (covs_Bol_Madidi_sites, zcol = \"in_AP\", col.regions =c(\"red\",\"blue\"), burst = TRUE) \n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 516558 to avoid this.\n\n\n\n\n\n\nTamshiyacu Tahuayo data\nHere we use the tables: - PER-003_BD_ACRCTT_T0.xlsx - PER-002_BD_ACRTT-PILOTO.xlsx\n\nCodesource(\"C:/CodigoR/WCS-CameraTrap/R/organiza_datos_v3.R\")\n\nAP_Pacaya &lt;- read_sf(\"C:/CodigoR/Occu_APs/shp/PacayaSamiria/WDPA_WDOECM_Jun2025_Public_249_shp-polygons.shp\")\n\nAP_Tahuayo &lt;- read_sf(\"C:/CodigoR/Occu_APs/shp/Tahuayo/WDPA_WDOECM_Jun2025_Public_555555621_shp-polygons.shp\")\n\n# load data and make array_locID column\nPer_Tahuayo_piloto &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Peru/PER-002_BD_ACRTT-PILOTO.xlsx\")\n\n50 cameras in Cameras. \n 50 cameras in Deployment. \n 50 deployments in Deployment. \n 50 points in Deployment. \n 50 cameras in Images. \n 50 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2015 \n Jaguar_Design: no \n\nCodePer_Tahuayo &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Peru/PER-003_BD_ACRCTT_T0.xlsx\")\n\n85 cameras in Cameras. \n 84 cameras in Deployment. \n 84 deployments in Deployment. \n 84 points in Deployment. \n 84 cameras in Images. \n 84 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2016 \n Jaguar_Design: no \n\nCodeFLII2016 &lt;- rast(\"C:/CodigoR/WCS_2024/FLI/raster/FLII_final/FLII_2016.tif\")\n\n# get sites\n# Per_Pacaya_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Peru/PER-003_BD_ACRCTT_T0.xlsx\")\n\n# get sites\nPer_Tahuayo_sites1 &lt;- Per_Tahuayo |&gt; select(\"Latitude\",\n                                    \"Longitude\",\n                                    \"Camera_Id\" \n                                    ) |&gt; dplyr::distinct( )  \n\nPer_Tahuayo_sites &lt;- sf::st_as_sf(Per_Tahuayo_sites1, coords = c(\"Longitude\",\"Latitude\"))\nst_crs(Per_Tahuayo_sites) &lt;- 4326\n\n\n\n# get Pacaya sites\nPer_Tahuayo_piloto_sites1 &lt;- Per_Tahuayo_piloto |&gt; select(\"Latitude\",\n                                    \"Longitude\",\n                                    \"Camera_Id\" \n                                    ) |&gt; dplyr::distinct( )  \n\nPer_Tahuayo_piloto_sites &lt;- sf::st_as_sf(Per_Tahuayo_piloto_sites1, coords = c(\"Longitude\",\"Latitude\"))\nst_crs(Per_Tahuayo_piloto_sites) &lt;- 4326\n\n\n\n\n# get elevation map\nelevation_PE &lt;- rast(get_elev_raster(Per_Tahuayo_sites, z = 10)) #z =1-14\n\nMosaicing & Projecting\nNote: Elevation units are in meters.\n\nCode# bb &lt;-  st_as_sfc(st_bbox(elevation_17)) # make bounding box \n\n\n\n\n\n# extract covs using points and add to _sites\ncovs_Per_Tahuayo_sites &lt;- cbind(Per_Tahuayo_sites,\n                                terra::extract(elevation_PE,\n                                               Per_Tahuayo_sites)\n                                )\n\n# extract covs using points and add to _sites\ncovs_Per_Tahuayo_piloto_sites &lt;- cbind(Per_Tahuayo_piloto_sites, terra::extract(elevation_PE, Per_Tahuayo_piloto_sites))\n\n\n\n# get which are in and out\ncovs_Per_Tahuayo_sites$in_AP = st_intersects(covs_Per_Tahuayo_sites, AP_Tahuayo, sparse = FALSE)\n\ncovs_Per_Tahuayo_piloto_sites$in_AP = st_intersects(covs_Per_Tahuayo_piloto_sites, AP_Tahuayo, sparse = FALSE)\n\n\n\n\n# make a map\nmapview (elevation_PE, alpha=0.5) + \n  mapview (AP_Pacaya, color = \"green\", col.regions = \"green\", alpha = 0.5) +\n  mapview (AP_Tahuayo, color = \"green\", col.regions = \"green\", alpha = 0.5) +\n  mapview (covs_Per_Tahuayo_sites, zcol = \"in_AP\", col.regions =c(\"red\",\"blue\"), burst = TRUE) +   \n  mapview (covs_Per_Tahuayo_piloto_sites, \n           zcol = \"in_AP\", \n           col.regions =c(\"blue\"), \n           burst = TRUE) \n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 523775 to avoid this.\n\n\n\n\n\n\nYasuni data\nHere we use the tables Ecu-13, Ecu-17, Ecu-18 y Ecu-20\n\nCodesource(\"C:/CodigoR/WCS-CameraTrap/R/organiza_datos_v3.R\")\n\nAP_Yasuni &lt;- read_sf(\"C:/CodigoR/Occu_APs/shp/Yasuni/WDPA_WDOECM_May2025_Public_186_shp-polygons.shp\")\n\n### Ecu 17, Ecu 18, ECU 20, Ecu 22  \n\n# load data and make array_locID column\nEcu_13 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-013.xlsx\") |&gt; mutate(array_locID=paste(\"Ecu_13\", locationID, sep=\"_\"))\n\n28 cameras in Cameras. \n 28 cameras in Deployment. \n 28 deployments in Deployment. \n 28 points in Deployment. \n 28 cameras in Images. \n 28 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2015 \n Jaguar_Design: no \n\nCodeEcu_17 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-017.xlsx\") |&gt; mutate(array_locID=paste(\"Ecu_17\", locationID, sep=\"_\"))\n\n30 cameras in Cameras. \n 30 cameras in Deployment. \n 30 deployments in Deployment. \n 30 points in Deployment. \n 30 cameras in Images. \n 30 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2015 \n Jaguar_Design: no \n\nCodeEcu_18 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-018.xlsx\")|&gt; mutate(array_locID=paste(\"Ecu_18\", locationID, sep=\"_\"))\n\n30 cameras in Cameras. \n 30 cameras in Deployment. \n 30 deployments in Deployment. \n 30 points in Deployment. \n 30 cameras in Images. \n 30 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2016 \n Jaguar_Design: no \n\nCodeEcu_20 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-020_Fix.xlsx\")|&gt; mutate(array_locID=paste(\"Ecu_20\", locationID, sep=\"_\"))\n\n30 cameras in Cameras. \n 25 cameras in Deployment. \n 25 deployments in Deployment. \n 25 points in Deployment. \n 25 cameras in Images. \n 25 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2018 \n Jaguar_Design: no \n\nCode# Ecu_21 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-021.xlsx\") |&gt; mutate(array_locID=paste(\"Ecu_14\", locationID, sep=\"_\"))\nEcu_22 &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-022.xlsx\")|&gt; mutate(array_locID=paste(\"Ecu_22\", locationID, sep=\"_\"))\n\nWarning: Expecting numeric in O5508 / R5508C15: got 'NA'\n\n\nWarning: Expecting numeric in O5509 / R5509C15: got 'NA'\n\n\nWarning: Expecting numeric in O5510 / R5510C15: got 'NA'\n\n\nWarning: Expecting numeric in O5511 / R5511C15: got 'NA'\n\n\nWarning: Expecting numeric in O5512 / R5512C15: got 'NA'\n\n\n30 cameras in Cameras. \n 30 cameras in Deployment. \n 30 deployments in Deployment. \n 30 points in Deployment. \n 30 cameras in Images. \n 30 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2018 \n Jaguar_Design: no \n\nCode# get sites\nEcu_13_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-013.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCodeEcu_17_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-017.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCodeEcu_18_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-018.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCodeEcu_20_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-020_Fix.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCode# Ecu_21_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-021.xlsx\")\nEcu_22_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Ecuador/ECU-022.xlsx\")\n\nJoining with `by = join_by(Camera_Id)`\nJoining with `by = join_by(Point)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType)`\nJoining with `by = join_by(Point, Longitude, Latitude, bait, season, rio_playa,\narroyo, camino, senda_animal, senda_gente, salitral, pozo_agua, bosque, sabana,\nintermedio, intervalo_trigger, CamType, Deployment_ID, start_date, end_date,\n`Bait Type`, `Feature Type`, `Feature Type methodology`, Camera_Id, `Quiet\nPeriod Setting`, `Restriction on Access`, `Camera Failure Details`, `Project\nId`, Make, Model, `Serial Number`, Year_Purchased)`\n\nCode# get elevation map\nelevation_EC &lt;- rast(get_elev_raster(Ecu_17_sites, z = 7)) #z =1-14\n\nMosaicing & Projecting\nNote: Elevation units are in meters.\n\nCodebb &lt;-  st_as_sfc(st_bbox(elevation_EC)) # make bounding box \n\n\n\n\n# extract covs using points and add to _sites\ncovs_Ecu_13_sites &lt;- cbind(Ecu_13_sites, terra::extract(elevation_EC, Ecu_13_sites))\ncovs_Ecu_17_sites &lt;- cbind(Ecu_17_sites, terra::extract(elevation_EC, Ecu_17_sites))\ncovs_Ecu_18_sites &lt;- cbind(Ecu_18_sites, terra::extract(elevation_EC, Ecu_18_sites))\ncovs_Ecu_20_sites &lt;- cbind(Ecu_20_sites, terra::extract(elevation_EC, Ecu_20_sites))\n#covs_Ecu_21_sites &lt;- cbind(Ecu_21_sites, terra::extract(elevation_17, Ecu_21_sites))\ncovs_Ecu_22_sites &lt;- cbind(Ecu_22_sites, terra::extract(elevation_EC, Ecu_22_sites))\n\n# get which are in and out\ncovs_Ecu_13_sites$in_AP = st_intersects(covs_Ecu_13_sites, AP_Yasuni, sparse = FALSE)\ncovs_Ecu_17_sites$in_AP = st_intersects(covs_Ecu_17_sites, AP_Yasuni, sparse = FALSE)\ncovs_Ecu_18_sites$in_AP = st_intersects(covs_Ecu_18_sites, AP_Yasuni, sparse = FALSE)\ncovs_Ecu_20_sites$in_AP = st_intersects(covs_Ecu_20_sites, AP_Yasuni, sparse = FALSE)\n#covs_Ecu_21_sites$in_AP = st_intersects(covs_Ecu_21_sites, AP_Yasuni, sparse = FALSE)\ncovs_Ecu_22_sites$in_AP = st_intersects(covs_Ecu_22_sites, AP_Yasuni, sparse = FALSE)\n\n# covs_Ecu_16_sites$in_AP = st_intersects(covs_Ecu_16_sites, AP_Llanganates, sparse = FALSE)\n\n\n\n# make a map\nmapview (elevation_EC, alpha=0.5) + \n  mapview (AP_Yasuni, color = \"green\", col.regions = \"green\", alpha = 0.5) +\n  mapview (covs_Ecu_13_sites, zcol = \"in_AP\", col.regions =c(\"red\"), burst = TRUE) +\n  mapview (covs_Ecu_17_sites, zcol = \"in_AP\", col.regions =c(\"red\",\"blue\"), burst = TRUE) +\n  mapview (covs_Ecu_18_sites, zcol = \"in_AP\", col.regions =c(\"red\"), burst = TRUE) +\n  mapview (covs_Ecu_20_sites, zcol = \"in_AP\", col.regions =c(\"red\",\"blue\"), burst = TRUE) +\n#  mapview (covs_Ecu_21_sites, zcol = \"in_AP\", col.regions =c(\"red\"), burst = TRUE) +\n  mapview (covs_Ecu_22_sites, zcol = \"in_AP\", burst = TRUE, col.regions = c(\"red\") ) #+\n\n\n\n\nCode  # mapview (covs_Ecu_16_sites, zcol = \"in_AP\", burst = TRUE, col.regions =c(\"red\",\"blue\")) \n\n\nCamera trap operation data and detection history\n\nCode# Join 3 tables\n# fix count in ECU 13, 17, 22,\nEcu_13$Count &lt;- as.character(Ecu_13$Count)\nEcu_17$Count &lt;- as.character(Ecu_17$Count)\nEcu_22$Count &lt;- as.character(Ecu_22$Count)\n\nEcu_full &lt;- Ecu_13 |&gt; full_join(Ecu_17) |&gt; \n                      full_join(Ecu_18) |&gt; \n                      full_join(Ecu_20) |&gt; \n#                      full_join(Ecu_21) |&gt; \n                      full_join(Ecu_22)\n\n###### Bolivia\n\nBol_full &lt;- Bol_Madidi_1  |&gt; \n   full_join(Bol_Madidi_2) |&gt; \n   full_join(Bol_Madidi_3) |&gt; \n   full_join(Bol_Madidi_4) \n# change camera Id by point. two cameras in one\nBol_full &lt;- Bol_full |&gt; mutate(Camera_Id=Point.x)\n\n\n# Ecu_18$Count &lt;- as.numeric(Ecu_18$Count)\nPer_Tahuayo_piloto$Longitude &lt;- as.numeric(Per_Tahuayo_piloto$Longitude)\nPer_Tahuayo_piloto$Latitude &lt;- as.numeric(Per_Tahuayo_piloto$Latitude)\n\n\nPer_full &lt;- Per_Tahuayo|&gt; \n  full_join(Per_Tahuayo_piloto) #|&gt; \n                      # full_join(Ecu_18) |&gt; \n                      # full_join(Ecu_20) |&gt; \n                      # full_join(Ecu_21) |&gt; \n                      # full_join(Ecu_22)\n\n# rename camera id\n# Per_full$camid &lt;- Per_full$`Camera_Id`\n\nEcu_full$Count &lt;- as.numeric(Ecu_full$Count)\nPer_full$Count &lt;- as.numeric(Per_full$Count)\n\nEcu_full &lt;- Ecu_full[,-47]\n\n##################################\ndata_full &lt;- rbind(Ecu_full, \n                   Per_full,\n                   Bol_full)\n\n\n# fix date format\n# \n# Formatting a Date object\ndata_full$start_date &lt;- as.Date(data_full$\"start_date\", \"%Y/%m/%d\")\ndata_full$start_date &lt;- format(data_full$start_date, \"%Y-%m-%d\")\n\ndata_full$end_date &lt;- as.Date(data_full$\"end_date\", \"%Y/%m/%d\")\ndata_full$end_date &lt;- format(data_full$end_date, \"%Y-%m-%d\")\n\ndata_full$eventDate &lt;- as.Date(data_full$\"Date_Time_Captured\", \"%Y/%m/%d\")\ndata_full$eventDate &lt;- format(data_full$eventDate, \"%Y-%m-%d\")\n\n# Per_full$eventDateTime &lt;- ymd_hms(paste(Per_full$\"photo_date\", Per_full$\"photo_time\", sep=\" \"))\ndata_full$eventDateTime &lt;- ymd_hms(data_full$\"Date_Time_Captured\")\n\n###############################\n# remove duplicated cameras\n################################\nind1 &lt;- which(data_full$Camera_Id==\"ECU-020-C0027\")\nind2 &lt;- which(data_full$Camera_Id==\"ECU-020-C0006\")\ndata_full &lt;- data_full[-ind1,]\ndata_full &lt;- data_full[-ind2,]\n\n\n# filter 2021 and make uniques\nCToperation  &lt;- data_full |&gt; dplyr::group_by(Camera_Id) |&gt; #(array_locID) |&gt; \n                           mutate(minStart=start_date, maxEnd=end_date) |&gt; distinct(Longitude, Latitude, minStart, maxEnd) |&gt; dplyr::ungroup()\n# remove one duplicated\n# View(CToperation)\n# CToperation &lt;- CToperation[-15,]\n\n# M3-19: M3-21: M4-10: M4-12: M4-18:  From Madidi\nCToperation &lt;- CToperation[-c(379, 373, 365, 362, 357),]\n\n\nCToperation[231,3] &lt;- -4.482831 #Latitude\nCToperation[93,3] &lt;- -0.5548211 #Latitude\nCToperation[93,2] &lt;- -76.48333\n\n### remove duplicated\n# View(as.data.frame(table(CToperation$Latitude)))\n# View(as.data.frame(table(CToperation$Longitude)))\n# CToperation &lt;- CToperation[-c(90,94),]\n# Latitude -4.48283\n# Latitude -0.554820969700813\n# Longitude -76.4833290316164\n\n# Generamos la matríz de operación de las cámaras\n\ncamop &lt;- cameraOperation(CTtable= CToperation, # Tabla de operación\n                         stationCol= \"Camera_Id\", # Columna que define la estación\n                         setupCol= \"minStart\", #Columna fecha de colocación\n                         retrievalCol= \"maxEnd\", #Columna fecha de retiro\n                         #hasProblems= T, # Hubo fallos de cámaras\n                         dateFormat= \"%Y-%m-%d\")#, #, # Formato de las fechas\n                         #cameraCol=\"Camera_Id\")\n                         # sessionCol= \"Year\")\n\n# Generar las historias de detección ---------------------------------------\n## remove plroblem species\n\n# Per_full$scientificName &lt;- paste(Per_full$genus, Per_full$species, sep=\" \")\n\n#### remove stups\n# ind &lt;- which(Per_full$scientificName==\"NA NA\")\n# Per_full &lt;- Per_full[-ind,]\n\n# ind &lt;- which(Per_full$scientificName==\"Set up\")\n# Per_full &lt;- Per_full[-ind,]\n# \n# ind &lt;- which(Per_full$scientificName==\"Blank\")\n# Per_full &lt;- Per_full[-ind,]\n# \n# ind &lt;- which(Per_full$scientificName==\"Unidentifiable\")\n# Per_full &lt;- Per_full[-ind,]\n\n\nDetHist_list &lt;- lapply(unique(data_full$scientificName), FUN = function(x) {\n  detectionHistory(\n    recordTable         = data_full, # abla de registros\n    camOp                = camop, # Matriz de operación de cámaras\n    stationCol           = \"Camera_Id\",\n    speciesCol           = \"scientificName\",\n    recordDateTimeCol    = \"eventDateTime\",\n    recordDateTimeFormat  = \"%Y-%m-%d %H:%M:%S\",\n    species              = x,     # la función reemplaza x por cada una de las especies\n    occasionLength       = 7, # Colapso de las historias a 10 ías\n    day1                 = \"station\", # \"survey\" a specific date, \"station\", #inicie en la fecha de cada survey\n    datesAsOccasionNames = FALSE,\n    includeEffort        = TRUE,\n    scaleEffort          = FALSE,\n    #unmarkedMultFrameInput=TRUE\n    timeZone             = \"America/Bogota\" \n    )\n  }\n)\n\n# names\nnames(DetHist_list) &lt;- unique(data_full$scientificName)\n\n# Finalmente creamos una lista nueva donde estén solo las historias de detección\nylist &lt;- lapply(DetHist_list, FUN = function(x) x$detection_history)\n# otra lista con effort scaled\nefort &lt;- lapply(DetHist_list, FUN = function(x) x$effort)\n\n# number of observetions per sp, collapsed to 7 days\n# lapply(ylist, sum, na.rm = TRUE)\n\n\nArrange spatial covariates\nThe standard EPSG code for a Lambert Azimuthal Equal-Area projection for South America is EPSG:10603 (WGS 84 / GLANCE South America). This projection is specifically designed for the continent and has its center located around the central meridian for the region. The units are meters.\nFLII scores range from 0 (lowest integrity) to 10 (highest). Grantham discretized this range to define three broad illustrative categories: low (≤6.0); medium (&gt;6.0 and &lt;9.6); and high integrity (≥9.6).\n\nCode#transform coord data to Lambert Azimuthal Equal-Area\nAP_Tahuayo_UTM &lt;- st_transform(AP_Tahuayo, \"EPSG:10603\")\n# Convert to LINESTRING\nAP_Tahuayo_UTM_line &lt;- st_cast(AP_Tahuayo_UTM,\"MULTILINESTRING\")# \"LINESTRING\")\n#transform Yasuni to Lambert Azimuthal Equal-Area\nAP_Yasuni_UTM &lt;- st_transform(AP_Yasuni, \"EPSG:10603\")\n# Convert to LINESTRING\nAP_Yasuni_UTM_line &lt;- st_cast(AP_Yasuni_UTM, \"MULTILINESTRING\")\n\n#transform Yasuni to Lambert Azimuthal Equal-Area\nAP_Madidi_UTM &lt;- st_transform(Madidi_NP, \"EPSG:10603\")\n# Convert to LINESTRING\nAP_Madidi_UTM_line &lt;- st_cast(AP_Madidi_UTM, \"MULTILINESTRING\")\n\n\n\n\n############## sf AP Union \nAP_merged_sf_UTM &lt;- st_union(AP_Tahuayo_UTM, \n                             AP_Yasuni_UTM,\n                             AP_Madidi_UTM)\n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\nCodeAP_merged_line &lt;- st_cast(AP_merged_sf_UTM, to=\"MULTILINESTRING\")\n\n\n# make sf() from data table\ndata_full_sf &lt;- CToperation |&gt; \n    st_as_sf(coords = c(\"Longitude\", \"Latitude\"), \n              crs = 4326)\n\n# gete elevation proint from AWS\nelev_data &lt;- elevatr::get_elev_point(locations = data_full_sf, src = \"aws\")\n\nMosaicing & Projecting\n\n\nNote: Elevation units are in meters\n\nCode# extract elev and paste to table\ndata_full_sf$elev &lt;- elev_data$elevation\nstr(data_full_sf$elev)\n\n num [1:377] 449 396 622 478 468 401 537 549 456 498 ...\n\nCode# extract in AP\ndata_full_sf$in_AP = as.factor(st_intersects(data_full_sf, AP_Tahuayo, sparse = FALSE))\n\nin_AP &lt;- as.numeric((st_drop_geometry(data_full_sf$in_AP)))\n\n# extract FLII\ndata_full_sf$FLII &lt;- terra::extract(FLII2016, data_full_sf)[,2]\nstr(data_full_sf$FLII)\n\n num [1:377] 9.57 9.65 9.69 9.66 9.92 ...\n\nCode# Replace all NAs with min flii in a numeric column\ndata_full_sf$FLII[is.na(data_full_sf$FLII)] &lt;- min(data_full_sf$FLII, na.rm = TRUE)\n\n# mapview(full_sites_14_15_16_sf, zcol = \"in_AP\", burst = TRUE)\n\n# Transform coord to Lambert Azimuthal Equal-Area\ndata_full_sf_UTM &lt;- st_transform(data_full_sf, \"EPSG:10603\")\n\n\ncoords &lt;- st_coordinates(data_full_sf_UTM)\n#str(coords)\n\n#### fix duplicated coord\n# -1840583.53296873  en x\n# -1842515.36969736  en x\n# 1547741.44311964  en y\n# 1541202.24796904 en y\n\n# which(coords[,1]==\"-1840583.53296873\")\n# which(coords[,1]==\"-1842515.36969736\")\n# which(coords[,2]==\"1547741.44311964\")\n# which(coords[,2]==\"1541202.24796904\")\n\n# make Ecu_14_15_16 an sf object\n#    cam_sf &lt;- st_as_sf(Ecu_14_15_16, coords = c(\"lon\",\"lat\"))   #crs=\"EPSG:4326\")\n    #--- set CRS ---#\n#    st_crs(cam_sf) &lt;- 4326\n\n\n\n\n# Calculate the distance\n#multiplic &lt;- full_sites_14_15_16_sf_UTM |&gt; mutate(multiplic= as.numeric(in_AP)) \nmultiplic=ifelse(data_full_sf_UTM$in_AP==\"TRUE\",-1,1)\ndata_full_sf_UTM$border_dist &lt;- as.numeric(st_distance(data_full_sf_UTM, AP_Tahuayo_UTM_line) * multiplic )\n# print(border_dist)\n\n# convert true false to inside 1, outside 0\ndata_full_sf_UTM &lt;- data_full_sf_UTM |&gt;\n  mutate(in_AP = case_when(\n    str_detect(in_AP, \"TRUE\") ~ 1, # \"inside_AP\",\n    str_detect(in_AP, \"FALSE\") ~ 0 #\"outside_AP\"\n  )) |&gt; mutate(in_AP=as.factor(in_AP))\n\n\nhist(data_full_sf_UTM$border_dist)\n\n\n\n\n\n\n\nPrepare the model\n\n\n\n\n\n\nTipData in a 3D array\n\n\n\nThe data must be placed in a three-dimensional array with dimensions corresponding to species, sites, and replicates in that order.\n\n\nThe function sfMsPGOcc\nFits multi-species spatial occupancy models with species correlations (i.e., a spatially-explicit joint species distribution model with imperfect detection). We use Polya-Gamma latent variables and a spatial factor modeling approach. Currently, models are implemented using a Nearest Neighbor Gaussian Process.\n\nCode# Detection-nondetection data ---------\n# Species of interest, can select individually\n# curr.sp &lt;- sort(unique(Ecu_14_15_16$.id))# c('BAWW', 'BLJA', 'GCFL')\n# sort(names(DetHist_list))\nselected.sp &lt;-  c(\n\"Atelocynus microtis\" ,\n\"Coendou prehensilis\" ,\n\"Cuniculus paca\",           \n\"Dasyprocta fuliginosa\",      \n\"Dasypus sp.\" ,    \n\"Didelphis marsupialis\",    \n\"Eira barbara\",  \n\"Herpailurus yagouaroundi\",\n\"Leopardus pardalis\",    \n\"Leopardus tigrinus\" ,\n\"Leopardus wiedii\",         \n\"Mazama americana\",\n\"Mazama nemorivaga\",\n#\"Mitu tuberosum\" ,\n\"Myoprocta pratti\",\n\"Myrmecophaga tridactyla\",\n\"Nasua nasua\" ,\n# \"Mazama americana\",         \n# \"Myotis myotis\",           \n# \"Nasua narica\",             \n# \"Odocoileus virginianus\",   \n\"Panthera onca\" ,\n# \"Procyon cancrivorus\" ,\n\"Pecari tajacu\",    \n#\"Penelope jacquacu\" ,\n\"Priodontes maximus\" ,\n\"Procyon cancrivorous\",      \n# \"Psophia leucoptera\",\n\"Puma concolor\" ,\n\"Puma yagouaroundi\",        \n# \"Rattus rattus\" ,\n# \"Roedor sp.\",\n# \"Sciurus sp.\",       \n# \"Sus scrofa\",               \n# \"Sylvilagus brasiliensis\",  \n\"Tamandua tetradactyla\",   \n\"Tapirus terrestris\",\n\"Tayassu pecari\"\n#\"Tinamus major\"            \n              )\n\n# y.msom &lt;- y[which(sp.codes %in% selected.sp), , ]\n# str(y.msom)\n\n# Use selection\ny.selected &lt;- ylist[selected.sp]   \n\n#### three-dimensional array with dimensions corresponding to species, sites, and replicates\n\n# 1. Load the abind library to make arrays easily \nlibrary(abind)\nmy_array_abind &lt;- abind(y.selected, # start from list\n                        along = 3, # 3D array\n                        use.first.dimnames=TRUE) # keep names\n\n# Transpose the array to have:\n# species, sites, and sampling occasions in that order\n# The new order is (3rd dim, 1st dim, 2nd dim)\ntransposed_array &lt;- aperm(my_array_abind, c(3, 1, 2))\n\n#### site covs\nsitecovs &lt;- as.data.frame(st_drop_geometry(\n                    data_full_sf_UTM[,5:8]))\n\n sitecovs[, 1] &lt;- as.vector((sitecovs[,1]))   # scale numeric covariates\n sitecovs[, 1] &lt;- as.numeric((sitecovs[,2]))   # scale numeric covariates\n sitecovs[, 3] &lt;- as.vector((sitecovs[,3]))   # scale numeric covariates\n sitecovs[, 4] &lt;- as.vector((sitecovs[,4]))   # scale numeric covariates\n # sitecovs$fact &lt;- factor(c(\"A\", \"A\", \"B\"))    # categorical covariate\n\nnames(sitecovs) &lt;- c(\"elev\", \"in_AP\", \"FLII\", \"border_dist\")\n\n# check consistancy equal number of spatial covariates and rows in data\n# identical(nrow(ylist[[1]]), nrow(covars)) \n\n# Base de datos para los análisis -----------------------------------------\n\n# match the names to \"y\"  \"occ.covs\" \"det.covs\" \"coords\" \ndata_list &lt;- list(y = transposed_array, # Historias de detección\n                  occ.covs = sitecovs, # covs de sitio\n                  det.covs  = list(effort = DetHist_list[[1]]$effort),\n                  coords = st_coordinates(data_full_sf_UTM)\n                  )  # agregamos el esfuerzo de muestreo como covariable de observación\n\n\nRunning the model\nWe let spOccupancy set the initial values by default based on the prior distributions.\n\nCode# Running the model\n\n# 3. 1 Modelo multi-especie  -----------------------------------------\n\n# 2. Model fitting --------------------------------------------------------\n# Fit a non-spatial, multi-species occupancy model. \nout &lt;- msPGOcc(occ.formula = ~ scale(elev) +\n                               scale(border_dist) + \n                               scale(FLII) , \n               det.formula = ~ scale(effort) , # Ordinal.day + I(Ordinal.day^2) + Year\n                 data = data_list, \n                 n.samples = 6000, \n                 n.thin = 10, \n                 n.burn = 1000, \n                 n.chains = 3,\n                 n.report = 1000);beep(sound = 4)\n\n----------------------------------------\n    Preparing to run the model\n----------------------------------------\n\n\nNo prior specified for beta.comm.normal.\nSetting prior mean to 0 and prior variance to 2.72\n\n\nNo prior specified for alpha.comm.normal.\nSetting prior mean to 0 and prior variance to 2.72\n\n\nNo prior specified for tau.sq.beta.ig.\nSetting prior shape to 0.1 and prior scale to 0.1\n\n\nNo prior specified for tau.sq.alpha.ig.\nSetting prior shape to 0.1 and prior scale to 0.1\n\n\nz is not specified in initial values.\nSetting initial values based on observed data\n\n\nbeta.comm is not specified in initial values.\nSetting initial values to random values from the prior distribution\n\n\nalpha.comm is not specified in initial values.\nSetting initial values to random values from the prior distribution\n\n\ntau.sq.beta is not specified in initial values.\nSetting initial values to random values between 0.5 and 10\n\n\ntau.sq.alpha is not specified in initial values.\nSetting to initial values to random values between 0.5 and 10\n\n\nbeta is not specified in initial values.\nSetting initial values to random values from the community-level normal distribution\n\n\nalpha is not specified in initial values.\nSetting initial values to random values from the community-level normal distribution\n\n\n----------------------------------------\n    Model description\n----------------------------------------\nMulti-species Occupancy Model with Polya-Gamma latent\nvariable fit with 377 sites and 25 species.\n\nSamples per Chain: 6000 \nBurn-in: 1000 \nThinning Rate: 10 \nNumber of Chains: 3 \nTotal Posterior Samples: 1500 \n\nSource compiled with OpenMP support and model fit using 1 thread(s).\n\n----------------------------------------\n    Chain 1\n----------------------------------------\nSampling ... \nSampled: 1000 of 6000, 16.67%\n-------------------------------------------------\nSampled: 2000 of 6000, 33.33%\n-------------------------------------------------\nSampled: 3000 of 6000, 50.00%\n-------------------------------------------------\nSampled: 4000 of 6000, 66.67%\n-------------------------------------------------\nSampled: 5000 of 6000, 83.33%\n-------------------------------------------------\nSampled: 6000 of 6000, 100.00%\n----------------------------------------\n    Chain 2\n----------------------------------------\nSampling ... \nSampled: 1000 of 6000, 16.67%\n-------------------------------------------------\nSampled: 2000 of 6000, 33.33%\n-------------------------------------------------\nSampled: 3000 of 6000, 50.00%\n-------------------------------------------------\nSampled: 4000 of 6000, 66.67%\n-------------------------------------------------\nSampled: 5000 of 6000, 83.33%\n-------------------------------------------------\nSampled: 6000 of 6000, 100.00%\n----------------------------------------\n    Chain 3\n----------------------------------------\nSampling ... \nSampled: 1000 of 6000, 16.67%\n-------------------------------------------------\nSampled: 2000 of 6000, 33.33%\n-------------------------------------------------\nSampled: 3000 of 6000, 50.00%\n-------------------------------------------------\nSampled: 4000 of 6000, 66.67%\n-------------------------------------------------\nSampled: 5000 of 6000, 83.33%\n-------------------------------------------------\nSampled: 6000 of 6000, 100.00%\n\nCode# Fit a non-spatial, Latent Factor Multi-Species Occupancy Model. \n  out.lfMs &lt;- msPGOcc(occ.formula = ~ scale(elev) +\n                               scale(border_dist) + \n                               scale(FLII) , \n               det.formula = ~ scale(effort), # Ordinal.day + I(Ordinal.day^2) + Year\n                 data = data_list, \n                 n.omp.threads = 6,\n                 n.samples = 6000, \n                 n.factors = 5, # balance of rare sp. and run time\n                 n.thin = 10, \n                 n.burn = 1000, \n                 n.chains = 3,\n                 n.report = 1000);beep(sound = 4)\n\n----------------------------------------\n    Preparing to run the model\n----------------------------------------\n\n\nWarning in msPGOcc(occ.formula = ~scale(elev) + scale(border_dist) +\nscale(FLII), : 'n.factors' is not an argument\n\n\nNo prior specified for beta.comm.normal.\nSetting prior mean to 0 and prior variance to 2.72\n\n\nNo prior specified for alpha.comm.normal.\nSetting prior mean to 0 and prior variance to 2.72\n\n\nNo prior specified for tau.sq.beta.ig.\nSetting prior shape to 0.1 and prior scale to 0.1\n\n\nNo prior specified for tau.sq.alpha.ig.\nSetting prior shape to 0.1 and prior scale to 0.1\n\n\nz is not specified in initial values.\nSetting initial values based on observed data\n\n\nbeta.comm is not specified in initial values.\nSetting initial values to random values from the prior distribution\n\n\nalpha.comm is not specified in initial values.\nSetting initial values to random values from the prior distribution\n\n\ntau.sq.beta is not specified in initial values.\nSetting initial values to random values between 0.5 and 10\n\n\ntau.sq.alpha is not specified in initial values.\nSetting to initial values to random values between 0.5 and 10\n\n\nbeta is not specified in initial values.\nSetting initial values to random values from the community-level normal distribution\n\n\nalpha is not specified in initial values.\nSetting initial values to random values from the community-level normal distribution\n\n\n----------------------------------------\n    Model description\n----------------------------------------\nMulti-species Occupancy Model with Polya-Gamma latent\nvariable fit with 377 sites and 25 species.\n\nSamples per Chain: 6000 \nBurn-in: 1000 \nThinning Rate: 10 \nNumber of Chains: 3 \nTotal Posterior Samples: 1500 \n\nSource compiled with OpenMP support and model fit using 6 thread(s).\n\n----------------------------------------\n    Chain 1\n----------------------------------------\nSampling ... \nSampled: 1000 of 6000, 16.67%\n-------------------------------------------------\nSampled: 2000 of 6000, 33.33%\n-------------------------------------------------\nSampled: 3000 of 6000, 50.00%\n-------------------------------------------------\nSampled: 4000 of 6000, 66.67%\n-------------------------------------------------\nSampled: 5000 of 6000, 83.33%\n-------------------------------------------------\nSampled: 6000 of 6000, 100.00%\n----------------------------------------\n    Chain 2\n----------------------------------------\nSampling ... \nSampled: 1000 of 6000, 16.67%\n-------------------------------------------------\nSampled: 2000 of 6000, 33.33%\n-------------------------------------------------\nSampled: 3000 of 6000, 50.00%\n-------------------------------------------------\nSampled: 4000 of 6000, 66.67%\n-------------------------------------------------\nSampled: 5000 of 6000, 83.33%\n-------------------------------------------------\nSampled: 6000 of 6000, 100.00%\n----------------------------------------\n    Chain 3\n----------------------------------------\nSampling ... \nSampled: 1000 of 6000, 16.67%\n-------------------------------------------------\nSampled: 2000 of 6000, 33.33%\n-------------------------------------------------\nSampled: 3000 of 6000, 50.00%\n-------------------------------------------------\nSampled: 4000 of 6000, 66.67%\n-------------------------------------------------\nSampled: 5000 of 6000, 83.33%\n-------------------------------------------------\nSampled: 6000 of 6000, 100.00%\n\nCodesummary(out, level = 'community')\n\n\nCall:\nmsPGOcc(occ.formula = ~scale(elev) + scale(border_dist) + scale(FLII), \n    det.formula = ~scale(effort), data = data_list, n.samples = 6000, \n    n.report = 1000, n.burn = 1000, n.thin = 10, n.chains = 3)\n\nSamples per Chain: 6000\nBurn-in: 1000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 1500\nRun Time (min): 6.5557\n\n----------------------------------------\n    Community Level\n----------------------------------------\nOccurrence Means (logit scale): \n                      Mean     SD    2.5%     50%   97.5%   Rhat  ESS\n(Intercept)        -1.9029 0.3475 -2.5989 -1.9037 -1.2372 1.0173  294\nscale(elev)        -0.1814 0.1342 -0.4492 -0.1844  0.0853 1.0020 1212\nscale(border_dist) -0.3751 0.2422 -0.8557 -0.3734  0.0939 1.0030 1044\nscale(FLII)         0.3792 0.1245  0.1601  0.3679  0.6505 1.0102  523\n\nOccurrence Variances (logit scale): \n                     Mean     SD   2.5%    50%  97.5%   Rhat ESS\n(Intercept)        2.6100 1.0362 1.2049 2.4232 5.2357 1.0048 462\nscale(elev)        0.3037 0.1523 0.1146 0.2670 0.6968 1.0087 996\nscale(border_dist) 1.2159 0.5216 0.5198 1.1105 2.5792 1.0076 524\nscale(FLII)        0.1560 0.1134 0.0349 0.1268 0.4688 1.0217 462\n\nDetection Means (logit scale): \n                 Mean     SD    2.5%     50%   97.5%   Rhat  ESS\n(Intercept)   -2.2592 0.2722 -2.8347 -2.2436 -1.7610 1.0201  425\nscale(effort)  0.3996 0.0694  0.2665  0.3981  0.5504 1.0188 1301\n\nDetection Variances (logit scale): \n                Mean     SD   2.5%    50%  97.5%   Rhat  ESS\n(Intercept)   1.4516 0.6698 0.6129 1.3052 3.2993 1.0879   90\nscale(effort) 0.0457 0.0245 0.0163 0.0404 0.1074 1.0114 1136\n\nCode# Fit a Spatial Factor Multi-Species Occupancy Model\n# latent spatial factors.\ntictoc::tic()\n  out.sp &lt;- sfMsPGOcc(occ.formula = ~ scale(elev) +\n                               scale(border_dist) + \n                               scale(FLII) , \n               det.formula = ~ scale(effort), # Ordinal.day + I(Ordinal.day^2) + Year,            \n                      data = data_list, \n                      n.omp.threads = 6,\n                      n.batch = 600, \n                      batch.length = 25, # iter=600*25\n                      n.thin = 10, \n                      n.burn = 5000, \n                      n.chains = 3,\n                      NNGP = TRUE,\n                      n.factors = 5, # balance of rare sp. and run time\n                      n.neighbors = 15,\n                      cov.model = 'exponential',\n                      n.report = 1000);beep(sound = 4)\n\n----------------------------------------\n    Preparing to run the model\n----------------------------------------\n\n\nNo prior specified for beta.comm.normal.\nSetting prior mean to 0 and prior variance to 2.72\n\n\nNo prior specified for alpha.comm.normal.\nSetting prior mean to 0 and prior variance to 2.72\n\n\nNo prior specified for tau.sq.beta.\nUsing an inverse-Gamma prior with prior shape 0.1 and prior scale 0.1\n\n\nNo prior specified for tau.sq.alpha.\nUsing an inverse-Gamma prior with prior shape 0.1 and prior scale 0.1\n\n\nNo prior specified for phi.unif.\nSetting uniform bounds based on the range of observed spatial coordinates.\n\n\nz is not specified in initial values.\nSetting initial values based on observed data\n\n\nbeta.comm is not specified in initial values.\nSetting initial values to random values from the prior distribution\n\n\nalpha.comm is not specified in initial values.\nSetting initial values to random values from the prior distribution\n\n\ntau.sq.beta is not specified in initial values.\nSetting initial values to random values between 0.5 and 10\n\n\ntau.sq.alpha is not specified in initial values.\nSetting initial values to random values between 0.5 and 10\n\n\nbeta is not specified in initial values.\nSetting initial values to random values from the community-level normal distribution\n\n\nalpha is not specified in initial values.\nSetting initial values to random values from the community-level normal distribution\n\n\nphi is not specified in initial values.\nSetting initial value to random values from the prior distribution\n\n\nlambda is not specified in initial values.\nSetting initial values of the lower triangle to 0\n\n\n----------------------------------------\n    Building the neighbor list\n----------------------------------------\n----------------------------------------\nBuilding the neighbors of neighbors list\n----------------------------------------\n----------------------------------------\n    Model description\n----------------------------------------\nSpatial Factor NNGP Multi-species Occupancy Model with Polya-Gamma latent\nvariable fit with 377 sites and 25 species.\n\nSamples per chain: 15000 (600 batches of length 25)\nBurn-in: 5000 \nThinning Rate: 10 \nNumber of Chains: 3 \nTotal Posterior Samples: 3000 \n\nUsing the exponential spatial correlation model.\n\nUsing 5 latent spatial factors.\nUsing 15 nearest neighbors.\n\nSource compiled with OpenMP support and model fit using 6 thread(s).\n\nAdaptive Metropolis with target acceptance rate: 43.0\n----------------------------------------\n    Chain 1\n----------------------------------------\nSampling ... \nBatch: 600 of 600, 100.00%\n----------------------------------------\n    Chain 2\n----------------------------------------\nSampling ... \nBatch: 600 of 600, 100.00%\n----------------------------------------\n    Chain 3\n----------------------------------------\nSampling ... \nBatch: 600 of 600, 100.00%\n\nCodetictoc::toc()\n\n1656.03 sec elapsed\n\nCode#########################\ntictoc::tic()\n  out.sp.fac &lt;- sfMsPGOcc(occ.formula = ~ scale(elev) +\n                               factor(in_AP) + \n                               scale(FLII) , \n               det.formula = ~ scale(effort), # Ordinal.day + I(Ordinal.day^2) + Year,            \n                      data = data_list, \n                      n.omp.threads = 6,\n                      n.batch = 600, \n                      batch.length = 25, # iter=600*25\n                      n.thin = 10, \n                      n.burn = 5000, \n                      n.chains = 3,\n                      NNGP = TRUE,\n                      n.factors = 5, # balance of rare sp. and run time\n                      n.neighbors = 15,\n                      cov.model = 'exponential',\n                      n.report = 1000);beep(sound = 4)\n\n----------------------------------------\n    Preparing to run the model\n----------------------------------------\n\n\nNo prior specified for beta.comm.normal.\nSetting prior mean to 0 and prior variance to 2.72\n\n\nNo prior specified for alpha.comm.normal.\nSetting prior mean to 0 and prior variance to 2.72\n\n\nNo prior specified for tau.sq.beta.\nUsing an inverse-Gamma prior with prior shape 0.1 and prior scale 0.1\n\n\nNo prior specified for tau.sq.alpha.\nUsing an inverse-Gamma prior with prior shape 0.1 and prior scale 0.1\n\n\nNo prior specified for phi.unif.\nSetting uniform bounds based on the range of observed spatial coordinates.\n\n\nz is not specified in initial values.\nSetting initial values based on observed data\n\n\nbeta.comm is not specified in initial values.\nSetting initial values to random values from the prior distribution\n\n\nalpha.comm is not specified in initial values.\nSetting initial values to random values from the prior distribution\n\n\ntau.sq.beta is not specified in initial values.\nSetting initial values to random values between 0.5 and 10\n\n\ntau.sq.alpha is not specified in initial values.\nSetting initial values to random values between 0.5 and 10\n\n\nbeta is not specified in initial values.\nSetting initial values to random values from the community-level normal distribution\n\n\nalpha is not specified in initial values.\nSetting initial values to random values from the community-level normal distribution\n\n\nphi is not specified in initial values.\nSetting initial value to random values from the prior distribution\n\n\nlambda is not specified in initial values.\nSetting initial values of the lower triangle to 0\n\n\n----------------------------------------\n    Building the neighbor list\n----------------------------------------\n----------------------------------------\nBuilding the neighbors of neighbors list\n----------------------------------------\n----------------------------------------\n    Model description\n----------------------------------------\nSpatial Factor NNGP Multi-species Occupancy Model with Polya-Gamma latent\nvariable fit with 377 sites and 25 species.\n\nSamples per chain: 15000 (600 batches of length 25)\nBurn-in: 5000 \nThinning Rate: 10 \nNumber of Chains: 3 \nTotal Posterior Samples: 3000 \n\nUsing the exponential spatial correlation model.\n\nUsing 5 latent spatial factors.\nUsing 15 nearest neighbors.\n\nSource compiled with OpenMP support and model fit using 6 thread(s).\n\nAdaptive Metropolis with target acceptance rate: 43.0\n----------------------------------------\n    Chain 1\n----------------------------------------\nSampling ... \nBatch: 600 of 600, 100.00%\n----------------------------------------\n    Chain 2\n----------------------------------------\nSampling ... \nBatch: 600 of 600, 100.00%\n----------------------------------------\n    Chain 3\n----------------------------------------\nSampling ... \nBatch: 600 of 600, 100.00%\n\nCodetictoc::toc()\n\n1603.01 sec elapsed\n\nCode# tictoc::tic()\n#   out.sp.gaus &lt;- sfMsPGOcc(occ.formula = ~ scale(border_dist) , \n#                            det.formula = ~ scale(effort), # Ordinal.day + I(Ordinal.day^2) + Year,              \n#                            data = data_list, \n#                            n.batch = 400, \n#                            batch.length = 25,\n#                            n.thin = 5, \n#                            n.burn = 5000, \n#                            n.chains = 1,\n#                            NNGP = TRUE,\n#                            n.factors = 5,\n#                            n.neighbors = 15,\n#                            cov.model = 'gaussian',\n#                            n.report = 100);beep(sound = 4)\n# tictoc::toc()\n\n# save the results to not run again\n# save(out, file=\"C:/CodigoR/Occu_APs_all/blog/2025-10-15-analysis/result/result_2.R\") # guardamos los resultados para no correr de nuevo\n# save the results to not run again\n# save(out.sp, file=\"C:/CodigoR/Occu_APs_all/blog/2025-10-15-analysis/result/sp_result_2.R\") # guardamos los resultados para no correr de nuevo\n\n# save(out.lfMs, file=\"C:/CodigoR/Occu_APs_all/blog/2025-10-15-analysis/result/lfms_result_2.R\") # guardamos los resultados para no correr de nuevo\n\n\n# load(\"C:/CodigoR/Occu_APs_all/blog/2025-10-15-analysis/result/sp_result_2.R\")\n# summary(fit.commu)\n\n\nModel validation\nWe next perform a posterior predictive check using the Freeman-Tukey statistic grouping the data by sites. We summarize the posterior predictive check with the summary() function, which reports a Bayesian p-value. A Bayesian p-value that hovers around 0.5 indicates adequate model fit, while values less than 0.1 or greater than 0.9 suggest our model does not fit the data well (Hobbs and Hooten 2015). As always with a simulation-based analysis using MCMC, you will get numerically slightly different values.\n\nCode# 3. Model validation -----------------------------------------------------\n# Perform a posterior predictive check to assess model fit. \nppc.out &lt;- ppcOcc(out, fit.stat = 'freeman-tukey', \n                  group = 1)\nppc.out.lfMs &lt;- ppcOcc(out.lfMs, fit.stat = 'freeman-tukey', \n                  group = 1)\nppc.out.sp &lt;- ppcOcc(out.sp, fit.stat = 'freeman-tukey',\n                     group = 1)\n\n# Calculate a Bayesian p-value as a simple measure of Goodness of Fit.\n# Bayesian p-values between 0.1 and 0.9 indicate adequate model fit. \nsummary(ppc.out)\n\n\nCall:\nppcOcc(object = out, fit.stat = \"freeman-tukey\", group = 1)\n\nSamples per Chain: 6000\nBurn-in: 1000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 1500\n\n----------------------------------------\n    Community Level\n----------------------------------------\nBayesian p-value:  0.3599 \n\n----------------------------------------\n    Species Level\n----------------------------------------\nAtelocynus microtis Bayesian p-value: 0.36\nCoendou prehensilis Bayesian p-value: 0.6633\nCuniculus paca Bayesian p-value: 0.0033\nDasyprocta fuliginosa Bayesian p-value: 7e-04\nDasypus sp. Bayesian p-value: 0.1627\nDidelphis marsupialis Bayesian p-value: 0.4347\nEira barbara Bayesian p-value: 0.6893\nHerpailurus yagouaroundi Bayesian p-value: 0.5673\nLeopardus pardalis Bayesian p-value: 0.3153\nLeopardus tigrinus Bayesian p-value: 0.2173\nLeopardus wiedii Bayesian p-value: 0.4387\nMazama americana Bayesian p-value: 0.0547\nMazama nemorivaga Bayesian p-value: 0.49\nMyoprocta pratti Bayesian p-value: 0.2433\nMyrmecophaga tridactyla Bayesian p-value: 0.3927\nNasua nasua Bayesian p-value: 0.4953\nPanthera onca Bayesian p-value: 0.4613\nPecari tajacu Bayesian p-value: 0.1193\nPriodontes maximus Bayesian p-value: 0.584\nProcyon cancrivorous Bayesian p-value: 0.528\nPuma concolor Bayesian p-value: 0.346\nPuma yagouaroundi Bayesian p-value: 0.7087\nTamandua tetradactyla Bayesian p-value: 0.41\nTapirus terrestris Bayesian p-value: 0.1007\nTayassu pecari Bayesian p-value: 0.2107\nFit statistic:  freeman-tukey \n\nCodesummary(ppc.out.lfMs)\n\n\nCall:\nppcOcc(object = out.lfMs, fit.stat = \"freeman-tukey\", group = 1)\n\nSamples per Chain: 6000\nBurn-in: 1000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 1500\n\n----------------------------------------\n    Community Level\n----------------------------------------\nBayesian p-value:  0.3617 \n\n----------------------------------------\n    Species Level\n----------------------------------------\nAtelocynus microtis Bayesian p-value: 0.3667\nCoendou prehensilis Bayesian p-value: 0.628\nCuniculus paca Bayesian p-value: 0.0033\nDasyprocta fuliginosa Bayesian p-value: 0.0013\nDasypus sp. Bayesian p-value: 0.168\nDidelphis marsupialis Bayesian p-value: 0.448\nEira barbara Bayesian p-value: 0.67\nHerpailurus yagouaroundi Bayesian p-value: 0.6\nLeopardus pardalis Bayesian p-value: 0.3113\nLeopardus tigrinus Bayesian p-value: 0.2227\nLeopardus wiedii Bayesian p-value: 0.4307\nMazama americana Bayesian p-value: 0.0573\nMazama nemorivaga Bayesian p-value: 0.488\nMyoprocta pratti Bayesian p-value: 0.242\nMyrmecophaga tridactyla Bayesian p-value: 0.3833\nNasua nasua Bayesian p-value: 0.498\nPanthera onca Bayesian p-value: 0.4667\nPecari tajacu Bayesian p-value: 0.1347\nPriodontes maximus Bayesian p-value: 0.6133\nProcyon cancrivorous Bayesian p-value: 0.518\nPuma concolor Bayesian p-value: 0.356\nPuma yagouaroundi Bayesian p-value: 0.6827\nTamandua tetradactyla Bayesian p-value: 0.426\nTapirus terrestris Bayesian p-value: 0.1113\nTayassu pecari Bayesian p-value: 0.214\nFit statistic:  freeman-tukey \n\nCodesummary(ppc.out.sp)\n\n\nCall:\nppcOcc(object = out.sp, fit.stat = \"freeman-tukey\", group = 1)\n\nSamples per Chain: 15000\nBurn-in: 5000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 3000\n\n----------------------------------------\n    Community Level\n----------------------------------------\nBayesian p-value:  0.3452 \n\n----------------------------------------\n    Species Level\n----------------------------------------\nAtelocynus microtis Bayesian p-value: 0.3423\nCoendou prehensilis Bayesian p-value: 0.6207\nCuniculus paca Bayesian p-value: 0.0053\nDasyprocta fuliginosa Bayesian p-value: 0.0033\nDasypus sp. Bayesian p-value: 0.1627\nDidelphis marsupialis Bayesian p-value: 0.3993\nEira barbara Bayesian p-value: 0.706\nHerpailurus yagouaroundi Bayesian p-value: 0.5977\nLeopardus pardalis Bayesian p-value: 0.2573\nLeopardus tigrinus Bayesian p-value: 0.2633\nLeopardus wiedii Bayesian p-value: 0.356\nMazama americana Bayesian p-value: 0.0467\nMazama nemorivaga Bayesian p-value: 0.644\nMyoprocta pratti Bayesian p-value: 0.2513\nMyrmecophaga tridactyla Bayesian p-value: 0.1947\nNasua nasua Bayesian p-value: 0.3583\nPanthera onca Bayesian p-value: 0.5183\nPecari tajacu Bayesian p-value: 0.1087\nPriodontes maximus Bayesian p-value: 0.5727\nProcyon cancrivorous Bayesian p-value: 0.496\nPuma concolor Bayesian p-value: 0.3523\nPuma yagouaroundi Bayesian p-value: 0.6723\nTamandua tetradactyla Bayesian p-value: 0.4233\nTapirus terrestris Bayesian p-value: 0.0617\nTayassu pecari Bayesian p-value: 0.2153\nFit statistic:  freeman-tukey \n\n\n\n\n\n\n\n\nImportant\n\n\n\nA Bayesian p-value that around 0.5 indicates adequate model fit, while values less than 0.1 or greater than 0.9 suggest our model does not fit the data well.\n\n\nFit plot\n\nCode#### fit plot\nppc.df &lt;- data.frame(fit = ppc.out.sp$fit.y, \n                     fit.rep = ppc.out.sp$fit.y.rep, \n                     color = 'lightskyblue1')\n\nppc.df$color[ppc.df$fit.rep.1 &gt; ppc.df$fit.1] &lt;- 'lightsalmon'\nplot(ppc.df$fit.1, ppc.df$fit.rep.1, bg = ppc.df$color, pch = 21, \n     ylab = 'Fit', xlab = 'True')\nlines(ppc.df$fit.1, ppc.df$fit.1, col = 'black')\n\n\n\nThe most symmetrical, better fit!\n\n\n\nModel comparison\n\nCode# 4. Model comparison -----------------------------------------------------\n# Compute Widely Applicable Information Criterion (WAIC)\n# Lower values indicate better model fit. \nwaicOcc(out)\n\n      elpd         pD       WAIC \n-7380.8846   106.2362 14974.2415 \n\nCodewaicOcc(out.lfMs)\n\n     elpd        pD      WAIC \n-7380.445   105.455 14971.800 \n\nCodewaicOcc(out.sp)\n\n      elpd         pD       WAIC \n-6584.7663   639.1395 14447.8115 \n\nCodewaicOcc(out.sp.fac)\n\n      elpd         pD       WAIC \n-6601.3076   633.0254 14468.6660 \n\n\nModel comparison as table\n\nCode# Here we summarize the spatial factor loadings\n# summary(out.sp$lambda.samples)\n\n# Resultados --------------------------------------------------------------\n# Extraemos lo tabla de valores estimados\nmodresult &lt;- cbind(as.data.frame(waicOcc(out)),\n                  as.data.frame(waicOcc(out.sp)),\n                  as.data.frame(waicOcc(out.lfMs)),\n                  as.data.frame(waicOcc(out.sp.fac))\n                  #as.data.frame(waicOcc(out.sp.gaus))\n                  )\n# View(modresult)\nmodresult_sorted &lt;- as.data.frame(t(modresult)) |&gt; \n  arrange(WAIC) # sort by\n  \nDT::datatable(modresult_sorted)\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nLower values in WAIC indicate better model fit.\n\n\nWAIC is the Widely Applicable Information Criterion (Watanabe 2010).\nPosterior Summary\n\nCode# 5. Posterior summaries --------------------------------------------------\n# Concise summary of main parameter estimates\nsummary(out.sp, level = 'community')\n\n\nCall:\nsfMsPGOcc(occ.formula = ~scale(elev) + scale(border_dist) + scale(FLII), \n    det.formula = ~scale(effort), data = data_list, cov.model = \"exponential\", \n    NNGP = TRUE, n.neighbors = 15, n.factors = 5, n.batch = 600, \n    batch.length = 25, n.omp.threads = 6, n.report = 1000, n.burn = 5000, \n    n.thin = 10, n.chains = 3)\n\nSamples per Chain: 15000\nBurn-in: 5000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 3000\nRun Time (min): 27.6002\n\n----------------------------------------\n    Community Level\n----------------------------------------\nOccurrence Means (logit scale): \n                      Mean     SD    2.5%     50%   97.5%   Rhat ESS\n(Intercept)        -2.5811 0.5578 -3.6409 -2.5831 -1.4618 1.1491 294\nscale(elev)        -0.0702 0.2130 -0.4974 -0.0660  0.3471 1.3555 182\nscale(border_dist) -0.5060 0.3787 -1.2282 -0.5069  0.2564 1.1918 263\nscale(FLII)         0.5682 0.2240  0.1770  0.5484  1.0746 1.0296 576\n\nOccurrence Variances (logit scale): \n                     Mean     SD   2.5%    50%   97.5%   Rhat ESS\n(Intercept)        6.7121 2.6922 3.1117 6.1805 13.7539 1.0980 225\nscale(elev)        0.5032 0.2717 0.1596 0.4467  1.2203 1.2361 445\nscale(border_dist) 2.3372 1.2231 0.7815 2.0815  5.3460 1.6710  85\nscale(FLII)        0.4413 0.3797 0.0676 0.3291  1.4933 1.1006 334\n\nDetection Means (logit scale): \n                 Mean     SD    2.5%     50%   97.5%   Rhat  ESS\n(Intercept)   -2.2938 0.2732 -2.8719 -2.2873 -1.7772 1.0570  431\nscale(effort)  0.3969 0.0657  0.2703  0.3959  0.5319 1.0066 2542\n\nDetection Variances (logit scale): \n                Mean     SD   2.5%    50%  97.5%   Rhat  ESS\n(Intercept)   1.5284 0.6143 0.7019 1.4172 3.0417 1.1323  236\nscale(effort) 0.0466 0.0262 0.0168 0.0401 0.1169 1.0062 2465\n\n----------------------------------------\n    Spatial Covariance\n----------------------------------------\n         Mean     SD   2.5%     50%   97.5%   Rhat  ESS\nphi-1 10.2741 9.0131 0.0000  9.1862 26.4475 2.0409   15\nphi-2  8.8879 9.1384 0.0000  6.2172 26.3255 3.9448    8\nphi-3 13.3497 8.0913 0.4024 13.1939 26.6927 1.0017 2827\nphi-4  8.9982 9.1869 0.0000  6.5632 26.5090 4.0048   13\nphi-5 13.1044 8.0811 0.3504 12.7752 26.9119 1.0093 2688\n\nCodesummary(out.sp, level = 'species')\n\n\nCall:\nsfMsPGOcc(occ.formula = ~scale(elev) + scale(border_dist) + scale(FLII), \n    det.formula = ~scale(effort), data = data_list, cov.model = \"exponential\", \n    NNGP = TRUE, n.neighbors = 15, n.factors = 5, n.batch = 600, \n    batch.length = 25, n.omp.threads = 6, n.report = 1000, n.burn = 5000, \n    n.thin = 10, n.chains = 3)\n\nSamples per Chain: 15000\nBurn-in: 5000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 3000\nRun Time (min): 27.6002\n\n----------------------------------------\n    Species Level\n----------------------------------------\nOccurrence (logit scale): \n                                               Mean     SD    2.5%     50%\n(Intercept)-Atelocynus microtis             -2.6153 0.8089 -3.9386 -2.7229\n(Intercept)-Coendou prehensilis             -5.2450 1.4270 -8.0714 -5.2364\n(Intercept)-Cuniculus paca                   0.1981 0.3781 -0.3381  0.1214\n(Intercept)-Dasyprocta fuliginosa           -0.8368 0.9209 -2.2452 -0.9624\n(Intercept)-Dasypus sp.                     -5.2605 1.0352 -7.6076 -5.1336\n(Intercept)-Didelphis marsupialis           -4.6584 0.9903 -6.8930 -4.5564\n(Intercept)-Eira barbara                    -3.0129 0.8550 -4.7586 -2.9941\n(Intercept)-Herpailurus yagouaroundi        -4.1566 1.5690 -7.1743 -4.1608\n(Intercept)-Leopardus pardalis              -1.2949 0.4583 -2.3535 -1.2543\n(Intercept)-Leopardus tigrinus              -6.9134 1.3212 -9.9445 -6.7589\n(Intercept)-Leopardus wiedii                -2.8619 1.5031 -5.2224 -3.0929\n(Intercept)-Mazama americana                -3.6184 1.0031 -5.6170 -3.6143\n(Intercept)-Mazama nemorivaga               -5.6025 1.1266 -8.1457 -5.5012\n(Intercept)-Myoprocta pratti                -4.3969 0.9487 -6.4516 -4.3482\n(Intercept)-Myrmecophaga tridactyla         -1.1476 1.0822 -2.8958 -1.3263\n(Intercept)-Nasua nasua                     -2.1519 1.2004 -4.5390 -2.1393\n(Intercept)-Panthera onca                   -0.9057 0.7866 -2.3696 -0.9471\n(Intercept)-Pecari tajacu                    1.6632 0.6202  0.6276  1.6143\n(Intercept)-Priodontes maximus              -0.6248 1.5891 -3.3309 -0.7481\n(Intercept)-Procyon cancrivorous            -5.1325 1.6958 -8.5065 -5.0925\n(Intercept)-Puma concolor                   -2.3471 0.5854 -3.5711 -2.3173\n(Intercept)-Puma yagouaroundi               -4.9971 1.7958 -8.4485 -5.0558\n(Intercept)-Tamandua tetradactyla           -4.2122 1.3440 -6.6060 -4.2822\n(Intercept)-Tapirus terrestris               0.4987 0.3676 -0.1138  0.4646\n(Intercept)-Tayassu pecari                  -0.8244 0.4445 -1.7043 -0.8422\nscale(elev)-Atelocynus microtis             -0.8088 0.4670 -1.8290 -0.7828\nscale(elev)-Coendou prehensilis              0.2174 0.6289 -0.9762  0.2018\nscale(elev)-Cuniculus paca                  -0.3337 0.3120 -0.9253 -0.3393\nscale(elev)-Dasyprocta fuliginosa            0.8564 0.6117 -0.4495  0.8676\nscale(elev)-Dasypus sp.                     -0.3190 0.3107 -0.9639 -0.3043\nscale(elev)-Didelphis marsupialis            0.0811 0.4866 -0.8003  0.0638\nscale(elev)-Eira barbara                    -0.8970 0.4617 -1.8755 -0.8754\nscale(elev)-Herpailurus yagouaroundi        -0.3839 0.6989 -1.8121 -0.3817\nscale(elev)-Leopardus pardalis               0.0691 0.3566 -0.5983  0.0623\nscale(elev)-Leopardus tigrinus              -0.2048 0.6492 -1.5262 -0.1947\nscale(elev)-Leopardus wiedii                -0.1760 0.5291 -1.2246 -0.1678\nscale(elev)-Mazama americana                 1.1180 0.5021  0.1943  1.1027\nscale(elev)-Mazama nemorivaga                0.5103 0.4150 -0.2520  0.4842\nscale(elev)-Myoprocta pratti                 0.1555 0.5844 -0.9579  0.1202\nscale(elev)-Myrmecophaga tridactyla         -0.4802 0.4816 -1.5105 -0.4633\nscale(elev)-Nasua nasua                     -0.0350 0.5775 -1.1304 -0.0450\nscale(elev)-Panthera onca                    0.0381 0.4432 -0.8468  0.0439\nscale(elev)-Pecari tajacu                    0.3581 0.3870 -0.5097  0.3779\nscale(elev)-Priodontes maximus              -0.3174 0.5590 -1.4752 -0.2946\nscale(elev)-Procyon cancrivorous            -0.2313 0.5088 -1.2866 -0.2204\nscale(elev)-Puma concolor                   -0.2751 0.4712 -1.1891 -0.2825\nscale(elev)-Puma yagouaroundi               -0.4262 0.5749 -1.6096 -0.4104\nscale(elev)-Tamandua tetradactyla            0.1720 0.5748 -0.9236  0.1621\nscale(elev)-Tapirus terrestris               0.1498 0.3277 -0.4768  0.1518\nscale(elev)-Tayassu pecari                  -0.6515 0.3481 -1.3747 -0.6326\nscale(border_dist)-Atelocynus microtis      -0.0541 0.5242 -1.1469 -0.0516\nscale(border_dist)-Coendou prehensilis      -0.8382 1.1084 -3.1535 -0.7716\nscale(border_dist)-Cuniculus paca           -1.2245 0.4481 -1.9988 -1.2691\nscale(border_dist)-Dasyprocta fuliginosa    -0.8135 1.2242 -2.6210 -1.0150\nscale(border_dist)-Dasypus sp.              -3.6272 1.1684 -5.9641 -3.6004\nscale(border_dist)-Didelphis marsupialis     1.1618 0.7118 -0.4912  1.2047\nscale(border_dist)-Eira barbara             -1.9139 0.6798 -3.3124 -1.8707\nscale(border_dist)-Herpailurus yagouaroundi  0.0733 1.2443 -2.2870  0.0008\nscale(border_dist)-Leopardus pardalis        1.3183 0.4831  0.4405  1.2827\nscale(border_dist)-Leopardus tigrinus       -0.1020 1.0474 -2.2482 -0.0906\nscale(border_dist)-Leopardus wiedii          0.5960 0.7396 -0.8069  0.5416\nscale(border_dist)-Mazama americana          0.7127 0.5172 -0.4396  0.7420\nscale(border_dist)-Mazama nemorivaga        -3.0387 1.1490 -5.4837 -2.9648\nscale(border_dist)-Myoprocta pratti         -0.7185 0.9994 -2.6765 -0.7250\nscale(border_dist)-Myrmecophaga tridactyla  -0.0639 0.6656 -1.2232 -0.1079\nscale(border_dist)-Nasua nasua              -1.3143 0.8124 -3.1026 -1.2545\nscale(border_dist)-Panthera onca             0.6732 0.5943 -0.3940  0.6398\nscale(border_dist)-Pecari tajacu            -0.3554 0.6810 -1.4189 -0.4631\nscale(border_dist)-Priodontes maximus        0.3764 0.8921 -1.1230  0.2862\nscale(border_dist)-Procyon cancrivorous     -1.6297 1.0049 -3.8581 -1.5348\nscale(border_dist)-Puma concolor            -0.0874 0.5740 -1.1142 -0.1281\nscale(border_dist)-Puma yagouaroundi        -1.5145 1.1318 -3.9415 -1.3775\nscale(border_dist)-Tamandua tetradactyla    -0.7083 0.9067 -2.5997 -0.6835\nscale(border_dist)-Tapirus terrestris       -0.1681 0.4085 -0.8933 -0.1977\nscale(border_dist)-Tayassu pecari            0.2989 0.4306 -0.4350  0.2563\nscale(FLII)-Atelocynus microtis              0.0039 0.3959 -0.8856  0.0244\nscale(FLII)-Coendou prehensilis              0.5747 0.6694 -0.6203  0.5359\nscale(FLII)-Cuniculus paca                   0.0260 0.2096 -0.4024  0.0223\nscale(FLII)-Dasyprocta fuliginosa           -0.0968 0.3538 -0.8178 -0.0910\nscale(FLII)-Dasypus sp.                      0.5464 0.5560 -0.4760  0.5106\nscale(FLII)-Didelphis marsupialis            0.9554 0.5184  0.1247  0.8867\nscale(FLII)-Eira barbara                     0.5614 0.5692 -0.4884  0.5256\nscale(FLII)-Herpailurus yagouaroundi         0.4829 0.6155 -0.6918  0.4655\nscale(FLII)-Leopardus pardalis               0.7975 0.3288  0.2222  0.7704\nscale(FLII)-Leopardus tigrinus               0.6053 0.6248 -0.4873  0.5479\nscale(FLII)-Leopardus wiedii                 0.5598 0.5566 -0.5279  0.5355\nscale(FLII)-Mazama americana                 0.4153 0.2846 -0.0951  0.4034\nscale(FLII)-Mazama nemorivaga                0.7418 0.6694 -0.3778  0.6566\nscale(FLII)-Myoprocta pratti                 0.5863 0.5225 -0.3691  0.5544\nscale(FLII)-Myrmecophaga tridactyla          0.1768 0.4518 -0.7456  0.1846\nscale(FLII)-Nasua nasua                      0.8707 0.6798 -0.2158  0.7807\nscale(FLII)-Panthera onca                    1.2138 0.6609  0.2302  1.1032\nscale(FLII)-Pecari tajacu                    0.2090 0.2580 -0.2851  0.2069\nscale(FLII)-Priodontes maximus               0.1285 0.5007 -0.9131  0.1449\nscale(FLII)-Procyon cancrivorous             0.7006 0.6627 -0.4530  0.6456\nscale(FLII)-Puma concolor                    1.4454 0.7656  0.3267  1.3238\nscale(FLII)-Puma yagouaroundi                0.6376 0.6855 -0.6583  0.5960\nscale(FLII)-Tamandua tetradactyla            0.5836 0.6147 -0.5227  0.5556\nscale(FLII)-Tapirus terrestris               0.5529 0.2731  0.0771  0.5292\nscale(FLII)-Tayassu pecari                   1.0465 0.4320  0.3424  1.0021\n                                              97.5%   Rhat  ESS\n(Intercept)-Atelocynus microtis             -0.7635 1.0295  201\n(Intercept)-Coendou prehensilis             -2.5356 1.0484  202\n(Intercept)-Cuniculus paca                   1.1509 3.0565    7\n(Intercept)-Dasyprocta fuliginosa            1.5250 2.4474    8\n(Intercept)-Dasypus sp.                     -3.5548 1.2936  217\n(Intercept)-Didelphis marsupialis           -2.9683 1.1490  149\n(Intercept)-Eira barbara                    -1.3977 1.0035  323\n(Intercept)-Herpailurus yagouaroundi        -0.9840 1.3578  110\n(Intercept)-Leopardus pardalis              -0.4762 1.0643  529\n(Intercept)-Leopardus tigrinus              -4.6804 1.0941  290\n(Intercept)-Leopardus wiedii                 1.0111 1.2508   77\n(Intercept)-Mazama americana                -1.9450 2.6103   19\n(Intercept)-Mazama nemorivaga               -3.6932 1.4610  203\n(Intercept)-Myoprocta pratti                -2.6218 1.2596   65\n(Intercept)-Myrmecophaga tridactyla          1.4784 1.0693  141\n(Intercept)-Nasua nasua                      0.1094 1.2773  167\n(Intercept)-Panthera onca                    0.7904 1.0407  269\n(Intercept)-Pecari tajacu                    3.0897 1.1372   41\n(Intercept)-Priodontes maximus               2.9197 1.0596   73\n(Intercept)-Procyon cancrivorous            -1.4863 1.1385  120\n(Intercept)-Puma concolor                   -1.2064 1.1739  156\n(Intercept)-Puma yagouaroundi               -1.3053 1.3033  113\n(Intercept)-Tamandua tetradactyla           -1.3528 1.0245  181\n(Intercept)-Tapirus terrestris               1.3287 1.0319   62\n(Intercept)-Tayassu pecari                   0.0752 1.2008   82\nscale(elev)-Atelocynus microtis              0.0368 1.1409 1332\nscale(elev)-Coendou prehensilis              1.4874 1.1753 1127\nscale(elev)-Cuniculus paca                   0.2753 2.0216   26\nscale(elev)-Dasyprocta fuliginosa            2.0496 2.9744   10\nscale(elev)-Dasypus sp.                      0.2504 1.0349 1466\nscale(elev)-Didelphis marsupialis            1.1288 1.2596  224\nscale(elev)-Eira barbara                    -0.0484 1.0035 1122\nscale(elev)-Herpailurus yagouaroundi         0.9607 1.2408  288\nscale(elev)-Leopardus pardalis               0.7829 1.3257  237\nscale(elev)-Leopardus tigrinus               1.0218 1.1337  647\nscale(elev)-Leopardus wiedii                 0.8635 1.0180 1250\nscale(elev)-Mazama americana                 2.1229 2.4306   20\nscale(elev)-Mazama nemorivaga                1.3729 1.2284  263\nscale(elev)-Myoprocta pratti                 1.3474 1.6501   99\nscale(elev)-Myrmecophaga tridactyla          0.4124 1.0423 1359\nscale(elev)-Nasua nasua                      1.1907 1.0156  625\nscale(elev)-Panthera onca                    0.9100 1.1330  575\nscale(elev)-Pecari tajacu                    1.0645 1.6922   41\nscale(elev)-Priodontes maximus               0.7242 1.1964  552\nscale(elev)-Procyon cancrivorous             0.7158 1.0028 1341\nscale(elev)-Puma concolor                    0.6380 2.0087   25\nscale(elev)-Puma yagouaroundi                0.6494 1.0113 1057\nscale(elev)-Tamandua tetradactyla            1.3146 1.0591 1440\nscale(elev)-Tapirus terrestris               0.8026 1.4634   76\nscale(elev)-Tayassu pecari                  -0.0070 1.1880  144\nscale(border_dist)-Atelocynus microtis       0.9977 1.2051  145\nscale(border_dist)-Coendou prehensilis       1.1827 1.2918  397\nscale(border_dist)-Cuniculus paca           -0.0954 1.8892   16\nscale(border_dist)-Dasyprocta fuliginosa     2.8943 3.1187    8\nscale(border_dist)-Dasypus sp.              -1.4796 2.2481   48\nscale(border_dist)-Didelphis marsupialis     2.4433 1.4870   21\nscale(border_dist)-Eira barbara             -0.6951 1.2598  369\nscale(border_dist)-Herpailurus yagouaroundi  2.7352 1.5528   87\nscale(border_dist)-Leopardus pardalis        2.3691 1.0503  434\nscale(border_dist)-Leopardus tigrinus        1.9136 1.0977  457\nscale(border_dist)-Leopardus wiedii          2.2239 1.0353  320\nscale(border_dist)-Mazama americana          1.6647 1.0676   48\nscale(border_dist)-Mazama nemorivaga        -1.0431 1.3753  216\nscale(border_dist)-Myoprocta pratti          1.3776 1.8818   33\nscale(border_dist)-Myrmecophaga tridactyla   1.5272 1.0232  471\nscale(border_dist)-Nasua nasua               0.0982 1.2452  251\nscale(border_dist)-Panthera onca             1.9209 1.1004  529\nscale(border_dist)-Pecari tajacu             1.5624 2.2652   12\nscale(border_dist)-Priodontes maximus        2.4967 1.4539  133\nscale(border_dist)-Procyon cancrivorous      0.1141 1.1807  367\nscale(border_dist)-Puma concolor             1.2429 1.4450   23\nscale(border_dist)-Puma yagouaroundi         0.4363 1.0478  323\nscale(border_dist)-Tamandua tetradactyla     0.9602 1.0836  443\nscale(border_dist)-Tapirus terrestris        0.7550 1.4398   36\nscale(border_dist)-Tayassu pecari            1.2767 1.4242   35\nscale(FLII)-Atelocynus microtis              0.7375 1.0832  648\nscale(FLII)-Coendou prehensilis              2.0742 1.0384  779\nscale(FLII)-Cuniculus paca                   0.4361 1.1080  774\nscale(FLII)-Dasyprocta fuliginosa            0.5912 1.2150  239\nscale(FLII)-Dasypus sp.                      1.7562 1.0050 1643\nscale(FLII)-Didelphis marsupialis            2.0892 1.0844  556\nscale(FLII)-Eira barbara                     1.7700 1.0058  855\nscale(FLII)-Herpailurus yagouaroundi         1.8040 1.0097  622\nscale(FLII)-Leopardus pardalis               1.4901 1.0284 1122\nscale(FLII)-Leopardus tigrinus               2.0290 1.0053 1131\nscale(FLII)-Leopardus wiedii                 1.6837 1.0082  788\nscale(FLII)-Mazama americana                 0.9932 1.0936  902\nscale(FLII)-Mazama nemorivaga                2.3389 1.0051  981\nscale(FLII)-Myoprocta pratti                 1.7537 1.0467 1420\nscale(FLII)-Myrmecophaga tridactyla          1.0483 1.0110  770\nscale(FLII)-Nasua nasua                      2.5374 1.0348  522\nscale(FLII)-Panthera onca                    2.8328 1.0788  495\nscale(FLII)-Pecari tajacu                    0.7359 1.1168  387\nscale(FLII)-Priodontes maximus               1.0984 1.1359  663\nscale(FLII)-Procyon cancrivorous             2.1368 1.0118  748\nscale(FLII)-Puma concolor                    3.3019 1.0751  398\nscale(FLII)-Puma yagouaroundi                2.1709 1.0097  738\nscale(FLII)-Tamandua tetradactyla            1.9349 1.0067  911\nscale(FLII)-Tapirus terrestris               1.1668 1.0043 1540\nscale(FLII)-Tayassu pecari                   2.0604 1.0164  821\n\nDetection (logit scale): \n                                          Mean     SD    2.5%     50%   97.5%\n(Intercept)-Atelocynus microtis        -2.9072 0.6139 -4.2090 -2.8676 -1.8285\n(Intercept)-Coendou prehensilis        -3.5512 1.0884 -5.7978 -3.4789 -1.6037\n(Intercept)-Cuniculus paca             -0.8278 0.0651 -0.9561 -0.8271 -0.7000\n(Intercept)-Dasyprocta fuliginosa      -0.3834 0.0750 -0.5335 -0.3820 -0.2391\n(Intercept)-Dasypus sp.                -1.5314 0.1247 -1.7893 -1.5299 -1.2985\n(Intercept)-Didelphis marsupialis      -2.1551 0.3753 -2.9213 -2.1387 -1.4803\n(Intercept)-Eira barbara               -2.9674 0.3218 -3.5983 -2.9641 -2.3575\n(Intercept)-Herpailurus yagouaroundi   -3.4077 0.8330 -5.1335 -3.3814 -1.9007\n(Intercept)-Leopardus pardalis         -1.8578 0.1636 -2.1829 -1.8558 -1.5507\n(Intercept)-Leopardus tigrinus         -1.2614 0.9529 -3.3237 -1.2079  0.4500\n(Intercept)-Leopardus wiedii           -3.3734 0.7484 -4.8681 -3.3119 -2.0872\n(Intercept)-Mazama americana           -1.0921 0.1167 -1.3284 -1.0918 -0.8673\n(Intercept)-Mazama nemorivaga          -2.0089 0.1830 -2.3685 -2.0064 -1.6571\n(Intercept)-Myoprocta pratti           -1.5573 0.2799 -2.1324 -1.5505 -1.0325\n(Intercept)-Myrmecophaga tridactyla    -3.1545 0.4611 -4.0113 -3.1523 -2.2739\n(Intercept)-Nasua nasua                -3.6055 0.3932 -4.3021 -3.6386 -2.7791\n(Intercept)-Panthera onca              -2.7170 0.2697 -3.2441 -2.7149 -2.1963\n(Intercept)-Pecari tajacu              -1.2631 0.0720 -1.4015 -1.2628 -1.1233\n(Intercept)-Priodontes maximus         -3.6352 0.5065 -4.6163 -3.6447 -2.6410\n(Intercept)-Procyon cancrivorous       -3.5536 0.8292 -5.2329 -3.5137 -2.0338\n(Intercept)-Puma concolor              -1.7082 0.2078 -2.1307 -1.7023 -1.3204\n(Intercept)-Puma yagouaroundi          -3.9010 0.9613 -5.7081 -3.8840 -2.1131\n(Intercept)-Tamandua tetradactyla      -3.3440 0.8443 -5.0243 -3.2774 -1.8322\n(Intercept)-Tapirus terrestris         -1.1500 0.0793 -1.3028 -1.1477 -0.9968\n(Intercept)-Tayassu pecari             -1.6976 0.1437 -1.9871 -1.6959 -1.4247\nscale(effort)-Atelocynus microtis       0.3545 0.1897 -0.0223  0.3545  0.7290\nscale(effort)-Coendou prehensilis       0.3914 0.2253 -0.0494  0.3912  0.8505\nscale(effort)-Cuniculus paca            0.3184 0.0747  0.1715  0.3183  0.4666\nscale(effort)-Dasyprocta fuliginosa     0.3789 0.0920  0.2036  0.3792  0.5639\nscale(effort)-Dasypus sp.               0.4432 0.1370  0.1947  0.4353  0.7382\nscale(effort)-Didelphis marsupialis     0.5425 0.1981  0.1933  0.5281  0.9873\nscale(effort)-Eira barbara              0.5009 0.1960  0.1563  0.4864  0.9137\nscale(effort)-Herpailurus yagouaroundi  0.2824 0.2104 -0.1506  0.2909  0.6761\nscale(effort)-Leopardus pardalis        0.4324 0.1241  0.1987  0.4301  0.6845\nscale(effort)-Leopardus tigrinus        0.4368 0.2229  0.0101  0.4331  0.8878\nscale(effort)-Leopardus wiedii          0.4546 0.2021  0.0899  0.4489  0.8632\nscale(effort)-Mazama americana          0.5169 0.1376  0.2688  0.5090  0.8084\nscale(effort)-Mazama nemorivaga         0.2855 0.1506  0.0010  0.2827  0.5913\nscale(effort)-Myoprocta pratti          0.3059 0.1777 -0.0532  0.3076  0.6511\nscale(effort)-Myrmecophaga tridactyla   0.3910 0.1757  0.0712  0.3860  0.7668\nscale(effort)-Nasua nasua               0.4372 0.1861  0.1005  0.4298  0.8265\nscale(effort)-Panthera onca             0.2991 0.1406  0.0241  0.2960  0.5782\nscale(effort)-Pecari tajacu             0.3683 0.0804  0.2136  0.3668  0.5311\nscale(effort)-Priodontes maximus        0.2404 0.1793 -0.1086  0.2446  0.5923\nscale(effort)-Procyon cancrivorous      0.4282 0.2085  0.0312  0.4215  0.8590\nscale(effort)-Puma concolor             0.4126 0.1511  0.1316  0.4054  0.7313\nscale(effort)-Puma yagouaroundi         0.4105 0.2148 -0.0168  0.4106  0.8453\nscale(effort)-Tamandua tetradactyla     0.3281 0.2040 -0.0942  0.3277  0.7104\nscale(effort)-Tapirus terrestris        0.4066 0.0870  0.2448  0.4031  0.5888\nscale(effort)-Tayassu pecari            0.5569 0.1360  0.3047  0.5539  0.8364\n                                         Rhat  ESS\n(Intercept)-Atelocynus microtis        1.1924  166\n(Intercept)-Coendou prehensilis        1.0464  357\n(Intercept)-Cuniculus paca             1.0046 3000\n(Intercept)-Dasyprocta fuliginosa      1.0063 3000\n(Intercept)-Dasypus sp.                1.0053 2818\n(Intercept)-Didelphis marsupialis      1.0184  972\n(Intercept)-Eira barbara               1.0025  553\n(Intercept)-Herpailurus yagouaroundi   1.1280  164\n(Intercept)-Leopardus pardalis         1.0009 1226\n(Intercept)-Leopardus tigrinus         1.0105 1367\n(Intercept)-Leopardus wiedii           1.2879   91\n(Intercept)-Mazama americana           1.0000 3000\n(Intercept)-Mazama nemorivaga          1.0076 2491\n(Intercept)-Myoprocta pratti           1.0024 2424\n(Intercept)-Myrmecophaga tridactyla    1.0305  144\n(Intercept)-Nasua nasua                1.2957  187\n(Intercept)-Panthera onca              1.0274  429\n(Intercept)-Pecari tajacu              1.0012 2295\n(Intercept)-Priodontes maximus         1.0565  112\n(Intercept)-Procyon cancrivorous       1.0254  198\n(Intercept)-Puma concolor              1.0077 2209\n(Intercept)-Puma yagouaroundi          1.1210  176\n(Intercept)-Tamandua tetradactyla      1.0720  173\n(Intercept)-Tapirus terrestris         1.0012 2844\n(Intercept)-Tayassu pecari             1.0090 1808\nscale(effort)-Atelocynus microtis      1.0016 2724\nscale(effort)-Coendou prehensilis      1.0023 3000\nscale(effort)-Cuniculus paca           1.0026 3000\nscale(effort)-Dasyprocta fuliginosa    1.0093 3000\nscale(effort)-Dasypus sp.              1.0034 2792\nscale(effort)-Didelphis marsupialis    1.0107 2777\nscale(effort)-Eira barbara             1.0028 2766\nscale(effort)-Herpailurus yagouaroundi 1.0029 3000\nscale(effort)-Leopardus pardalis       1.0014 3000\nscale(effort)-Leopardus tigrinus       1.0000 3000\nscale(effort)-Leopardus wiedii         1.0044 2590\nscale(effort)-Mazama americana         1.0010 2763\nscale(effort)-Mazama nemorivaga        1.0024 3000\nscale(effort)-Myoprocta pratti         1.0026 3000\nscale(effort)-Myrmecophaga tridactyla  1.0081 2624\nscale(effort)-Nasua nasua              1.0114 2285\nscale(effort)-Panthera onca            1.0004 3000\nscale(effort)-Pecari tajacu            1.0039 2737\nscale(effort)-Priodontes maximus       1.0032 2344\nscale(effort)-Procyon cancrivorous     0.9998 2795\nscale(effort)-Puma concolor            1.0087 3000\nscale(effort)-Puma yagouaroundi        1.0024 3000\nscale(effort)-Tamandua tetradactyla    1.0024 3000\nscale(effort)-Tapirus terrestris       1.0016 3000\nscale(effort)-Tayassu pecari           1.0016 2603\n\n----------------------------------------\n    Spatial Covariance\n----------------------------------------\n         Mean     SD   2.5%     50%   97.5%   Rhat  ESS\nphi-1 10.2741 9.0131 0.0000  9.1862 26.4475 2.0409   15\nphi-2  8.8879 9.1384 0.0000  6.2172 26.3255 3.9448    8\nphi-3 13.3497 8.0913 0.4024 13.1939 26.6927 1.0017 2827\nphi-4  8.9982 9.1869 0.0000  6.5632 26.5090 4.0048   13\nphi-5 13.1044 8.0811 0.3504 12.7752 26.9119 1.0093 2688\n\nCodesummary(out.sp, level = 'both')\n\n\nCall:\nsfMsPGOcc(occ.formula = ~scale(elev) + scale(border_dist) + scale(FLII), \n    det.formula = ~scale(effort), data = data_list, cov.model = \"exponential\", \n    NNGP = TRUE, n.neighbors = 15, n.factors = 5, n.batch = 600, \n    batch.length = 25, n.omp.threads = 6, n.report = 1000, n.burn = 5000, \n    n.thin = 10, n.chains = 3)\n\nSamples per Chain: 15000\nBurn-in: 5000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 3000\nRun Time (min): 27.6002\n\n----------------------------------------\n    Community Level\n----------------------------------------\nOccurrence Means (logit scale): \n                      Mean     SD    2.5%     50%   97.5%   Rhat ESS\n(Intercept)        -2.5811 0.5578 -3.6409 -2.5831 -1.4618 1.1491 294\nscale(elev)        -0.0702 0.2130 -0.4974 -0.0660  0.3471 1.3555 182\nscale(border_dist) -0.5060 0.3787 -1.2282 -0.5069  0.2564 1.1918 263\nscale(FLII)         0.5682 0.2240  0.1770  0.5484  1.0746 1.0296 576\n\nOccurrence Variances (logit scale): \n                     Mean     SD   2.5%    50%   97.5%   Rhat ESS\n(Intercept)        6.7121 2.6922 3.1117 6.1805 13.7539 1.0980 225\nscale(elev)        0.5032 0.2717 0.1596 0.4467  1.2203 1.2361 445\nscale(border_dist) 2.3372 1.2231 0.7815 2.0815  5.3460 1.6710  85\nscale(FLII)        0.4413 0.3797 0.0676 0.3291  1.4933 1.1006 334\n\nDetection Means (logit scale): \n                 Mean     SD    2.5%     50%   97.5%   Rhat  ESS\n(Intercept)   -2.2938 0.2732 -2.8719 -2.2873 -1.7772 1.0570  431\nscale(effort)  0.3969 0.0657  0.2703  0.3959  0.5319 1.0066 2542\n\nDetection Variances (logit scale): \n                Mean     SD   2.5%    50%  97.5%   Rhat  ESS\n(Intercept)   1.5284 0.6143 0.7019 1.4172 3.0417 1.1323  236\nscale(effort) 0.0466 0.0262 0.0168 0.0401 0.1169 1.0062 2465\n\n----------------------------------------\n    Species Level\n----------------------------------------\nOccurrence (logit scale): \n                                               Mean     SD    2.5%     50%\n(Intercept)-Atelocynus microtis             -2.6153 0.8089 -3.9386 -2.7229\n(Intercept)-Coendou prehensilis             -5.2450 1.4270 -8.0714 -5.2364\n(Intercept)-Cuniculus paca                   0.1981 0.3781 -0.3381  0.1214\n(Intercept)-Dasyprocta fuliginosa           -0.8368 0.9209 -2.2452 -0.9624\n(Intercept)-Dasypus sp.                     -5.2605 1.0352 -7.6076 -5.1336\n(Intercept)-Didelphis marsupialis           -4.6584 0.9903 -6.8930 -4.5564\n(Intercept)-Eira barbara                    -3.0129 0.8550 -4.7586 -2.9941\n(Intercept)-Herpailurus yagouaroundi        -4.1566 1.5690 -7.1743 -4.1608\n(Intercept)-Leopardus pardalis              -1.2949 0.4583 -2.3535 -1.2543\n(Intercept)-Leopardus tigrinus              -6.9134 1.3212 -9.9445 -6.7589\n(Intercept)-Leopardus wiedii                -2.8619 1.5031 -5.2224 -3.0929\n(Intercept)-Mazama americana                -3.6184 1.0031 -5.6170 -3.6143\n(Intercept)-Mazama nemorivaga               -5.6025 1.1266 -8.1457 -5.5012\n(Intercept)-Myoprocta pratti                -4.3969 0.9487 -6.4516 -4.3482\n(Intercept)-Myrmecophaga tridactyla         -1.1476 1.0822 -2.8958 -1.3263\n(Intercept)-Nasua nasua                     -2.1519 1.2004 -4.5390 -2.1393\n(Intercept)-Panthera onca                   -0.9057 0.7866 -2.3696 -0.9471\n(Intercept)-Pecari tajacu                    1.6632 0.6202  0.6276  1.6143\n(Intercept)-Priodontes maximus              -0.6248 1.5891 -3.3309 -0.7481\n(Intercept)-Procyon cancrivorous            -5.1325 1.6958 -8.5065 -5.0925\n(Intercept)-Puma concolor                   -2.3471 0.5854 -3.5711 -2.3173\n(Intercept)-Puma yagouaroundi               -4.9971 1.7958 -8.4485 -5.0558\n(Intercept)-Tamandua tetradactyla           -4.2122 1.3440 -6.6060 -4.2822\n(Intercept)-Tapirus terrestris               0.4987 0.3676 -0.1138  0.4646\n(Intercept)-Tayassu pecari                  -0.8244 0.4445 -1.7043 -0.8422\nscale(elev)-Atelocynus microtis             -0.8088 0.4670 -1.8290 -0.7828\nscale(elev)-Coendou prehensilis              0.2174 0.6289 -0.9762  0.2018\nscale(elev)-Cuniculus paca                  -0.3337 0.3120 -0.9253 -0.3393\nscale(elev)-Dasyprocta fuliginosa            0.8564 0.6117 -0.4495  0.8676\nscale(elev)-Dasypus sp.                     -0.3190 0.3107 -0.9639 -0.3043\nscale(elev)-Didelphis marsupialis            0.0811 0.4866 -0.8003  0.0638\nscale(elev)-Eira barbara                    -0.8970 0.4617 -1.8755 -0.8754\nscale(elev)-Herpailurus yagouaroundi        -0.3839 0.6989 -1.8121 -0.3817\nscale(elev)-Leopardus pardalis               0.0691 0.3566 -0.5983  0.0623\nscale(elev)-Leopardus tigrinus              -0.2048 0.6492 -1.5262 -0.1947\nscale(elev)-Leopardus wiedii                -0.1760 0.5291 -1.2246 -0.1678\nscale(elev)-Mazama americana                 1.1180 0.5021  0.1943  1.1027\nscale(elev)-Mazama nemorivaga                0.5103 0.4150 -0.2520  0.4842\nscale(elev)-Myoprocta pratti                 0.1555 0.5844 -0.9579  0.1202\nscale(elev)-Myrmecophaga tridactyla         -0.4802 0.4816 -1.5105 -0.4633\nscale(elev)-Nasua nasua                     -0.0350 0.5775 -1.1304 -0.0450\nscale(elev)-Panthera onca                    0.0381 0.4432 -0.8468  0.0439\nscale(elev)-Pecari tajacu                    0.3581 0.3870 -0.5097  0.3779\nscale(elev)-Priodontes maximus              -0.3174 0.5590 -1.4752 -0.2946\nscale(elev)-Procyon cancrivorous            -0.2313 0.5088 -1.2866 -0.2204\nscale(elev)-Puma concolor                   -0.2751 0.4712 -1.1891 -0.2825\nscale(elev)-Puma yagouaroundi               -0.4262 0.5749 -1.6096 -0.4104\nscale(elev)-Tamandua tetradactyla            0.1720 0.5748 -0.9236  0.1621\nscale(elev)-Tapirus terrestris               0.1498 0.3277 -0.4768  0.1518\nscale(elev)-Tayassu pecari                  -0.6515 0.3481 -1.3747 -0.6326\nscale(border_dist)-Atelocynus microtis      -0.0541 0.5242 -1.1469 -0.0516\nscale(border_dist)-Coendou prehensilis      -0.8382 1.1084 -3.1535 -0.7716\nscale(border_dist)-Cuniculus paca           -1.2245 0.4481 -1.9988 -1.2691\nscale(border_dist)-Dasyprocta fuliginosa    -0.8135 1.2242 -2.6210 -1.0150\nscale(border_dist)-Dasypus sp.              -3.6272 1.1684 -5.9641 -3.6004\nscale(border_dist)-Didelphis marsupialis     1.1618 0.7118 -0.4912  1.2047\nscale(border_dist)-Eira barbara             -1.9139 0.6798 -3.3124 -1.8707\nscale(border_dist)-Herpailurus yagouaroundi  0.0733 1.2443 -2.2870  0.0008\nscale(border_dist)-Leopardus pardalis        1.3183 0.4831  0.4405  1.2827\nscale(border_dist)-Leopardus tigrinus       -0.1020 1.0474 -2.2482 -0.0906\nscale(border_dist)-Leopardus wiedii          0.5960 0.7396 -0.8069  0.5416\nscale(border_dist)-Mazama americana          0.7127 0.5172 -0.4396  0.7420\nscale(border_dist)-Mazama nemorivaga        -3.0387 1.1490 -5.4837 -2.9648\nscale(border_dist)-Myoprocta pratti         -0.7185 0.9994 -2.6765 -0.7250\nscale(border_dist)-Myrmecophaga tridactyla  -0.0639 0.6656 -1.2232 -0.1079\nscale(border_dist)-Nasua nasua              -1.3143 0.8124 -3.1026 -1.2545\nscale(border_dist)-Panthera onca             0.6732 0.5943 -0.3940  0.6398\nscale(border_dist)-Pecari tajacu            -0.3554 0.6810 -1.4189 -0.4631\nscale(border_dist)-Priodontes maximus        0.3764 0.8921 -1.1230  0.2862\nscale(border_dist)-Procyon cancrivorous     -1.6297 1.0049 -3.8581 -1.5348\nscale(border_dist)-Puma concolor            -0.0874 0.5740 -1.1142 -0.1281\nscale(border_dist)-Puma yagouaroundi        -1.5145 1.1318 -3.9415 -1.3775\nscale(border_dist)-Tamandua tetradactyla    -0.7083 0.9067 -2.5997 -0.6835\nscale(border_dist)-Tapirus terrestris       -0.1681 0.4085 -0.8933 -0.1977\nscale(border_dist)-Tayassu pecari            0.2989 0.4306 -0.4350  0.2563\nscale(FLII)-Atelocynus microtis              0.0039 0.3959 -0.8856  0.0244\nscale(FLII)-Coendou prehensilis              0.5747 0.6694 -0.6203  0.5359\nscale(FLII)-Cuniculus paca                   0.0260 0.2096 -0.4024  0.0223\nscale(FLII)-Dasyprocta fuliginosa           -0.0968 0.3538 -0.8178 -0.0910\nscale(FLII)-Dasypus sp.                      0.5464 0.5560 -0.4760  0.5106\nscale(FLII)-Didelphis marsupialis            0.9554 0.5184  0.1247  0.8867\nscale(FLII)-Eira barbara                     0.5614 0.5692 -0.4884  0.5256\nscale(FLII)-Herpailurus yagouaroundi         0.4829 0.6155 -0.6918  0.4655\nscale(FLII)-Leopardus pardalis               0.7975 0.3288  0.2222  0.7704\nscale(FLII)-Leopardus tigrinus               0.6053 0.6248 -0.4873  0.5479\nscale(FLII)-Leopardus wiedii                 0.5598 0.5566 -0.5279  0.5355\nscale(FLII)-Mazama americana                 0.4153 0.2846 -0.0951  0.4034\nscale(FLII)-Mazama nemorivaga                0.7418 0.6694 -0.3778  0.6566\nscale(FLII)-Myoprocta pratti                 0.5863 0.5225 -0.3691  0.5544\nscale(FLII)-Myrmecophaga tridactyla          0.1768 0.4518 -0.7456  0.1846\nscale(FLII)-Nasua nasua                      0.8707 0.6798 -0.2158  0.7807\nscale(FLII)-Panthera onca                    1.2138 0.6609  0.2302  1.1032\nscale(FLII)-Pecari tajacu                    0.2090 0.2580 -0.2851  0.2069\nscale(FLII)-Priodontes maximus               0.1285 0.5007 -0.9131  0.1449\nscale(FLII)-Procyon cancrivorous             0.7006 0.6627 -0.4530  0.6456\nscale(FLII)-Puma concolor                    1.4454 0.7656  0.3267  1.3238\nscale(FLII)-Puma yagouaroundi                0.6376 0.6855 -0.6583  0.5960\nscale(FLII)-Tamandua tetradactyla            0.5836 0.6147 -0.5227  0.5556\nscale(FLII)-Tapirus terrestris               0.5529 0.2731  0.0771  0.5292\nscale(FLII)-Tayassu pecari                   1.0465 0.4320  0.3424  1.0021\n                                              97.5%   Rhat  ESS\n(Intercept)-Atelocynus microtis             -0.7635 1.0295  201\n(Intercept)-Coendou prehensilis             -2.5356 1.0484  202\n(Intercept)-Cuniculus paca                   1.1509 3.0565    7\n(Intercept)-Dasyprocta fuliginosa            1.5250 2.4474    8\n(Intercept)-Dasypus sp.                     -3.5548 1.2936  217\n(Intercept)-Didelphis marsupialis           -2.9683 1.1490  149\n(Intercept)-Eira barbara                    -1.3977 1.0035  323\n(Intercept)-Herpailurus yagouaroundi        -0.9840 1.3578  110\n(Intercept)-Leopardus pardalis              -0.4762 1.0643  529\n(Intercept)-Leopardus tigrinus              -4.6804 1.0941  290\n(Intercept)-Leopardus wiedii                 1.0111 1.2508   77\n(Intercept)-Mazama americana                -1.9450 2.6103   19\n(Intercept)-Mazama nemorivaga               -3.6932 1.4610  203\n(Intercept)-Myoprocta pratti                -2.6218 1.2596   65\n(Intercept)-Myrmecophaga tridactyla          1.4784 1.0693  141\n(Intercept)-Nasua nasua                      0.1094 1.2773  167\n(Intercept)-Panthera onca                    0.7904 1.0407  269\n(Intercept)-Pecari tajacu                    3.0897 1.1372   41\n(Intercept)-Priodontes maximus               2.9197 1.0596   73\n(Intercept)-Procyon cancrivorous            -1.4863 1.1385  120\n(Intercept)-Puma concolor                   -1.2064 1.1739  156\n(Intercept)-Puma yagouaroundi               -1.3053 1.3033  113\n(Intercept)-Tamandua tetradactyla           -1.3528 1.0245  181\n(Intercept)-Tapirus terrestris               1.3287 1.0319   62\n(Intercept)-Tayassu pecari                   0.0752 1.2008   82\nscale(elev)-Atelocynus microtis              0.0368 1.1409 1332\nscale(elev)-Coendou prehensilis              1.4874 1.1753 1127\nscale(elev)-Cuniculus paca                   0.2753 2.0216   26\nscale(elev)-Dasyprocta fuliginosa            2.0496 2.9744   10\nscale(elev)-Dasypus sp.                      0.2504 1.0349 1466\nscale(elev)-Didelphis marsupialis            1.1288 1.2596  224\nscale(elev)-Eira barbara                    -0.0484 1.0035 1122\nscale(elev)-Herpailurus yagouaroundi         0.9607 1.2408  288\nscale(elev)-Leopardus pardalis               0.7829 1.3257  237\nscale(elev)-Leopardus tigrinus               1.0218 1.1337  647\nscale(elev)-Leopardus wiedii                 0.8635 1.0180 1250\nscale(elev)-Mazama americana                 2.1229 2.4306   20\nscale(elev)-Mazama nemorivaga                1.3729 1.2284  263\nscale(elev)-Myoprocta pratti                 1.3474 1.6501   99\nscale(elev)-Myrmecophaga tridactyla          0.4124 1.0423 1359\nscale(elev)-Nasua nasua                      1.1907 1.0156  625\nscale(elev)-Panthera onca                    0.9100 1.1330  575\nscale(elev)-Pecari tajacu                    1.0645 1.6922   41\nscale(elev)-Priodontes maximus               0.7242 1.1964  552\nscale(elev)-Procyon cancrivorous             0.7158 1.0028 1341\nscale(elev)-Puma concolor                    0.6380 2.0087   25\nscale(elev)-Puma yagouaroundi                0.6494 1.0113 1057\nscale(elev)-Tamandua tetradactyla            1.3146 1.0591 1440\nscale(elev)-Tapirus terrestris               0.8026 1.4634   76\nscale(elev)-Tayassu pecari                  -0.0070 1.1880  144\nscale(border_dist)-Atelocynus microtis       0.9977 1.2051  145\nscale(border_dist)-Coendou prehensilis       1.1827 1.2918  397\nscale(border_dist)-Cuniculus paca           -0.0954 1.8892   16\nscale(border_dist)-Dasyprocta fuliginosa     2.8943 3.1187    8\nscale(border_dist)-Dasypus sp.              -1.4796 2.2481   48\nscale(border_dist)-Didelphis marsupialis     2.4433 1.4870   21\nscale(border_dist)-Eira barbara             -0.6951 1.2598  369\nscale(border_dist)-Herpailurus yagouaroundi  2.7352 1.5528   87\nscale(border_dist)-Leopardus pardalis        2.3691 1.0503  434\nscale(border_dist)-Leopardus tigrinus        1.9136 1.0977  457\nscale(border_dist)-Leopardus wiedii          2.2239 1.0353  320\nscale(border_dist)-Mazama americana          1.6647 1.0676   48\nscale(border_dist)-Mazama nemorivaga        -1.0431 1.3753  216\nscale(border_dist)-Myoprocta pratti          1.3776 1.8818   33\nscale(border_dist)-Myrmecophaga tridactyla   1.5272 1.0232  471\nscale(border_dist)-Nasua nasua               0.0982 1.2452  251\nscale(border_dist)-Panthera onca             1.9209 1.1004  529\nscale(border_dist)-Pecari tajacu             1.5624 2.2652   12\nscale(border_dist)-Priodontes maximus        2.4967 1.4539  133\nscale(border_dist)-Procyon cancrivorous      0.1141 1.1807  367\nscale(border_dist)-Puma concolor             1.2429 1.4450   23\nscale(border_dist)-Puma yagouaroundi         0.4363 1.0478  323\nscale(border_dist)-Tamandua tetradactyla     0.9602 1.0836  443\nscale(border_dist)-Tapirus terrestris        0.7550 1.4398   36\nscale(border_dist)-Tayassu pecari            1.2767 1.4242   35\nscale(FLII)-Atelocynus microtis              0.7375 1.0832  648\nscale(FLII)-Coendou prehensilis              2.0742 1.0384  779\nscale(FLII)-Cuniculus paca                   0.4361 1.1080  774\nscale(FLII)-Dasyprocta fuliginosa            0.5912 1.2150  239\nscale(FLII)-Dasypus sp.                      1.7562 1.0050 1643\nscale(FLII)-Didelphis marsupialis            2.0892 1.0844  556\nscale(FLII)-Eira barbara                     1.7700 1.0058  855\nscale(FLII)-Herpailurus yagouaroundi         1.8040 1.0097  622\nscale(FLII)-Leopardus pardalis               1.4901 1.0284 1122\nscale(FLII)-Leopardus tigrinus               2.0290 1.0053 1131\nscale(FLII)-Leopardus wiedii                 1.6837 1.0082  788\nscale(FLII)-Mazama americana                 0.9932 1.0936  902\nscale(FLII)-Mazama nemorivaga                2.3389 1.0051  981\nscale(FLII)-Myoprocta pratti                 1.7537 1.0467 1420\nscale(FLII)-Myrmecophaga tridactyla          1.0483 1.0110  770\nscale(FLII)-Nasua nasua                      2.5374 1.0348  522\nscale(FLII)-Panthera onca                    2.8328 1.0788  495\nscale(FLII)-Pecari tajacu                    0.7359 1.1168  387\nscale(FLII)-Priodontes maximus               1.0984 1.1359  663\nscale(FLII)-Procyon cancrivorous             2.1368 1.0118  748\nscale(FLII)-Puma concolor                    3.3019 1.0751  398\nscale(FLII)-Puma yagouaroundi                2.1709 1.0097  738\nscale(FLII)-Tamandua tetradactyla            1.9349 1.0067  911\nscale(FLII)-Tapirus terrestris               1.1668 1.0043 1540\nscale(FLII)-Tayassu pecari                   2.0604 1.0164  821\n\nDetection (logit scale): \n                                          Mean     SD    2.5%     50%   97.5%\n(Intercept)-Atelocynus microtis        -2.9072 0.6139 -4.2090 -2.8676 -1.8285\n(Intercept)-Coendou prehensilis        -3.5512 1.0884 -5.7978 -3.4789 -1.6037\n(Intercept)-Cuniculus paca             -0.8278 0.0651 -0.9561 -0.8271 -0.7000\n(Intercept)-Dasyprocta fuliginosa      -0.3834 0.0750 -0.5335 -0.3820 -0.2391\n(Intercept)-Dasypus sp.                -1.5314 0.1247 -1.7893 -1.5299 -1.2985\n(Intercept)-Didelphis marsupialis      -2.1551 0.3753 -2.9213 -2.1387 -1.4803\n(Intercept)-Eira barbara               -2.9674 0.3218 -3.5983 -2.9641 -2.3575\n(Intercept)-Herpailurus yagouaroundi   -3.4077 0.8330 -5.1335 -3.3814 -1.9007\n(Intercept)-Leopardus pardalis         -1.8578 0.1636 -2.1829 -1.8558 -1.5507\n(Intercept)-Leopardus tigrinus         -1.2614 0.9529 -3.3237 -1.2079  0.4500\n(Intercept)-Leopardus wiedii           -3.3734 0.7484 -4.8681 -3.3119 -2.0872\n(Intercept)-Mazama americana           -1.0921 0.1167 -1.3284 -1.0918 -0.8673\n(Intercept)-Mazama nemorivaga          -2.0089 0.1830 -2.3685 -2.0064 -1.6571\n(Intercept)-Myoprocta pratti           -1.5573 0.2799 -2.1324 -1.5505 -1.0325\n(Intercept)-Myrmecophaga tridactyla    -3.1545 0.4611 -4.0113 -3.1523 -2.2739\n(Intercept)-Nasua nasua                -3.6055 0.3932 -4.3021 -3.6386 -2.7791\n(Intercept)-Panthera onca              -2.7170 0.2697 -3.2441 -2.7149 -2.1963\n(Intercept)-Pecari tajacu              -1.2631 0.0720 -1.4015 -1.2628 -1.1233\n(Intercept)-Priodontes maximus         -3.6352 0.5065 -4.6163 -3.6447 -2.6410\n(Intercept)-Procyon cancrivorous       -3.5536 0.8292 -5.2329 -3.5137 -2.0338\n(Intercept)-Puma concolor              -1.7082 0.2078 -2.1307 -1.7023 -1.3204\n(Intercept)-Puma yagouaroundi          -3.9010 0.9613 -5.7081 -3.8840 -2.1131\n(Intercept)-Tamandua tetradactyla      -3.3440 0.8443 -5.0243 -3.2774 -1.8322\n(Intercept)-Tapirus terrestris         -1.1500 0.0793 -1.3028 -1.1477 -0.9968\n(Intercept)-Tayassu pecari             -1.6976 0.1437 -1.9871 -1.6959 -1.4247\nscale(effort)-Atelocynus microtis       0.3545 0.1897 -0.0223  0.3545  0.7290\nscale(effort)-Coendou prehensilis       0.3914 0.2253 -0.0494  0.3912  0.8505\nscale(effort)-Cuniculus paca            0.3184 0.0747  0.1715  0.3183  0.4666\nscale(effort)-Dasyprocta fuliginosa     0.3789 0.0920  0.2036  0.3792  0.5639\nscale(effort)-Dasypus sp.               0.4432 0.1370  0.1947  0.4353  0.7382\nscale(effort)-Didelphis marsupialis     0.5425 0.1981  0.1933  0.5281  0.9873\nscale(effort)-Eira barbara              0.5009 0.1960  0.1563  0.4864  0.9137\nscale(effort)-Herpailurus yagouaroundi  0.2824 0.2104 -0.1506  0.2909  0.6761\nscale(effort)-Leopardus pardalis        0.4324 0.1241  0.1987  0.4301  0.6845\nscale(effort)-Leopardus tigrinus        0.4368 0.2229  0.0101  0.4331  0.8878\nscale(effort)-Leopardus wiedii          0.4546 0.2021  0.0899  0.4489  0.8632\nscale(effort)-Mazama americana          0.5169 0.1376  0.2688  0.5090  0.8084\nscale(effort)-Mazama nemorivaga         0.2855 0.1506  0.0010  0.2827  0.5913\nscale(effort)-Myoprocta pratti          0.3059 0.1777 -0.0532  0.3076  0.6511\nscale(effort)-Myrmecophaga tridactyla   0.3910 0.1757  0.0712  0.3860  0.7668\nscale(effort)-Nasua nasua               0.4372 0.1861  0.1005  0.4298  0.8265\nscale(effort)-Panthera onca             0.2991 0.1406  0.0241  0.2960  0.5782\nscale(effort)-Pecari tajacu             0.3683 0.0804  0.2136  0.3668  0.5311\nscale(effort)-Priodontes maximus        0.2404 0.1793 -0.1086  0.2446  0.5923\nscale(effort)-Procyon cancrivorous      0.4282 0.2085  0.0312  0.4215  0.8590\nscale(effort)-Puma concolor             0.4126 0.1511  0.1316  0.4054  0.7313\nscale(effort)-Puma yagouaroundi         0.4105 0.2148 -0.0168  0.4106  0.8453\nscale(effort)-Tamandua tetradactyla     0.3281 0.2040 -0.0942  0.3277  0.7104\nscale(effort)-Tapirus terrestris        0.4066 0.0870  0.2448  0.4031  0.5888\nscale(effort)-Tayassu pecari            0.5569 0.1360  0.3047  0.5539  0.8364\n                                         Rhat  ESS\n(Intercept)-Atelocynus microtis        1.1924  166\n(Intercept)-Coendou prehensilis        1.0464  357\n(Intercept)-Cuniculus paca             1.0046 3000\n(Intercept)-Dasyprocta fuliginosa      1.0063 3000\n(Intercept)-Dasypus sp.                1.0053 2818\n(Intercept)-Didelphis marsupialis      1.0184  972\n(Intercept)-Eira barbara               1.0025  553\n(Intercept)-Herpailurus yagouaroundi   1.1280  164\n(Intercept)-Leopardus pardalis         1.0009 1226\n(Intercept)-Leopardus tigrinus         1.0105 1367\n(Intercept)-Leopardus wiedii           1.2879   91\n(Intercept)-Mazama americana           1.0000 3000\n(Intercept)-Mazama nemorivaga          1.0076 2491\n(Intercept)-Myoprocta pratti           1.0024 2424\n(Intercept)-Myrmecophaga tridactyla    1.0305  144\n(Intercept)-Nasua nasua                1.2957  187\n(Intercept)-Panthera onca              1.0274  429\n(Intercept)-Pecari tajacu              1.0012 2295\n(Intercept)-Priodontes maximus         1.0565  112\n(Intercept)-Procyon cancrivorous       1.0254  198\n(Intercept)-Puma concolor              1.0077 2209\n(Intercept)-Puma yagouaroundi          1.1210  176\n(Intercept)-Tamandua tetradactyla      1.0720  173\n(Intercept)-Tapirus terrestris         1.0012 2844\n(Intercept)-Tayassu pecari             1.0090 1808\nscale(effort)-Atelocynus microtis      1.0016 2724\nscale(effort)-Coendou prehensilis      1.0023 3000\nscale(effort)-Cuniculus paca           1.0026 3000\nscale(effort)-Dasyprocta fuliginosa    1.0093 3000\nscale(effort)-Dasypus sp.              1.0034 2792\nscale(effort)-Didelphis marsupialis    1.0107 2777\nscale(effort)-Eira barbara             1.0028 2766\nscale(effort)-Herpailurus yagouaroundi 1.0029 3000\nscale(effort)-Leopardus pardalis       1.0014 3000\nscale(effort)-Leopardus tigrinus       1.0000 3000\nscale(effort)-Leopardus wiedii         1.0044 2590\nscale(effort)-Mazama americana         1.0010 2763\nscale(effort)-Mazama nemorivaga        1.0024 3000\nscale(effort)-Myoprocta pratti         1.0026 3000\nscale(effort)-Myrmecophaga tridactyla  1.0081 2624\nscale(effort)-Nasua nasua              1.0114 2285\nscale(effort)-Panthera onca            1.0004 3000\nscale(effort)-Pecari tajacu            1.0039 2737\nscale(effort)-Priodontes maximus       1.0032 2344\nscale(effort)-Procyon cancrivorous     0.9998 2795\nscale(effort)-Puma concolor            1.0087 3000\nscale(effort)-Puma yagouaroundi        1.0024 3000\nscale(effort)-Tamandua tetradactyla    1.0024 3000\nscale(effort)-Tapirus terrestris       1.0016 3000\nscale(effort)-Tayassu pecari           1.0016 2603\n\n----------------------------------------\n    Spatial Covariance\n----------------------------------------\n         Mean     SD   2.5%     50%   97.5%   Rhat  ESS\nphi-1 10.2741 9.0131 0.0000  9.1862 26.4475 2.0409   15\nphi-2  8.8879 9.1384 0.0000  6.2172 26.3255 3.9448    8\nphi-3 13.3497 8.0913 0.4024 13.1939 26.6927 1.0017 2827\nphi-4  8.9982 9.1869 0.0000  6.5632 26.5090 4.0048   13\nphi-5 13.1044 8.0811 0.3504 12.7752 26.9119 1.0093 2688\n\n\nBayesian p-values can be inspected to check for lack of fit (overall or by species). Lack of fit at significance level = 0.05 is indicated by Bayesian p-values below 0.025 or greater than 0.975. The overall Bayesian p-value (Bpvalue) indicates no problems with lack of fit. Likewise, species-level Bayesian p-values (Bpvalue_species) indicate no lack of fit for any species.\n\nGelman and Rubin’s convergence diagnostic: Approximate convergence is diagnosed when the upper limit is close to 1.\n\nConvergence is diagnosed when the chains have ‘forgotten’ their initial values, and the output from all chains is indistinguishable. The gelman.diag diagnostic is applied to a single variable from the chain. It is based a comparison of within-chain and between-chain variances, and is similar to a classical analysis of variance.\nValues substantially above 1 indicate lack of convergence.\nModel Diagnostics\n\nCode#| eval: true\n#| echo: true\n#| code-fold: true\n#| warning: false\n#| message: false\n# Extract posterior draws for later use\nposterior1 &lt;- as.array(out.sp)\n\n# Trace plots to check chain mixing. Extract posterior samples and bind in a single matrix.\nPOSTERIOR.MATRIX &lt;- cbind(out.sp$alpha.comm.samples, \n                          out.sp$beta.comm.samples,  \n                          out.sp$alpha.samples, \n                          out.sp$beta.samples)\n\n# Matrix output is all chains combined, split into 3 chains.\nCHAIN.1 &lt;- as.mcmc(POSTERIOR.MATRIX[1:1000,])\nCHAIN.2 &lt;- as.mcmc(POSTERIOR.MATRIX[1001:2000,])\nCHAIN.3 &lt;- as.mcmc(POSTERIOR.MATRIX[2001:3000,])\n# CHAIN.4 &lt;- as.mcmc(POSTERIOR.MATRIX[8001:10000,])\n\n# Bind four chains as coda mcmc.list object.\nPOSTERIOR.CHAINS &lt;- mcmc.list(CHAIN.1, CHAIN.2, CHAIN.3)#, CHAIN.4)\n\n# Create an empty folder.\n# dir.create (\"Beetle_plots\")\n\n# Plot chain mixing of each parameter to a multi-panel plot and save to the new folder. ART 5 mins\n\n######################################\n#### SAVE Diagnostics at PDF\n# MCMCtrace(POSTERIOR.CHAINS, params = \"all\", Rhat = TRUE, n.eff = TRUE)#, pdf = TRUE, filename = \"Beetle_240909_traceplots.pdf\", wd = \"Beetle_plots\")\n\n\n\n#mcmc_trace(fit.commu, parms = c(\"beta.ranef.cont.border_dist.mean\"))\n\n#posterior2 &lt;- extract(fit.commu, inc_warmup = TRUE, permuted = FALSE)\n\n#color_scheme_set(\"mix-blue-pink\")\n#p &lt;- mcmc_trace(posterior1,  pars = c(\"mu\", \"tau\"), n_warmup = 300,\n#                facet_args = list(nrow = 2, labeller = label_parsed))\n#p + facet_text(size = 15)\n\n\n\n#outMCMC &lt;- fit.commu #Convert output to MCMC object\n#diagnostics chains \n\n# all as pdf\n# MCMCtrace(outMCMC)\n\n# MCMCtrace(outMCMC, params = c(\"alpha0\"), type = 'trace', Rhat = TRUE, n.eff = TRUE)\n\n# MCMCtrace(outMCMC, params = c(\"beta0\"), type = 'trace', Rhat = TRUE, n.eff = TRUE)\n\n# MCMCtrace(outMCMC, params = c(\"beta.ranef.cont.border_dist\"), type = 'trace', Rhat = TRUE, n.eff = TRUE)\n\n# MCMCtrace(out.sp, params = c(\"beta.ranef.cont.border_dist.mean\"), type = 'trace', pdf = F, Rhat = TRUE, n.eff = TRUE)\n\n# MCMCtrace(outMCMC, params = c(\"beta.ranef.cont.elev\"), type = 'trace', Rhat = TRUE, n.eff = TRUE)\n\n# MCMCtrace(outMCMC, params = c(\"beta.ranef.cont.elev.mean\"), type = 'trace', pdf = F, Rhat = TRUE, n.eff = TRUE)\n\n\n### density\n# MCMCtrace(outMCMC, params = c(\"Nspecies\"), ISB = FALSE, pdf = F, exact = TRUE, post_zm = TRUE, type = 'density', Rhat = TRUE, n.eff = TRUE, ind = TRUE)\n\n### density\n# MCMCtrace(outMCMC, params = c(\"beta.ranef.cont.elev.mean\"), ISB = FALSE, pdf = F, exact = TRUE, post_zm = TRUE, type = 'density', Rhat = TRUE, n.eff = TRUE, ind = TRUE)\n\n### density\n#MCMCtrace(outMCMC, params = c(\"beta.ranef.cont.border_dist.mean\"), ISB = FALSE, pdf = F, exact = TRUE, post_zm = TRUE, type = 'density', Rhat = TRUE, n.eff = TRUE, ind = TRUE)\n\n#coda::gelman.diag(outMCMC,  multivariate = FALSE, transform=FALSE)\n                    \n# coda::gelman.plot(outMCMC,  multivariate = FALSE)\n\n\n\n# \n# mcmc_intervals(outMCMC, pars = c(\"Nspecies_in_AP[1]\",\n#                                  \"Nspecies_in_AP[2]\"),\n#                point_est = \"mean\",\n#                prob = 0.75, prob_outer = 0.95) +\n#   ggtitle(\"Number of species\") + \n#   scale_y_discrete(labels = c(\"Nspecies_in_AP[1]\"=levels(sitecovs$in_AP)[1],\n#              \"Nspecies_in_AP[2]\"=levels(sitecovs$in_AP)[2]))\n# \n# #Continuous\n# p &lt;- mcmc_intervals(outMCMC, \n#                pars = c(\"beta.ranef.cont.border_dist.mean\",\n#                          #\"beta.ranef.cont.elev.mean\",\n#                         \"beta.ranef.categ.in_AP.mean[2]\"))\n# \n# # relabel parameters\n# p + scale_y_discrete(\n#   labels = c(\"beta.ranef.cont.border_dist.mean\"=\"Dist_border\",\n#                          #\"beta.ranef.cont.elev.mean\"=\"Elevation\",\n#                         \"beta.ranef.categ.in_AP.mean[2]\"=\"in_AP\")\n# ) +\n#   ggtitle(\"Treatment effect on all species\")\n# \n\n\nPosterior Summary (effect)\nCommunity effects\nCode# Create simple plot summaries using MCMCvis package.\n# Detection covariate effects --------- \nMCMCplot(out.sp$alpha.comm.samples, ref_ovl = TRUE, ci = c(50, 95))\n# Occupancy community-level effects \nMCMCplot(out.sp$beta.comm.samples, ref_ovl = TRUE, ci = c(50, 95))\n\n\n\n\n\n\n\n\n\n(a) Detection\n\n\n\n\n\n\n\n\n\n(b) Occupancy\n\n\n\n\n\n\nFigure 1: Community effects\n\n\nSpecies effects\nCode# Occupancy species-level effects \nMCMCplot(out.sp$beta.samples[,26:50], ref_ovl = TRUE, ci = c(50, 95))\n\n# Occupancy species-level effects \nMCMCplot(out.sp$beta.samples[,51:75], ref_ovl = TRUE, ci = c(50, 95))\n\n\n\n\n\n\n\n\n\n(a) elevation\n\n\n\n\n\n\n\n\n\n(b) distance border\n\n\n\n\n\n\nFigure 2: Species effects\n\n\nSpecies effects using bayesplot\n\n\nCodelibrary(bayesplot)\n#mcmc_areas(outMCMC, regex_pars = \"Nspecies_in_AP\")\n# mcmc_areas(outMCMC, regex_pars = \"Nspecies_in_AP\")\n\nmcmc_intervals(out.sp$beta.samples[,26:50] , point_est = \"mean\",\n               prob = 0.75, prob_outer = 0.95) + \n  geom_vline(xintercept = 0, color = \"red\", linetype = \"dashed\", size = 0.5)\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\nCodemcmc_intervals(out.sp$beta.samples[,51:75] , point_est = \"mean\",\n               prob = 0.75, prob_outer = 0.95) + \n  geom_vline(xintercept = 0, color = \"red\", linetype = \"dashed\", size = 0.5)\n\n\n\n\n\n\nCodemcmc_intervals(out.sp$beta.samples[,76:100] , point_est = \"mean\",\n               prob = 0.75, prob_outer = 0.95) + \n  geom_vline(xintercept = 0, color = \"red\", linetype = \"dashed\", size = 0.5)\n\n\n\n\n\n\n\nPrediction as graph\nThis prediction uses the non spatial model\n\nCode# 6. Prediction -----------------------------------------------------------\n# Predict occupancy along a gradient of elev   \n# Create a set of values across the range of observed elev values\nelev.pred.vals &lt;- seq(min(data_list$occ.covs$elev), \n                              max(data_list$occ.covs$elev), \n                              length.out = 100)\n# Scale predicted values by mean and standard deviation used to fit the model\nelev.pred.vals.scale &lt;- (elev.pred.vals - mean(data_list$occ.covs$elev)) / \n                             sd(data_list$occ.covs$elev)\n# Create a set of values across the range of observed elev values\nborder_dist.pred.vals &lt;- seq(min(data_list$occ.covs$border_dist), \n                              max(data_list$occ.covs$border_dist), \n                              length.out = 100)\n# Scale predicted values by mean and standard deviation used to fit the model\nborder_dist.pred.vals.scale &lt;- (border_dist.pred.vals -\n                                  mean(data_list$occ.covs$border_dist)) /\n                                  sd(data_list$occ.covs$border_dist)\n\n# Predict occupancy across elev  values at mean values of all other variables\npred.df1 &lt;- as.matrix(data.frame(intercept = 1, \n                                 elev = elev.pred.vals.scale, \n                                 border_dist = 0,\n                                 FLII=0))#, catchment = 0, density = 0, \n                         # slope = 0))\n# Predict occupancy across elev  values at mean values of all other variables\npred.df2 &lt;- as.matrix(data.frame(intercept = 1, elev = 0, \n                         border_dist = border_dist.pred.vals.scale,\n                         FLII= 0 ))#, catchment = 0, density = 0, \n                         # slope = 0))\n\nout.pred1 &lt;- predict(out, pred.df1) # using non spatial\nstr(out.pred1)\n\nList of 3\n $ psi.0.samples: num [1:1500, 1:25, 1:100] 0.131 0.0911 0.1402 0.1496 0.0953 ...\n $ z.0.samples  : int [1:1500, 1:25, 1:100] 0 0 0 0 0 0 1 0 1 0 ...\n $ call         : language predict.msPGOcc(object = out, X.0 = pred.df1)\n - attr(*, \"class\")= chr \"predict.msPGOcc\"\n\nCodepsi.0.quants &lt;- apply(out.pred1$psi.0.samples, c(2, 3), quantile, \n                          prob = c(0.025, 0.5, 0.975))\nsp.codes &lt;- attr(data_list$y, \"dimnames\")[[1]]\npsi.plot.dat &lt;- data.frame(psi.med = c(t(psi.0.quants[2, , ])), \n                                 psi.low = c(t(psi.0.quants[1, , ])), \n                                 psi.high = c(t(psi.0.quants[3, , ])), \n                           elev = elev.pred.vals, \n                                 sp.codes = rep(sp.codes, \n                                                each = length(elev.pred.vals)))\n\nggplot(psi.plot.dat, aes(x = elev, y = psi.med)) + \n  geom_ribbon(aes(ymin = psi.low, ymax = psi.high), fill = 'grey70') +\n  geom_line() + \n  facet_wrap(vars(sp.codes)) + \n  theme_bw() + \n  labs(x = 'elevation (m)', y = 'Occupancy Probability') \n\n\n\n\n\n\nCodeout.pred2 &lt;- predict(out, pred.df2) # using non spatial\nstr(out.pred2)\n\nList of 3\n $ psi.0.samples: num [1:1500, 1:25, 1:100] 0.1631 0.0662 0.0919 0.0636 0.1146 ...\n $ z.0.samples  : int [1:1500, 1:25, 1:100] 0 0 0 0 0 0 0 0 1 1 ...\n $ call         : language predict.msPGOcc(object = out, X.0 = pred.df2)\n - attr(*, \"class\")= chr \"predict.msPGOcc\"\n\nCodepsi.0.quants &lt;- apply(out.pred2$psi.0.samples, c(2, 3), quantile, \n                          prob = c(0.025, 0.5, 0.975))\nsp.codes &lt;- attr(data_list$y, \"dimnames\")[[1]]\npsi.plot.dat &lt;- data.frame(psi.med = c(t(psi.0.quants[2, , ])), \n                                 psi.low = c(t(psi.0.quants[1, , ])), \n                                 psi.high = c(t(psi.0.quants[3, , ])), \n                           border_dist = border_dist.pred.vals, \n                                 sp.codes = rep(sp.codes, \n                                                each = length(border_dist.pred.vals)))\n\nggplot(psi.plot.dat, aes(x = border_dist/1000, y = psi.med)) + \n  geom_ribbon(aes(ymin = psi.low, ymax = psi.high), fill = 'grey70') +\n  geom_line() + \n  facet_wrap(vars(sp.codes)) + \n  theme_bw() + \n  labs(x = 'border_dist (Km)', y = 'Occupancy Probability') \n\n\n\n\n\n\n\nSpatial Prediction in elevation_EC\n\nCode#aggregate  resolution to (factor = 3)\n#transform coord data to UTM\nelevation_UTM &lt;- project(elevation_EC, \"EPSG:10603\")\nelevation_17.aggregate &lt;- aggregate(elevation_UTM, fact=10)\nres(elevation_17.aggregate)\n\n[1] 5984.313 5984.313\n\nCode# Convert the SpatRaster to a data frame with coordinates\ndf_coords &lt;- as.data.frame(elevation_17.aggregate, xy = TRUE)\nnames(df_coords) &lt;-c(\"X\",\"Y\",\"elev\")\n\nelev.pred &lt;- (df_coords$elev - mean(data_list$occ.covs$elev)) / sd(data_list$occ.covs$elev)\n\n\n############### Predict new data ############### \n# we predict at one covariate varing and others at mean value = 0\n# intercept = 1, elev = 0, border_dist = 0, FLII= 0\n# in that order\n################ ################ ################ \npredict_data &lt;- cbind(1, elev.pred, 0, 0)\ncolnames(predict_data) &lt;- c(\"intercept\",\n                            \"elev\",\n                            \"border_dist\",\n                            \"FLII\" )\n\n# X.0 &lt;- cbind(1, 1, elev.pred)#, elev.pred^2)\n\n# coords.0 &lt;- as.matrix(hbefElev[, c('Easting', 'Northing')])\nout.sp.ms.pred &lt;- predict(out.sp, \n                          X.0=predict_data, \n                          df_coords[,1:2],\n                          threads=4) #Warning :'threads' is not an argument\n\nWarning in predict.sfMsPGOcc(out.sp, X.0 = predict_data, df_coords[, 1:2], :\n'threads' is not an argument\n\n\n----------------------------------------\n    Prediction description\n----------------------------------------\nSpatial Factor NNGP Multispecies Occupancy model with Polya-Gamma latent\nvariable fit with 377 observations.\n\nNumber of covariates 4 (including intercept if specified).\n\nUsing the exponential spatial correlation model.\n\nUsing 15 nearest neighbors.\nUsing 5 latent spatial factors.\n\nNumber of MCMC samples 3000.\n\nPredicting at 2618 non-sampled locations.\n\n\nSource compiled with OpenMP support and model fit using 1 threads.\n-------------------------------------------------\n        Predicting\n-------------------------------------------------\nLocation: 100 of 2618, 3.82%\nLocation: 200 of 2618, 7.64%\nLocation: 300 of 2618, 11.46%\nLocation: 400 of 2618, 15.28%\nLocation: 500 of 2618, 19.10%\nLocation: 600 of 2618, 22.92%\nLocation: 700 of 2618, 26.74%\nLocation: 800 of 2618, 30.56%\nLocation: 900 of 2618, 34.38%\nLocation: 1000 of 2618, 38.20%\nLocation: 1100 of 2618, 42.02%\nLocation: 1200 of 2618, 45.84%\nLocation: 1300 of 2618, 49.66%\nLocation: 1400 of 2618, 53.48%\nLocation: 1500 of 2618, 57.30%\nLocation: 1600 of 2618, 61.12%\nLocation: 1700 of 2618, 64.94%\nLocation: 1800 of 2618, 68.75%\nLocation: 1900 of 2618, 72.57%\nLocation: 2000 of 2618, 76.39%\nLocation: 2100 of 2618, 80.21%\nLocation: 2200 of 2618, 84.03%\nLocation: 2300 of 2618, 87.85%\nLocation: 2400 of 2618, 91.67%\nLocation: 2500 of 2618, 95.49%\nLocation: 2600 of 2618, 99.31%\nLocation: 2618 of 2618, 100.00%\nGenerating latent occupancy state\n\nCode# extract the array of interest= occupancy\npredicted_array &lt;- out.sp.ms.pred$psi.0.samples\n\n\n\ndim(predicted_array)\n\n[1] 3000   25 2618\n\nCode# df_plot &lt;- NA # empty column\npredicted_raster_list &lt;- list() # rast(nrows = 52, ncols = 103,\n                         #ext(elevation_17.aggregate), \n                         # crs = \"EPSG:32717\")\n\n###################################################\n# simpler way to make mean in the array by species\n# array order: itera=3000, sp=22, pixels=5202\n# we wan to keep index 2 and 3\nlibrary(plyr)\n\n------------------------------------------------------------------------------\n\n\nYou have loaded plyr after dplyr - this is likely to cause problems.\nIf you need functions from both plyr and dplyr, please load plyr first, then dplyr:\nlibrary(plyr); library(dplyr)\n\n\n------------------------------------------------------------------------------\n\n\n\nAdjuntando el paquete: 'plyr'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    arrange, count, desc, failwith, id, mutate, rename, summarise,\n    summarize\n\n\nThe following object is masked from 'package:purrr':\n\n    compact\n\n\nThe following object is masked from 'package:maps':\n\n    ozone\n\nCodearesult = (plyr::aaply(predicted_array, # mean fo all iterations\n                       c(2,3), \n                       mean))\n\n##############################################\n#### Loop to make rasters and put in a list\n# array order: itera=3000, sp=22, pixels=5202\nfor (i in 1:dim(predicted_array)[2]){\n # Convert array slice to data frame\n # df_plot[i] &lt;- as.data.frame(predicted_array[1, i, ]) # sp_i\n # df_plot[i] &lt;- as.vector(aresult[i,]) # Extract sp\n # Producing an SDM for all (posterior mean)\n plot.dat &lt;- data.frame(x = df_coords$X, \n                        y = df_coords$Y, \n                        psi.sp = as.vector(aresult[i,]))\n pred_rast &lt;- rast(plot.dat, \n                   type = \"xyz\", \n                   crs = \"EPSG:10603\") # Replace EPSG:4326 with your CRS\n predicted_raster_list[[i]] &lt;- pred_rast\n}\n\n# Convert the list to a SpatRaster stack\npredictad_raster_stack &lt;- rast(predicted_raster_list)\n# put species names\nnames(predictad_raster_stack) &lt;- selected.sp\n\nplot(predictad_raster_stack)\n\n\n\n\n\n\nCode# get the mean\npredicted_mean &lt;- mean(predictad_raster_stack)\n\nplot(predicted_mean, main=\"mean occupancy\")\n\n\n\n\n\n\nCodemapview(predicted_mean) + mapview(AP_Yasuni_UTM_line)\n\n\n\n\nCode#"
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html#package-citation",
    "href": "blog/2025-10-15-analysis/index.html#package-citation",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "Package Citation",
    "text": "Package Citation\n\nCodepkgs &lt;- cite_packages(output = \"paragraph\", pkgs=\"Session\", out.dir = \".\")\n# knitr::kable(pkgs)\npkgs\n\nWe used R v. 4.4.2 (R Core Team 2024) and the following R packages: abind v. 1.4.8 (Plate and Heiberger 2024), bayesplot v. 1.14.0 (Gabry et al. 2019; Gabry and Mahr 2025), beepr v. 2.0 (Bååth 2024), camtrapR v. 3.0.0 (Niedballa et al. 2016), coda v. 0.19.4.1 (Plummer et al. 2006), DT v. 0.34.0 (Xie et al. 2025), elevatr v. 0.99.0 (Hollister et al. 2023), maps v. 3.4.3 (Becker et al. 2025), mapview v. 2.11.4 (Appelhans et al. 2025), MCMCvis v. 0.16.3 (Youngflesh 2018), plyr v. 1.8.9 (Wickham 2011), sf v. 1.0.21 (Pebesma 2018; Pebesma and Bivand 2023), snow v. 0.4.4 (Tierney et al. 2021), snowfall v. 1.84.6.3 (Knaus 2023), spOccupancy v. 0.8.0 (Doser et al. 2022, 2024; Doser, Finley, and Banerjee 2023), terra v. 1.8.70 (Hijmans 2025), tictoc v. 1.2.1 (Izrailev 2024), tidyverse v. 2.0.0 (Wickham et al. 2019), tmap v. 4.2 (Tennekes 2018)."
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html#sesion-info",
    "href": "blog/2025-10-15-analysis/index.html#sesion-info",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "Sesion info",
    "text": "Sesion info\n\n\n\n\n\n\nNote\n\n\n\n\n\n\nCodeprint(sessionInfo(), locale = FALSE)\n\nR version 4.4.2 (2024-10-31 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: internal\n\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] plyr_1.8.9        abind_1.4-8       lubridate_1.9.4   forcats_1.0.0    \n [5] stringr_1.5.2     dplyr_1.1.4       purrr_1.1.0       readr_2.1.5      \n [9] tidyr_1.3.1       tibble_3.2.1      ggplot2_4.0.0     tidyverse_2.0.0  \n[13] spOccupancy_0.8.0 camtrapR_3.0.0    snowfall_1.84-6.3 snow_0.4-4       \n[17] beepr_2.0         coda_0.19-4.1     MCMCvis_0.16.3    tictoc_1.2.1     \n[21] bayesplot_1.14.0  elevatr_0.99.0    terra_1.8-70      tmap_4.2         \n[25] maps_3.4.3        mapview_2.11.4    sf_1.0-21         DT_0.34.0        \n[29] readxl_1.4.3      grateful_0.3.0   \n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3      tensorA_0.36.2.1        rstudioapi_0.17.1      \n  [4] audio_0.1-11            jsonlite_2.0.0          wk_0.9.4               \n  [7] magrittr_2.0.3          farver_2.1.2            nloptr_2.1.1           \n [10] rmarkdown_2.30          vctrs_0.6.5             minqa_1.2.8            \n [13] base64enc_0.1-3         RcppNumerical_0.6-0     progress_1.2.3         \n [16] htmltools_0.5.8.1       leafsync_0.1.0          distributional_0.5.0   \n [19] curl_7.0.0              raster_3.6-32           cellranger_1.1.0       \n [22] s2_1.1.9                sass_0.4.10             bslib_0.9.0            \n [25] slippymath_0.3.1        KernSmooth_2.23-24      htmlwidgets_1.6.4      \n [28] cachem_1.1.0            stars_0.6-8             uuid_1.2-1             \n [31] mime_0.13               lifecycle_1.0.4         iterators_1.0.14       \n [34] pkgconfig_2.0.3         cols4all_0.8-1          Matrix_1.7-1           \n [37] R6_2.6.1                fastmap_1.2.0           shiny_1.9.1            \n [40] digest_0.6.37           colorspace_2.1-1        leafem_0.2.4           \n [43] crosstalk_1.2.1         labeling_0.4.3          lwgeom_0.2-14          \n [46] progressr_0.15.0        spacesXYZ_1.6-0         timechange_0.3.0       \n [49] httr_1.4.7              mgcv_1.9-1              compiler_4.4.2         \n [52] microbenchmark_1.5.0    proxy_0.4-27            withr_3.0.2            \n [55] doParallel_1.0.17       backports_1.5.0         brew_1.0-10            \n [58] S7_0.2.0                DBI_1.2.3               logger_0.4.0           \n [61] MASS_7.3-61             maptiles_0.10.0         tmaptools_3.3          \n [64] leaflet_2.2.3           classInt_0.4-11         tools_4.4.2            \n [67] units_0.8-7             leaflegend_1.2.1        httpuv_1.6.16          \n [70] glue_1.8.0              satellite_1.0.5         nlme_3.1-166           \n [73] promises_1.3.3          grid_4.4.2              checkmate_2.3.2        \n [76] reshape2_1.4.4          generics_0.1.3          leaflet.providers_2.0.0\n [79] gtable_0.3.6            tzdb_0.4.0              shinyBS_0.61.1         \n [82] class_7.3-22            data.table_1.17.8       hms_1.1.3              \n [85] sp_2.2-0                RANN_2.6.2              foreach_1.5.2          \n [88] pillar_1.11.1           posterior_1.6.1         later_1.4.2            \n [91] splines_4.4.2           lattice_0.22-6          tidyselect_1.2.1       \n [94] knitr_1.50              svglite_2.1.3           stats4_4.4.2           \n [97] xfun_0.52               shinydashboard_0.7.3    leafpop_0.1.0          \n[100] stringi_1.8.4           rematch_2.0.0           yaml_2.3.10            \n[103] boot_1.3-31             evaluate_1.0.4          codetools_0.2-20       \n[106] cli_3.6.5               RcppParallel_5.1.9      systemfonts_1.1.0      \n[109] xtable_1.8-4            jquerylib_0.1.4         secr_5.1.0             \n[112] dichromat_2.0-0.1       Rcpp_1.1.0              spAbundance_0.2.1      \n[115] png_0.1-8               XML_3.99-0.18           parallel_4.4.2         \n[118] prettyunits_1.2.0       lme4_1.1-35.5           mvtnorm_1.3-2          \n[121] scales_1.4.0            e1071_1.7-16            crayon_1.5.3           \n[124] rlang_1.1.6"
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html#single-species-occupancy-models",
    "href": "blog/2025-10-15-analysis/index.html#single-species-occupancy-models",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "",
    "text": "Single-species occupancy models (MacKenzie et al., 2002) are widely used in ecology to estimate and predict the spatial distribution of a species from data collected in presence–absence repeated surveys. The popularity of these models stems from their ability to estimate the effects of environmental or management covariates on species occurrences, while accounting for false-negative errors in detection, which are common in surveys of natural populations."
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html#multi-species-occupancy-models",
    "href": "blog/2025-10-15-analysis/index.html#multi-species-occupancy-models",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "Multi-species occupancy models",
    "text": "Multi-species occupancy models\nMulti-species occupancy models for estimating the effects of environmental covariates on several species occurrences while accounting for imperfect detection were build on the principle of the Single-species occupancy model, and developed more than 20 years ago.\nMulti-species occupancy models are a powerful tool for combining information from multiple species to estimate both individual and community-level responses to management and environmental variables."
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html#objective",
    "href": "blog/2025-10-15-analysis/index.html#objective",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "Objective",
    "text": "Objective\nWe want to asses the effect of protected areas on the occupancy of the species. We hypothesize that several mammal species have benefited of the conservation actions provided by protected areas, so we expect a decreases in occupancy from the interior of the protected area to the exterior as a function of the distance to the protected area border.\nTo account for several ecological factors we also tested and included elevation and forest integrity index as occupancy covariates.\nWe used the newly developed R package spOccupancy as approach to modelling the probability of occurrence of each species as a function of fixed effects of measured environmental covariates and random effects designed to account for unobserved sources of spatial dependence (spatial autocorrelation).\n\nCodelibrary(grateful) # Facilitate Citation of R Packages\nlibrary(readxl) # Read Excel Files\nlibrary(DT) # A Wrapper of the JavaScript Library 'DataTables'\nlibrary(sf) # Simple Features for R\nlibrary(mapview) # Interactive Viewing of Spatial Data in R\nlibrary(maps) # Draw Geographical Maps\nlibrary(tmap) # Thematic Maps\nlibrary(terra) # Spatial Data Analysis\nlibrary(elevatr) # Access Elevation Data from Various APIs\n\n# library(rjags) # Bayesian Graphical Models using MCMC \nlibrary(bayesplot) # Plotting for Bayesian Models # Plotting for Bayesian Models\nlibrary(tictoc) # Functions for Timing R Scripts, as Well as Implementations of \"Stack\" and \"StackList\" Structures \nlibrary(MCMCvis) # Tools to Visualize, Manipulate, and Summarize MCMC Output\nlibrary(coda) # Output Analysis and Diagnostics for MCMC\nlibrary(beepr) # Easily Play Notification Sounds on any Platform \nlibrary(snowfall) # Easier Cluster Computing (Based on 'snow')\n\n#library(ggmcmc)\nlibrary(camtrapR) # Camera Trap Data Management and Preparation \nlibrary(spOccupancy) # Single-Species, Multi-Species, and Integrated Spatial Occupancy\nlibrary(tidyverse) # Easily Install and Load the 'Tidyverse'"
  }
]