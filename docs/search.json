[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Occupancy in Protected Areas",
    "section": "",
    "text": "We want to asses the effect of protected areas on the occupancy of the species. We hypothesize that several mammal species have benefited of the conservation actions provided by protected areas, so we expect a decreases in occupancy from the interior of the protected area to the exterior as a function of the distance to the protected area border.\nWe used a multispecies occupancy model incorporating spatial autocorrelation, to asses occupancy as a function of the distance to the protected area border.\nTo account for several ecological factors we also tested and included elevation and forest integrity index (FLII) as occupancy covariates.\nWe used the newly developed R package spOccupancy as approach to modelling the probability of occurrence of each species as a function of fixed effects of measured environmental covariates and random effects designed to account for unobserved sources of spatial dependence (spatial autocorrelation).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nThe problem we want to asses\n\n\n\nmodel\n\n\n\n\nMay 20, 2025\n\n\n\n\n\n\n\n\n\n\n\n\n\nFitting a Spatial Factor Multi-Species Occupancy Model\n\n\n\nmodel\n\ncode\n\nanalysis\n\n\n\n\nMay 16, 2025\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "blog/2025-10-10-the-model/index.html",
    "href": "blog/2025-10-10-the-model/index.html",
    "title": "The problem we want to asses",
    "section": "",
    "text": "Codelibrary(grateful) # Facilitate Citation of R Packages\nlibrary(readxl) # Read Excel Files\nlibrary(DT) # A Wrapper of the JavaScript Library 'DataTables'\nlibrary(sf) # Simple Features for R\nlibrary(mapview) # Interactive Viewing of Spatial Data in R\nlibrary(maps) # Draw Geographical Maps\nlibrary(tmap) # Thematic Maps\nlibrary(terra) # Spatial Data Analysis\nlibrary(elevatr) # Access Elevation Data from Various APIs\nlibrary(unmarked) # Models for Data from Unmarked Animals\nlibrary(ubms) # Bayesian Models for Data from Unmarked Animals using 'Stan'\n\nlibrary(tidyverse) # Easily Install and Load the 'Tidyverse'\nWe want to Asses the role of Protected Areas (PA) in the conservation of vertebrates using on the ground data.\nEvaluating whether PA are working is essential as they are perhaps the primary strategy for averting biodiversity loss. Its been suggested that some do no work, paper parks Its crucial to continue working on best methods to evaluate their impact.\nOver a decade ago researchers started evaluating role of PA, mostly focused on the effects of PA in reducing threats (fires, deforestation) and focused on forest cover. However assessments of PA on species comparing inside vs outside is not a common practice.\nEven if we are effective in protecting forests, and the forest is in very good condition, PA could have “empty forests” and loosed biodiversity (by hunting-poaching, diseases or introduced species). So when we say a PA is effective, are we looking at this?\nWe want to compare apples with apples and control for covariates related with occupancy and abundance of species, like elevation, human pressures, ecosystem type, etc.\nOccupancy is a cost effective method for evaluation a population, it is a state variable, representing the proportion of the area occupied by the species, solving the problem of imperfect detection.\nWe compiled camera trap deployment data sets that have intentionally sampled inside and outside PAS, in a quasi-experimental design, using camera traps.\nEach case each camera is adequately matched, in a similar fashion as the remote sensing approaches.\nWe used a multispecies occupancy model, and a variation incorporating spatial autocorrelation, to compare occupancy inside and outside the PA and also as a distance to the protected area border."
  },
  {
    "objectID": "blog/2025-10-10-the-model/index.html#package-citation",
    "href": "blog/2025-10-10-the-model/index.html#package-citation",
    "title": "The problem we want to asses",
    "section": "Package Citation",
    "text": "Package Citation\n\nCodepkgs &lt;- cite_packages(output = \"paragraph\", pkgs=\"Session\", out.dir = \".\")\n# knitr::kable(pkgs)\npkgs\n\nWe used R v. 4.4.2 (R Core Team 2024) and the following R packages: DT v. 0.34.0 (Xie et al. 2025), elevatr v. 0.99.0 (Hollister et al. 2023), maps v. 3.4.3 (Becker et al. 2025), mapview v. 2.11.4 (Appelhans et al. 2025), sf v. 1.0.21 (Pebesma 2018; Pebesma and Bivand 2023), terra v. 1.8.60 (Hijmans 2025), tidyverse v. 2.0.0 (Wickham et al. 2019), tmap v. 4.2 (Tennekes 2018), ubms v. 1.2.7 (Kellner et al. 2021), unmarked v. 1.5.0 (Fiske and Chandler 2011; Kellner et al. 2023)."
  },
  {
    "objectID": "blog/2025-10-10-the-model/index.html#sesion-info",
    "href": "blog/2025-10-10-the-model/index.html#sesion-info",
    "title": "The problem we want to asses",
    "section": "Sesion info",
    "text": "Sesion info\n\n\n\n\n\n\nNote\n\n\n\n\n\n\nCodeprint(sessionInfo(), locale = FALSE)\n\nR version 4.4.2 (2024-10-31 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: default\n\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] lubridate_1.9.4 forcats_1.0.0   stringr_1.5.2   dplyr_1.1.4    \n [5] purrr_1.1.0     readr_2.1.5     tidyr_1.3.1     tibble_3.2.1   \n [9] ggplot2_4.0.0   tidyverse_2.0.0 ubms_1.2.7      unmarked_1.5.0 \n[13] elevatr_0.99.0  terra_1.8-60    tmap_4.2        maps_3.4.3     \n[17] mapview_2.11.4  sf_1.0-21       DT_0.34.0       readxl_1.4.3   \n[21] grateful_0.3.0 \n\nloaded via a namespace (and not attached):\n [1] DBI_1.2.3            pbapply_1.7-2        gridExtra_2.3       \n [4] tmaptools_3.3        s2_1.1.9             inline_0.3.20       \n [7] logger_0.4.0         rlang_1.1.6          magrittr_2.0.3      \n[10] matrixStats_1.5.0    e1071_1.7-16         compiler_4.4.2      \n[13] loo_2.8.0            png_0.1-8            vctrs_0.6.5         \n[16] pkgconfig_2.0.3      wk_0.9.4             fastmap_1.2.0       \n[19] lwgeom_0.2-14        leafem_0.2.4         rmarkdown_2.29      \n[22] tzdb_0.4.0           spacesXYZ_1.6-0      xfun_0.52           \n[25] satellite_1.0.5      jsonlite_2.0.0       parallel_4.4.2      \n[28] R6_2.6.1             stringi_1.8.4        RColorBrewer_1.1-3  \n[31] StanHeaders_2.32.10  cellranger_1.1.0     stars_0.6-8         \n[34] Rcpp_1.1.0           rstan_2.32.6         knitr_1.50          \n[37] base64enc_0.1-3      timechange_0.3.0     Matrix_1.7-1        \n[40] tidyselect_1.2.1     rstudioapi_0.17.1    dichromat_2.0-0.1   \n[43] abind_1.4-8          yaml_2.3.10          maptiles_0.10.0     \n[46] codetools_0.2-20     curl_7.0.0           pkgbuild_1.4.8      \n[49] lattice_0.22-6       leafsync_0.1.0       withr_3.0.2         \n[52] S7_0.2.0             evaluate_1.0.4       units_0.8-7         \n[55] proxy_0.4-27         RcppParallel_5.1.9   pillar_1.11.1       \n[58] KernSmooth_2.23-24   stats4_4.4.2         generics_0.1.3      \n[61] sp_2.2-0             hms_1.1.3            rstantools_2.4.0    \n[64] scales_1.4.0         class_7.3-22         glue_1.8.0          \n[67] tools_4.4.2          leaflegend_1.2.1     data.table_1.17.8   \n[70] RSpectra_0.16-2      XML_3.99-0.18        grid_4.4.2          \n[73] QuickJSR_1.4.0       crosstalk_1.2.1      colorspace_2.1-1    \n[76] cols4all_0.8-1       raster_3.6-32        cli_3.6.5           \n[79] V8_6.0.0             gtable_0.3.6         digest_0.6.37       \n[82] progressr_0.15.0     classInt_0.4-11      htmlwidgets_1.6.4   \n[85] farver_2.1.2         htmltools_0.5.8.1    lifecycle_1.0.4     \n[88] leaflet_2.2.3        microbenchmark_1.5.0 MASS_7.3-61"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html",
    "href": "blog/2025-10-15-analysis/index.html",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "",
    "text": "Multi-species occupancy models are a powerful tool for combining information from multiple species to estimate both individual and community-level responses to management and environmental variables.\n\nCodelibrary(grateful)\nlibrary(readxl)\nlibrary(DT)\nlibrary(sf)\nlibrary(mapview)\nlibrary(maps)\nlibrary(tmap)\nlibrary(terra)\nlibrary(elevatr)\n#library(spOccupancy)\n\n# library(rjags) # Bayesian Graphical Models using MCMC \nlibrary(bayesplot) # Plotting for Bayesian Models # Plotting for Bayesian Models\nlibrary(tictoc) # Functions for Timing R Scripts, as Well as Implementations of \"Stack\" and \"StackList\" Structures \nlibrary(MCMCvis)\nlibrary(coda)\nlibrary(beepr) # Easily Play Notification Sounds on any Platform \nlibrary(snowfall) # Easier Cluster Computing (Based on 'snow')\n\n#library(ggmcmc)\nlibrary(camtrapR)\nlibrary(spOccupancy)\nlibrary(tidyverse)"
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html#multi-species-occupancy-model-using-spoccupancy",
    "href": "blog/2025-10-15-analysis/index.html#multi-species-occupancy-model-using-spoccupancy",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "",
    "text": "Multi-species occupancy models are a powerful tool for combining information from multiple species to estimate both individual and community-level responses to management and environmental variables.\n\nCodelibrary(grateful)\nlibrary(readxl)\nlibrary(DT)\nlibrary(sf)\nlibrary(mapview)\nlibrary(maps)\nlibrary(tmap)\nlibrary(terra)\nlibrary(elevatr)\n#library(spOccupancy)\n\n# library(rjags) # Bayesian Graphical Models using MCMC \nlibrary(bayesplot) # Plotting for Bayesian Models # Plotting for Bayesian Models\nlibrary(tictoc) # Functions for Timing R Scripts, as Well as Implementations of \"Stack\" and \"StackList\" Structures \nlibrary(MCMCvis)\nlibrary(coda)\nlibrary(beepr) # Easily Play Notification Sounds on any Platform \nlibrary(snowfall) # Easier Cluster Computing (Based on 'snow')\n\n#library(ggmcmc)\nlibrary(camtrapR)\nlibrary(spOccupancy)\nlibrary(tidyverse)"
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html#fitting-a-multi-species-spatial-occupancy-model",
    "href": "blog/2025-10-15-analysis/index.html#fitting-a-multi-species-spatial-occupancy-model",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "Fitting a Multi-Species Spatial Occupancy Model",
    "text": "Fitting a Multi-Species Spatial Occupancy Model\nWe use a more computationally efficient approach for fitting spatial multi-species occupancy models. Doser, Finley, and Banerjee (2023) call this alternative approach a “spatial factor multi-species occupancy model”, and we describe this in depth in Doser, Finley, and Banerjee (2023). This newer approach also accounts for residual species correlations (i.e., it is a joint species distribution model with imperfect detection). Our simulation results from Doser, Finley, and Banerjee (2023) show that this alternative approach outperforms, or performs equally, while being substantially faster than using spMsPGOcc().\nTamshiyacu Tahuayo data\nHere we use the tables PER-003_BD_ACRCTT_T0.xlsx\n\nCodesource(\"C:/CodigoR/WCS-CameraTrap/R/organiza_datos_v3.R\")\n\nAP_Pacaya &lt;- read_sf(\"C:/CodigoR/Occu_APs/shp/PacayaSamiria/WDPA_WDOECM_Jun2025_Public_249_shp-polygons.shp\")\n\nAP_Tahuayo &lt;- read_sf(\"C:/CodigoR/Occu_APs/shp/Tahuayo/WDPA_WDOECM_Jun2025_Public_555555621_shp-polygons.shp\")\n\n# load data and make array_locID column\nPer_Tahuayo_piloto &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Peru/PER-002_BD_ACRTT-PILOTO.xlsx\")\n\n50 cameras in Cameras. \n 50 cameras in Deployment. \n 50 deployments in Deployment. \n 50 points in Deployment. \n 50 cameras in Images. \n 50 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2015 \n Jaguar_Design: no \n\nCode Per_Tahuayo &lt;- loadproject(\"F:/WCS-CameraTrap/data/BDcorregidas/Peru/PER-003_BD_ACRCTT_T0.xlsx\")\n\n85 cameras in Cameras. \n 84 cameras in Deployment. \n 84 deployments in Deployment. \n 84 points in Deployment. \n 84 cameras in Images. \n 84 points in Images. \n\n\nJoining with `by = join_by(Camera_Id)`\n\n\n[1] \"dates ok\"\nyear: 2016 \n Jaguar_Design: no \n\nCode# get sites\n# Per_Pacaya_sites &lt;- get.sites(\"F:/WCS-CameraTrap/data/BDcorregidas/Peru/PER-003_BD_ACRCTT_T0.xlsx\")\n\n# get sites\nPer_Tahuayo_sites1 &lt;- Per_Tahuayo |&gt; select(\"Latitude\",\n                                    \"Longitude\",\n                                    \"Camera_Id\" \n                                    ) |&gt; dplyr::distinct( )  \n\nPer_Tahuayo_sites &lt;- sf::st_as_sf(Per_Tahuayo_sites1, coords = c(\"Longitude\",\"Latitude\"))\nst_crs(Per_Tahuayo_sites) &lt;- 4326\n\n\n\n# get Pacaya sites\nPer_Tahuayo_piloto_sites1 &lt;- Per_Tahuayo_piloto |&gt; select(\"Latitude\",\n                                    \"Longitude\",\n                                    \"Camera_Id\" \n                                    ) |&gt; dplyr::distinct( )  \n\nPer_Tahuayo_piloto_sites &lt;- sf::st_as_sf(Per_Tahuayo_piloto_sites1, coords = c(\"Longitude\",\"Latitude\"))\nst_crs(Per_Tahuayo_piloto_sites) &lt;- 4326\n\n\n\n\n# get elevation map\nelevation_17 &lt;- rast(get_elev_raster(Per_Tahuayo_sites, z = 10)) #z =1-14\n\nMosaicing & Projecting\nNote: Elevation units are in meters.\n\nCode# bb &lt;-  st_as_sfc(st_bbox(elevation_17)) # make bounding box \n\n\n\n\n# extract covs using points and add to _sites\ncovs_Per_Tahuayo_sites &lt;- cbind(Per_Tahuayo_sites, terra::extract(elevation_17, Per_Tahuayo_sites))\n\n# extract covs using points and add to _sites\ncovs_Per_Tahuayo_piloto_sites &lt;- cbind(Per_Tahuayo_piloto_sites, terra::extract(elevation_17, Per_Tahuayo_piloto_sites))\n\n# covs_Ecu_17_sites &lt;- cbind(Ecu_17_sites, terra::extract(elevation_17, Ecu_17_sites))\n# covs_Ecu_18_sites &lt;- cbind(Ecu_18_sites, terra::extract(elevation_17, Ecu_18_sites))\n# covs_Ecu_20_sites &lt;- cbind(Ecu_20_sites, terra::extract(elevation_17, Ecu_20_sites))\n# covs_Ecu_21_sites &lt;- cbind(Ecu_21_sites, terra::extract(elevation_17, Ecu_21_sites))\n# covs_Ecu_22_sites &lt;- cbind(Ecu_22_sites, terra::extract(elevation_17, Ecu_22_sites))\n\n# get which are in and out\ncovs_Per_Tahuayo_sites$in_AP = st_intersects(covs_Per_Tahuayo_sites, AP_Tahuayo, sparse = FALSE)\n\ncovs_Per_Tahuayo_piloto_sites$in_AP = st_intersects(covs_Per_Tahuayo_piloto_sites, AP_Tahuayo, sparse = FALSE)\n# covs_Ecu_17_sites$in_AP = st_intersects(covs_Ecu_17_sites, AP_Machalilla, sparse = FALSE)\n# covs_Ecu_18_sites$in_AP = st_intersects(covs_Ecu_18_sites, AP_Machalilla, sparse = FALSE)\n# covs_Ecu_20_sites$in_AP = st_intersects(covs_Ecu_20_sites, AP_Machalilla, sparse = FALSE)\n# covs_Ecu_21_sites$in_AP = st_intersects(covs_Ecu_21_sites, AP_Machalilla, sparse = FALSE)\n# covs_Ecu_22_sites$in_AP = st_intersects(covs_Ecu_22_sites, AP_Machalilla, sparse = FALSE)\n\n# covs_Ecu_16_sites$in_AP = st_intersects(covs_Ecu_16_sites, AP_Llanganates, sparse = FALSE)\n\n\n\n# make a map\nmapview (elevation_17, alpha=0.5) + \n  mapview (AP_Pacaya, color = \"green\", col.regions = \"green\", alpha = 0.5) +\n  mapview (AP_Tahuayo, color = \"green\", col.regions = \"green\", alpha = 0.5) +\n  mapview (covs_Per_Tahuayo_sites, zcol = \"in_AP\", col.regions =c(\"red\",\"blue\"), burst = TRUE) +   \n  mapview (covs_Per_Tahuayo_piloto_sites, \n           zcol = \"in_AP\", \n           col.regions =c(\"blue\"), \n           burst = TRUE) \n\nNumber of pixels is above 5e+05.Only about 5e+05 pixels will be shown.\nYou can increase the value of `maxpixels` to 523775 to avoid this.\n\n\n\n\n\nCode  # mapview (covs_Ecu_17_sites, zcol = \"in_AP\", col.regions =c(\"red\",\"blue\"), burst = TRUE) +\n  # mapview (covs_Ecu_18_sites, zcol = \"in_AP\", col.regions =c(\"red\",\"blue\"), burst = TRUE) +\n  # mapview (covs_Ecu_20_sites, zcol = \"in_AP\", col.regions =c(\"red\",\"blue\"), burst = TRUE) +\n  # mapview (covs_Ecu_21_sites, zcol = \"in_AP\", col.regions =c(\"red\",\"blue\"), burst = TRUE) +\n  # mapview (covs_Ecu_22_sites, zcol = \"in_AP\", burst = TRUE, col.regions = c(\"blue\") ) #+\n  # mapview (covs_Ecu_16_sites, zcol = \"in_AP\", burst = TRUE, col.regions =c(\"red\",\"blue\")) \n\n\nCamera trap operation data and detection history\n\nCode# Join 3 tables\n# fix count in ECU 18, 20,\n# Ecu_18$Count &lt;- as.numeric(Ecu_18$Count)\nPer_Tahuayo_piloto$Longitude &lt;- as.numeric(Per_Tahuayo_piloto$Longitude)\nPer_Tahuayo_piloto$Latitude &lt;- as.numeric(Per_Tahuayo_piloto$Latitude)\n\n\nPer_full &lt;- Per_Tahuayo|&gt; \n  full_join(Per_Tahuayo_piloto) #|&gt; \n\nJoining with `by = join_by(`Project Id`, Camera_Id, Make, Model, `Serial\nNumber`, Year_Purchased, Deployment_ID, Point.x, Longitude, Latitude,\nstart_date, end_date, `Bait Type`, `Bait Description`, `Feature Type`, `Feature\nType methodology`, `Camera Type`, `Quiet Period Setting`, `Restriction on\nAccess`, `Camera Failure Details`, season, rio_playa, arroyo, camino,\nsenda_animal, senda_gente, salitral, pozo_agua, bosque, sabana, intermedio,\nintervalo_trigger, locationID, `Image Id`, `Photo Type`, `Photo Type Identified\nby`, Point.y, scientificName, Date_Time_Captured, `Independent event`, Age,\nSex, `Individual ID`, Count, Jaguar_Design, year)`\n\nCode                      # full_join(Ecu_18) |&gt; \n                      # full_join(Ecu_20) |&gt; \n                      # full_join(Ecu_21) |&gt; \n                      # full_join(Ecu_22)\n\n# fix date format\n# \n# Formatting a Date object\nPer_full$start_date &lt;- as.Date(Per_full$\"start_date\", \"%Y/%m/%d\")\nPer_full$start_date &lt;- format(Per_full$start_date, \"%Y-%m-%d\")\n\nPer_full$end_date &lt;- as.Date(Per_full$\"end_date\", \"%Y/%m/%d\")\nPer_full$end_date &lt;- format(Per_full$end_date, \"%Y-%m-%d\")\n\nPer_full$eventDate &lt;- as.Date(Per_full$\"Date_Time_Captured\", \"%Y/%m/%d\")\n\nWarning in as.POSIXlt.POSIXct(x, tz = tz): unknown timezone '%Y/%m/%d'\n\nCodePer_full$eventDate &lt;- format(Per_full$eventDate, \"%Y-%m-%d\")\n\n# Per_full$eventDateTime &lt;- ymd_hms(paste(Per_full$\"photo_date\", Per_full$\"photo_time\", sep=\" \"))\nPer_full$eventDateTime &lt;- ymd_hms(Per_full$\"Date_Time_Captured\")\n\n# rename camera id\nPer_full$camid &lt;- Per_full$`Camera_Id`\n\n\n# filter 2021 and make uniques\nCToperation  &lt;- Per_full |&gt; dplyr::group_by(camid) |&gt; #(array_locID) |&gt; \n                           mutate(minStart=start_date, maxEnd=end_date) |&gt; distinct(Longitude, Latitude, minStart, maxEnd) |&gt; dplyr::ungroup()\n# remove one duplicated\n# View(CToperation)\n# CToperation &lt;- CToperation[-15,]\n\n\n# Generamos la matríz de operación de las cámaras\n\ncamop &lt;- cameraOperation(CTtable= CToperation, # Tabla de operación\n                         stationCol= \"camid\", # Columna que define la estación\n                         setupCol= \"minStart\", #Columna fecha de colocación\n                         retrievalCol= \"maxEnd\", #Columna fecha de retiro\n                         #hasProblems= T, # Hubo fallos de cámaras\n                         dateFormat= \"%Y-%m-%d\")#, #, # Formato de las fechas\n                         #cameraCol=\"Camera_Id\")\n                         # sessionCol= \"Year\")\n\n# Generar las historias de detección ---------------------------------------\n## remove plroblem species\n\n# Per_full$scientificName &lt;- paste(Per_full$genus, Per_full$species, sep=\" \")\n\n#### remove stups\n# ind &lt;- which(Per_full$scientificName==\"NA NA\")\n# Per_full &lt;- Per_full[-ind,]\n\n# ind &lt;- which(Per_full$scientificName==\"Set up\")\n# Per_full &lt;- Per_full[-ind,]\n# \n# ind &lt;- which(Per_full$scientificName==\"Blank\")\n# Per_full &lt;- Per_full[-ind,]\n# \n# ind &lt;- which(Per_full$scientificName==\"Unidentifiable\")\n# Per_full &lt;- Per_full[-ind,]\n\n\n\n\nDetHist_list &lt;- lapply(unique(Per_full$scientificName), FUN = function(x) {\n  detectionHistory(\n    recordTable         = Per_full, # abla de registros\n    camOp                = camop, # Matriz de operación de cámaras\n    stationCol           = \"camid\",\n    speciesCol           = \"scientificName\",\n    recordDateTimeCol    = \"eventDateTime\",\n    recordDateTimeFormat  = \"%Y-%m-%d %H:%M:%S\",\n    species              = x,     # la función reemplaza x por cada una de las especies\n    occasionLength       = 7, # Colapso de las historias a 10 ías\n    day1                 = \"station\", # \"survey\" a specific date, \"station\", #inicie en la fecha de cada survey\n    datesAsOccasionNames = FALSE,\n    includeEffort        = TRUE,\n    scaleEffort          = FALSE,\n    #unmarkedMultFrameInput=TRUE\n    timeZone             = \"America/Bogota\" \n    )\n  }\n)\n\nWarning: \nAt 1 stations there were records before camera operation date range:  PER-003-C0071\n\n\nWarning: \nAt 1 stations there were records after camera operation date range:  PER-002-C0036\n\n\nWarning: 5 records (out of 1357) were removed because they were taken before day1 (if a date was specified),  within the buffer period, or before occasionStartTime on the 1st day, e.g.:\nPER-003-C0071: 2016-08-28 16:28:21\nPER-003-C0071: 2016-08-28 16:28:22\nPER-003-C0071: 2016-08-28 16:28:23\nPER-003-C0071: 2016-08-28 16:28:24\nPER-003-C0071: 2016-08-28 16:28:25\n\n\nWarning: \n\n1 records (out of 1357) were removed because they were taken after the end of the last occasion, e.g.:\nPER-002-C0036: 2015-05-25 13:38:49\n\n\nWarning: \nAt 1 stations there were records after camera operation date range:  PER-003-C0070\n\n\nWarning: \n\n5 records (out of 2861) were removed because they were taken after the end of the last occasion, e.g.:\nPER-003-C0070: 2016-11-03 11:56:53\nPER-003-C0070: 2016-11-03 11:56:54\nPER-003-C0070: 2016-11-03 11:56:55\nPER-003-C0070: 2016-11-03 11:56:56\nPER-003-C0070: 2016-11-03 11:56:57\n\nCode# names\nnames(DetHist_list) &lt;- unique(Per_full$scientificName)\n\n# Finalmente creamos una lista nueva donde estén solo las historias de detección\nylist &lt;- lapply(DetHist_list, FUN = function(x) x$detection_history)\n# otra lista con effort scaled\nefort &lt;- lapply(DetHist_list, FUN = function(x) x$effort)\n\n# number of observetions per sp, collapsed to 7 days\n# lapply(ylist, sum, na.rm = TRUE)\n\n\nArrange spatial covariates\n\nCode# make sf()\nPer_full_sf &lt;- CToperation |&gt; \n    st_as_sf(coords = c(\"Longitude\", \"Latitude\"), \n              crs = 4326)\n\n# extract elev\nPer_full_sf$elev &lt;- terra::extract(elevation_17, Per_full_sf)[,2]\nstr(Per_full_sf$elev)\n\n num [1:134] 127 105 106 109 109 102 106 97 106 107 ...\n\nCode# extract in AP\nPer_full_sf$in_AP = as.factor(st_intersects(Per_full_sf, AP_Tahuayo, sparse = FALSE))\n\nin_AP &lt;- as.numeric((st_drop_geometry(Per_full_sf$in_AP)))\n\n# mapview(full_sites_14_15_16_sf, zcol = \"in_AP\", burst = TRUE)\n\n# Transform coord to UTM Z17 Ecuador EPSG:32717 WGS 84 / UTM zone 17S\nPer_full_sf_UTM &lt;- st_transform(Per_full_sf, \"EPSG:32717\")\n\ncoords &lt;- st_coordinates(Per_full_sf_UTM)\n#str(coords)\n\n# make Ecu_14_15_16 an sf object\n#    cam_sf &lt;- st_as_sf(Ecu_14_15_16, coords = c(\"lon\",\"lat\"))   #crs=\"EPSG:4326\")\n    #--- set CRS ---#\n#    st_crs(cam_sf) &lt;- 4326\n\n#transform coord data to UTM\nAP_Tahuayo_UTM &lt;- st_transform(AP_Tahuayo, \"EPSG:32717\")\n# Convert to LINESTRING\nAP_Tahuayo_UTM_line &lt;- st_cast(AP_Tahuayo_UTM,\"MULTILINESTRING\")# \"LINESTRING\")\n\n# Calculate the distance\n#multiplic &lt;- full_sites_14_15_16_sf_UTM |&gt; mutate(multiplic= as.numeric(in_AP)) \nmultiplic=ifelse(Per_full_sf_UTM$in_AP==\"TRUE\",-1,1)\nPer_full_sf_UTM$border_dist &lt;- as.numeric(st_distance(Per_full_sf_UTM, AP_Tahuayo_UTM_line) * multiplic )\n# print(border_dist)\n\n# convert true false to inside outside\nPer_full_sf_UTM &lt;- Per_full_sf_UTM |&gt; \n  mutate(in_AP = case_when(\n    str_detect(in_AP, \"TRUE\") ~ \"inside_AP\",\n    str_detect(in_AP, \"FALSE\") ~ \"outside_AP\"\n  )) |&gt; mutate(in_AP=as.factor(in_AP))\n\n\nhist(Per_full_sf_UTM$border_dist)\n\n\n\n\n\n\n\nPrepare the model\n\n\n\n\n\n\nTipData in a 3D array\n\n\n\nThe data must be placed in a three-dimensional array with dimensions corresponding to species, sites, and replicates in that order.\n\n\nThe function sfMsPGOcc\nFits multi-species spatial occupancy models with species correlations (i.e., a spatially-explicit joint species distribution model with imperfect detection). We use Polya-Gamma latent variables and a spatial factor modeling approach. Currently, models are implemented using a Nearest Neighbor Gaussian Process.\n\nCode# Detection-nondetection data ---------\n# Species of interest, can select individually\n# curr.sp &lt;- sort(unique(Ecu_14_15_16$.id))# c('BAWW', 'BLJA', 'GCFL')\n# sort(names(DetHist_list))\nselected.sp &lt;-  c(\n\"Atelocynus microtis\" ,\n\"Coendou prehensilis\" ,\n\"Cuniculus paca\",           \n# \"Dasyprocta fuliginosa.\",      \n\"Dasypus sp.\" ,    \n\"Didelphis marsupialis\",    \n\"Eira barbara\",             \n\"Leopardus pardalis\",       \n\"Leopardus wiedii\",         \n\"Mazama americana\",\n\"Mazama nemorivaga\",\n#\"Mitu tuberosum\" ,\n\"Myoprocta pratti\",\n\"Myrmecophaga tridactyla\",\n\"Nasua nasua\" ,\n# \"Mazama americana\",         \n# \"Myotis myotis\",           \n# \"Nasua narica\",             \n# \"Odocoileus virginianus\",   \n\"Panthera onca\" ,\n# \"Procyon cancrivorus\" ,\n\"Pecari tajacu\",    \n#\"Penelope jacquacu\" ,\n\"Priodontes maximus\" ,\n\"Procyon cancrivorous\",      \n# \"Psophia leucoptera\",\n\"Puma concolor\" ,\n\"Puma yagouaroundi\",        \n# \"Rattus rattus\" ,\n# \"Roedor sp.\",\n# \"Sciurus sp.\",       \n# \"Sus scrofa\",               \n# \"Sylvilagus brasiliensis\",  \n\"Tamandua tetradactyla\",   \n\"Tapirus terrestris\",\n\"Tayassu pecari\"\n#\"Tinamus major\"            \n              )\n\n# y.msom &lt;- y[which(sp.codes %in% selected.sp), , ]\n# str(y.msom)\n\n# Use selection\ny.selected &lt;- ylist[selected.sp]   \n\n#### three-dimensional array with dimensions corresponding to species, sites, and replicates\n\n# 1. Load the abind library to make arrays easily \nlibrary(abind)\nmy_array_abind &lt;- abind(y.selected, # start from list\n                        along = 3, # 3D array\n                        use.first.dimnames=TRUE) # keep names\n\n# Transpose the array to have:\n# species, sites, and sampling occasions in that order\n# The new order is (3rd dim, 1st dim, 2nd dim)\ntransposed_array &lt;- aperm(my_array_abind, c(3, 1, 2))\n\n#### site covs\nsitecovs &lt;- as.data.frame(st_drop_geometry(\n                    Per_full_sf_UTM[,5:7]))\n sitecovs[, 1] &lt;- as.vector((sitecovs[,1]))   # scale numeric covariates\n sitecovs[, 3] &lt;- as.vector((sitecovs[,3]))   # scale numeric covariates\n # sitecovs$fact &lt;- factor(c(\"A\", \"A\", \"B\"))    # categorical covariate\n\nnames(sitecovs) &lt;- c(\"elev\", \"in_AP\", \"border_dist\")\n\n# check consistancy equal number of spatial covariates and rows in data\n# identical(nrow(ylist[[1]]), nrow(covars)) \n\n# Base de datos para los análisis -----------------------------------------\n\n# match the names to \"y\"  \"occ.covs\" \"det.covs\" \"coords\" \ndata_list &lt;- list(y = transposed_array, # Historias de detección\n                  occ.covs = sitecovs, #covs de sitio\n                  det.covs  = list(effort = DetHist_list[[1]]$effort),\n                  coords = st_coordinates(Per_full_sf_UTM)\n                  )  # agregamos el esfuerzo de muestreo como covariable de observación\n\n\nRunning the model\nWe let spOccupancy set the initial values by default based on the prior distributions.\n\nCode# Running the model\n\n# 3. 1 Modelo multi-especie  -----------------------------------------\n\n# 2. Model fitting --------------------------------------------------------\n# Fit a non-spatial, single-species occupancy model. \nout &lt;- msPGOcc(occ.formula = ~ scale(elev) + scale(border_dist) , \n               det.formula = ~ scale(effort) , # Ordinal.day + I(Ordinal.day^2) + Year\n                 data = data_list, \n                 n.samples = 6000, \n                 n.thin = 10, \n                 n.burn = 1000, \n                 n.chains = 3,\n                 n.report = 1000);beep(sound = 4)\n\n----------------------------------------\n    Preparing to run the model\n----------------------------------------\n\n\nNo prior specified for beta.comm.normal.\nSetting prior mean to 0 and prior variance to 2.72\n\n\nNo prior specified for alpha.comm.normal.\nSetting prior mean to 0 and prior variance to 2.72\n\n\nNo prior specified for tau.sq.beta.ig.\nSetting prior shape to 0.1 and prior scale to 0.1\n\n\nNo prior specified for tau.sq.alpha.ig.\nSetting prior shape to 0.1 and prior scale to 0.1\n\n\nz is not specified in initial values.\nSetting initial values based on observed data\n\n\nbeta.comm is not specified in initial values.\nSetting initial values to random values from the prior distribution\n\n\nalpha.comm is not specified in initial values.\nSetting initial values to random values from the prior distribution\n\n\ntau.sq.beta is not specified in initial values.\nSetting initial values to random values between 0.5 and 10\n\n\ntau.sq.alpha is not specified in initial values.\nSetting to initial values to random values between 0.5 and 10\n\n\nbeta is not specified in initial values.\nSetting initial values to random values from the community-level normal distribution\n\n\nalpha is not specified in initial values.\nSetting initial values to random values from the community-level normal distribution\n\n\n----------------------------------------\n    Model description\n----------------------------------------\nMulti-species Occupancy Model with Polya-Gamma latent\nvariable fit with 134 sites and 22 species.\n\nSamples per Chain: 6000 \nBurn-in: 1000 \nThinning Rate: 10 \nNumber of Chains: 3 \nTotal Posterior Samples: 1500 \n\nSource compiled with OpenMP support and model fit using 1 thread(s).\n\n----------------------------------------\n    Chain 1\n----------------------------------------\nSampling ... \nSampled: 1000 of 6000, 16.67%\n-------------------------------------------------\nSampled: 2000 of 6000, 33.33%\n-------------------------------------------------\nSampled: 3000 of 6000, 50.00%\n-------------------------------------------------\nSampled: 4000 of 6000, 66.67%\n-------------------------------------------------\nSampled: 5000 of 6000, 83.33%\n-------------------------------------------------\nSampled: 6000 of 6000, 100.00%\n----------------------------------------\n    Chain 2\n----------------------------------------\nSampling ... \nSampled: 1000 of 6000, 16.67%\n-------------------------------------------------\nSampled: 2000 of 6000, 33.33%\n-------------------------------------------------\nSampled: 3000 of 6000, 50.00%\n-------------------------------------------------\nSampled: 4000 of 6000, 66.67%\n-------------------------------------------------\nSampled: 5000 of 6000, 83.33%\n-------------------------------------------------\nSampled: 6000 of 6000, 100.00%\n----------------------------------------\n    Chain 3\n----------------------------------------\nSampling ... \nSampled: 1000 of 6000, 16.67%\n-------------------------------------------------\nSampled: 2000 of 6000, 33.33%\n-------------------------------------------------\nSampled: 3000 of 6000, 50.00%\n-------------------------------------------------\nSampled: 4000 of 6000, 66.67%\n-------------------------------------------------\nSampled: 5000 of 6000, 83.33%\n-------------------------------------------------\nSampled: 6000 of 6000, 100.00%\n\nCodesummary(out, level = 'community')\n\n\nCall:\nmsPGOcc(occ.formula = ~scale(elev) + scale(border_dist), det.formula = ~scale(effort), \n    data = data_list, n.samples = 6000, n.report = 1000, n.burn = 1000, \n    n.thin = 10, n.chains = 3)\n\nSamples per Chain: 6000\nBurn-in: 1000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 1500\nRun Time (min): 3.3125\n\n----------------------------------------\n    Community Level\n----------------------------------------\nOccurrence Means (logit scale): \n                      Mean     SD    2.5%     50%  97.5%   Rhat ESS\n(Intercept)        -0.3409 0.3572 -1.1094 -0.3081 0.2543 1.2045  98\nscale(elev)         0.3594 0.2922 -0.2492  0.3834 0.8905 1.0061 720\nscale(border_dist)  0.1767 0.2425 -0.3100  0.1752 0.6986 1.0193 631\n\nOccurrence Variances (logit scale): \n                     Mean     SD   2.5%    50%  97.5%   Rhat ESS\n(Intercept)        0.9189 0.6734 0.2040 0.7361 2.7286 1.0919  67\nscale(elev)        1.2783 0.9203 0.3451 1.0234 3.7402 1.0698 175\nscale(border_dist) 0.6944 0.4859 0.1948 0.5745 1.9290 1.1088 236\n\nDetection Means (logit scale): \n                 Mean     SD    2.5%     50%   97.5%   Rhat ESS\n(Intercept)   -3.2242 0.3699 -3.9418 -3.2289 -2.4914 1.0884 189\nscale(effort)  0.3587 0.0949  0.1822  0.3568  0.5550 1.0150 735\n\nDetection Variances (logit scale): \n                Mean     SD   2.5%    50%  97.5%   Rhat ESS\n(Intercept)   2.6176 1.0606 1.1583 2.4100 5.1580 1.0877 290\nscale(effort) 0.0602 0.0374 0.0189 0.0498 0.1655 1.0029 961\n\nCode# Fit a spatial, single-species occupancy model using \n# latent factors.\ntictoc::tic()\n  out.sp &lt;- sfMsPGOcc(occ.formula = ~ scale(elev) + scale(border_dist) , \n                      det.formula = ~ scale(effort), # Ordinal.day + I(Ordinal.day^2) + Year,             \n                      data = data_list, \n                      n.batch = 600, \n                      batch.length = 25, # iter=600*25\n                      n.thin = 10, \n                      n.burn = 5000, \n                      n.chains = 3,\n                      NNGP = TRUE,\n                      n.factors = 3,\n                      n.neighbors = 15,\n                      cov.model = 'exponential',\n                      n.report = 100);beep(sound = 4)\n\n----------------------------------------\n    Preparing to run the model\n----------------------------------------\n\n\nNo prior specified for beta.comm.normal.\nSetting prior mean to 0 and prior variance to 2.72\n\n\nNo prior specified for alpha.comm.normal.\nSetting prior mean to 0 and prior variance to 2.72\n\n\nNo prior specified for tau.sq.beta.\nUsing an inverse-Gamma prior with prior shape 0.1 and prior scale 0.1\n\n\nNo prior specified for tau.sq.alpha.\nUsing an inverse-Gamma prior with prior shape 0.1 and prior scale 0.1\n\n\nNo prior specified for phi.unif.\nSetting uniform bounds based on the range of observed spatial coordinates.\n\n\nz is not specified in initial values.\nSetting initial values based on observed data\n\n\nbeta.comm is not specified in initial values.\nSetting initial values to random values from the prior distribution\n\n\nalpha.comm is not specified in initial values.\nSetting initial values to random values from the prior distribution\n\n\ntau.sq.beta is not specified in initial values.\nSetting initial values to random values between 0.5 and 10\n\n\ntau.sq.alpha is not specified in initial values.\nSetting initial values to random values between 0.5 and 10\n\n\nbeta is not specified in initial values.\nSetting initial values to random values from the community-level normal distribution\n\n\nalpha is not specified in initial values.\nSetting initial values to random values from the community-level normal distribution\n\n\nphi is not specified in initial values.\nSetting initial value to random values from the prior distribution\n\n\nlambda is not specified in initial values.\nSetting initial values of the lower triangle to 0\n\n\n----------------------------------------\n    Building the neighbor list\n----------------------------------------\n----------------------------------------\nBuilding the neighbors of neighbors list\n----------------------------------------\n----------------------------------------\n    Model description\n----------------------------------------\nSpatial Factor NNGP Multi-species Occupancy Model with Polya-Gamma latent\nvariable fit with 134 sites and 22 species.\n\nSamples per chain: 15000 (600 batches of length 25)\nBurn-in: 5000 \nThinning Rate: 10 \nNumber of Chains: 3 \nTotal Posterior Samples: 3000 \n\nUsing the exponential spatial correlation model.\n\nUsing 3 latent spatial factors.\nUsing 15 nearest neighbors.\n\nSource compiled with OpenMP support and model fit using 1 thread(s).\n\nAdaptive Metropolis with target acceptance rate: 43.0\n----------------------------------------\n    Chain 1\n----------------------------------------\nSampling ... \nBatch: 100 of 600, 16.67%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     12.0        2.53451\n    2       phi     68.0        1.36343\n    3       phi     64.0        2.48432\n-------------------------------------------------\nBatch: 200 of 600, 33.33%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     64.0        3.15819\n    2       phi     52.0        2.69123\n    3       phi     56.0        3.09566\n-------------------------------------------------\nBatch: 300 of 600, 50.00%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     40.0        3.28708\n    2       phi     4.0     3.22199\n    3       phi     40.0        3.56085\n-------------------------------------------------\nBatch: 400 of 600, 66.67%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     72.0        3.15819\n    2       phi     4.0     2.80107\n    3       phi     48.0        3.56085\n-------------------------------------------------\nBatch: 500 of 600, 83.33%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     56.0        3.22199\n    2       phi     68.0        2.97427\n    3       phi     60.0        3.63279\n-------------------------------------------------\nBatch: 600 of 600, 100.00%\n----------------------------------------\n    Chain 2\n----------------------------------------\nSampling ... \nBatch: 100 of 600, 16.67%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     48.0        3.28708\n    2       phi     60.0        2.48432\n    3       phi     8.0     3.49034\n-------------------------------------------------\nBatch: 200 of 600, 33.33%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     48.0        3.28708\n    2       phi     28.0        3.15819\n    3       phi     52.0        3.42123\n-------------------------------------------------\nBatch: 300 of 600, 50.00%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     8.0     2.15977\n    2       phi     80.0        3.28708\n    3       phi     44.0        3.70617\n-------------------------------------------------\nBatch: 400 of 600, 66.67%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     44.0        2.74560\n    2       phi     52.0        3.35348\n    3       phi     40.0        3.35348\n-------------------------------------------------\nBatch: 500 of 600, 83.33%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     24.0        3.49034\n    2       phi     24.0        3.22199\n    3       phi     32.0        3.03436\n-------------------------------------------------\nBatch: 600 of 600, 100.00%\n----------------------------------------\n    Chain 3\n----------------------------------------\nSampling ... \nBatch: 100 of 600, 16.67%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     48.0        3.56085\n    2       phi     8.0     3.35348\n    3       phi     24.0        3.03436\n-------------------------------------------------\nBatch: 200 of 600, 33.33%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     16.0        3.03436\n    2       phi     48.0        3.09566\n    3       phi     52.0        2.53451\n-------------------------------------------------\nBatch: 300 of 600, 50.00%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     44.0        2.74560\n    2       phi     44.0        3.42123\n    3       phi     52.0        3.78104\n-------------------------------------------------\nBatch: 400 of 600, 66.67%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     48.0        2.38691\n    2       phi     8.0     3.22199\n    3       phi     36.0        3.42123\n-------------------------------------------------\nBatch: 500 of 600, 83.33%\n    Latent Factor   Parameter   Acceptance  Tuning\n    1       phi     8.0     2.07508\n    2       phi     28.0        2.97427\n    3       phi     40.0        3.42123\n-------------------------------------------------\nBatch: 600 of 600, 100.00%\n\nCodetictoc::toc()\n\n940.38 sec elapsed\n\nCode#########################\n# tictoc::tic()\n#   out.sp.gaus &lt;- sfMsPGOcc(occ.formula = ~ scale(border_dist) , \n#                            det.formula = ~ scale(effort), # Ordinal.day + I(Ordinal.day^2) + Year,              \n#                            data = data_list, \n#                            n.batch = 400, \n#                            batch.length = 25,\n#                            n.thin = 5, \n#                            n.burn = 5000, \n#                            n.chains = 1,\n#                            NNGP = TRUE,\n#                            n.factors = 5,\n#                            n.neighbors = 15,\n#                            cov.model = 'gaussian',\n#                            n.report = 100);beep(sound = 4)\n# tictoc::toc()\n\n# save the results to not run again\nsave(out, file=\"C:/CodigoR/Occu_APs_all/blog/2025-10-15-analysis/result/result_2.R\") # guardamos los resultados para no correr de nuevo\n# save the results to not run again\nsave(out.sp, file=\"C:/CodigoR/Occu_APs_all/blog/2025-10-15-analysis/result/sp_result_2.R\") # guardamos los resultados para no correr de nuevo\n\n\n# load(\"C:/CodigoR/Occu_APs_all/blog/2025-10-15-analysis/result/sp_result_2.R\")\n# summary(fit.commu)\n\n\nModel validation\nWe next perform a posterior predictive check using the Freeman-Tukey statistic grouping the data by sites. We summarize the posterior predictive check with the summary() function, which reports a Bayesian p-value. A Bayesian p-value that hovers around 0.5 indicates adequate model fit, while values less than 0.1 or greater than 0.9 suggest our model does not fit the data well (Hobbs and Hooten 2015). As always with a simulation-based analysis using MCMC, you will get numerically slightly different values.\n\nCode# 3. Model validation -----------------------------------------------------\n# Perform a posterior predictive check to assess model fit. \nppc.out &lt;- ppcOcc(out, fit.stat = 'freeman-tukey', \n                  group = 1)\nppc.out.sp &lt;- ppcOcc(out.sp, fit.stat = 'freeman-tukey',\n                     group = 1)\n\n# Calculate a Bayesian p-value as a simple measure of Goodness of Fit.\n# Bayesian p-values between 0.1 and 0.9 indicate adequate model fit. \nsummary(ppc.out)\n\n\nCall:\nppcOcc(object = out, fit.stat = \"freeman-tukey\", group = 1)\n\nSamples per Chain: 6000\nBurn-in: 1000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 1500\n\n----------------------------------------\n    Community Level\n----------------------------------------\nBayesian p-value:  0.3617 \n\n----------------------------------------\n    Species Level\n----------------------------------------\nAtelocynus microtis Bayesian p-value: 0.524\nCoendou prehensilis Bayesian p-value: 0.7287\nCuniculus paca Bayesian p-value: 0.0227\nDasypus sp. Bayesian p-value: 0.1667\nDidelphis marsupialis Bayesian p-value: 0.156\nEira barbara Bayesian p-value: 0.552\nLeopardus pardalis Bayesian p-value: 0.2067\nLeopardus wiedii Bayesian p-value: 0.5287\nMazama americana Bayesian p-value: 0.0333\nMazama nemorivaga Bayesian p-value: 0.41\nMyoprocta pratti Bayesian p-value: 0.604\nMyrmecophaga tridactyla Bayesian p-value: 0.198\nNasua nasua Bayesian p-value: 0.462\nPanthera onca Bayesian p-value: 0.2527\nPecari tajacu Bayesian p-value: 0.342\nPriodontes maximus Bayesian p-value: 0.5367\nProcyon cancrivorous Bayesian p-value: 0.372\nPuma concolor Bayesian p-value: 0.5433\nPuma yagouaroundi Bayesian p-value: 0.512\nTamandua tetradactyla Bayesian p-value: 0.4993\nTapirus terrestris Bayesian p-value: 0.0613\nTayassu pecari Bayesian p-value: 0.2453\nFit statistic:  freeman-tukey \n\nCodesummary(ppc.out.sp)\n\n\nCall:\nppcOcc(object = out.sp, fit.stat = \"freeman-tukey\", group = 1)\n\nSamples per Chain: 15000\nBurn-in: 5000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 3000\n\n----------------------------------------\n    Community Level\n----------------------------------------\nBayesian p-value:  0.3666 \n\n----------------------------------------\n    Species Level\n----------------------------------------\nAtelocynus microtis Bayesian p-value: 0.5303\nCoendou prehensilis Bayesian p-value: 0.728\nCuniculus paca Bayesian p-value: 0.0147\nDasypus sp. Bayesian p-value: 0.184\nDidelphis marsupialis Bayesian p-value: 0.1423\nEira barbara Bayesian p-value: 0.574\nLeopardus pardalis Bayesian p-value: 0.155\nLeopardus wiedii Bayesian p-value: 0.508\nMazama americana Bayesian p-value: 0.0387\nMazama nemorivaga Bayesian p-value: 0.5083\nMyoprocta pratti Bayesian p-value: 0.5873\nMyrmecophaga tridactyla Bayesian p-value: 0.163\nNasua nasua Bayesian p-value: 0.4637\nPanthera onca Bayesian p-value: 0.2253\nPecari tajacu Bayesian p-value: 0.3447\nPriodontes maximus Bayesian p-value: 0.545\nProcyon cancrivorous Bayesian p-value: 0.3787\nPuma concolor Bayesian p-value: 0.543\nPuma yagouaroundi Bayesian p-value: 0.546\nTamandua tetradactyla Bayesian p-value: 0.5063\nTapirus terrestris Bayesian p-value: 0.061\nTayassu pecari Bayesian p-value: 0.3183\nFit statistic:  freeman-tukey \n\n\n\n\n\n\n\n\nImportant\n\n\n\nA Bayesian p-value that around 0.5 indicates adequate model fit, while values less than 0.1 or greater than 0.9 suggest our model does not fit the data well.\n\n\nFit plot\n\nCode#### fit plot\nppc.df &lt;- data.frame(fit = ppc.out.sp$fit.y, \n                     fit.rep = ppc.out.sp$fit.y.rep, \n                     color = 'lightskyblue1')\n\nppc.df$color[ppc.df$fit.rep.1 &gt; ppc.df$fit.1] &lt;- 'lightsalmon'\nplot(ppc.df$fit.1, ppc.df$fit.rep.1, bg = ppc.df$color, pch = 21, \n     ylab = 'Fit', xlab = 'True')\nlines(ppc.df$fit.1, ppc.df$fit.1, col = 'black')\n\n\n\nThe most symmetrical, better fit!\n\n\n\nModel comparison\n\nCode# 4. Model comparison -----------------------------------------------------\n# Compute Widely Applicable Information Criterion (WAIC)\n# Lower values indicate better model fit. \nwaicOcc(out)\n\n     elpd        pD      WAIC \n-3270.517    70.033  6681.100 \n\nCodewaicOcc(out.sp)\n\n      elpd         pD       WAIC \n-3100.9170   216.1654  6634.1649 \n\n\nModel comparison as table\n\nCode# Here we summarize the spatial factor loadings\n# summary(out.sp$lambda.samples)\n\n# Resultados --------------------------------------------------------------\n# Extraemos lo tabla de valores estimados\nmodresult &lt;- cbind(as.data.frame(waicOcc(out)),\n                  as.data.frame(waicOcc(out.sp))#,\n                  #as.data.frame(waicOcc(out.sp.gaus))\n                  )\n# View(modresult)\nDT::datatable(t(modresult))\n\n\n\n\n\n\n\n\n\n\n\nImportant\n\n\n\nLower values indicate better model fit.\n\n\nPosterior Summary\n\nCode# 5. Posterior summaries --------------------------------------------------\n# Concise summary of main parameter estimates\nsummary(out.sp, level = 'community')\n\n\nCall:\nsfMsPGOcc(occ.formula = ~scale(elev) + scale(border_dist), det.formula = ~scale(effort), \n    data = data_list, cov.model = \"exponential\", NNGP = TRUE, \n    n.neighbors = 15, n.factors = 3, n.batch = 600, batch.length = 25, \n    n.report = 100, n.burn = 5000, n.thin = 10, n.chains = 3)\n\nSamples per Chain: 15000\nBurn-in: 5000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 3000\nRun Time (min): 15.6725\n\n----------------------------------------\n    Community Level\n----------------------------------------\nOccurrence Means (logit scale): \n                      Mean     SD    2.5%     50%  97.5%   Rhat ESS\n(Intercept)        -0.4813 0.4389 -1.3441 -0.4732 0.3708 1.1009 133\nscale(elev)         0.4093 0.3952 -0.3744  0.4200 1.1530 1.0029 744\nscale(border_dist)  0.2395 0.3068 -0.3666  0.2442 0.8393 1.0066 987\n\nOccurrence Variances (logit scale): \n                     Mean     SD   2.5%    50%  97.5%   Rhat ESS\n(Intercept)        1.5511 1.0122 0.3765 1.2966 4.1803 1.0068 212\nscale(elev)        2.3246 1.6232 0.6121 1.8939 6.5985 1.0781 223\nscale(border_dist) 1.1855 0.8933 0.2648 0.9626 3.4158 1.0541 303\n\nDetection Means (logit scale): \n                 Mean     SD    2.5%     50%   97.5%   Rhat  ESS\n(Intercept)   -3.2231 0.3668 -3.9325 -3.2249 -2.5244 1.0357  512\nscale(effort)  0.3597 0.0963  0.1835  0.3523  0.5747 1.0060 1442\n\nDetection Variances (logit scale): \n                Mean     SD   2.5%    50%  97.5%   Rhat  ESS\n(Intercept)   2.5718 0.9953 1.2223 2.3768 5.1403 1.0088 1027\nscale(effort) 0.0596 0.0401 0.0189 0.0493 0.1636 1.0100 1551\n\n----------------------------------------\n    Spatial Covariance\n----------------------------------------\n        Mean     SD  2.5%    50%  97.5%   Rhat ESS\nphi-1 0.0126 0.0108 2e-04 0.0106 0.0326 1.0966 125\nphi-2 0.0143 0.0106 2e-04 0.0131 0.0329 1.1054 314\nphi-3 0.0160 0.0100 9e-04 0.0156 0.0328 1.0135 562\n\nCodesummary(out.sp, level = 'species')\n\n\nCall:\nsfMsPGOcc(occ.formula = ~scale(elev) + scale(border_dist), det.formula = ~scale(effort), \n    data = data_list, cov.model = \"exponential\", NNGP = TRUE, \n    n.neighbors = 15, n.factors = 3, n.batch = 600, batch.length = 25, \n    n.report = 100, n.burn = 5000, n.thin = 10, n.chains = 3)\n\nSamples per Chain: 15000\nBurn-in: 5000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 3000\nRun Time (min): 15.6725\n\n----------------------------------------\n    Species Level\n----------------------------------------\nOccurrence (logit scale): \n                                              Mean     SD    2.5%     50%\n(Intercept)-Atelocynus microtis            -1.0452 1.3035 -3.5509 -0.9992\n(Intercept)-Coendou prehensilis            -1.1445 1.3975 -4.3246 -0.9900\n(Intercept)-Cuniculus paca                  1.0362 0.3804  0.3433  1.0153\n(Intercept)-Dasypus sp.                     0.0705 0.3458 -0.5906  0.0683\n(Intercept)-Didelphis marsupialis          -1.8565 1.2528 -4.0889 -1.9384\n(Intercept)-Eira barbara                   -0.4502 0.7587 -1.8812 -0.4863\n(Intercept)-Leopardus pardalis             -0.1839 0.9293 -1.7047 -0.3021\n(Intercept)-Leopardus wiedii               -0.8918 1.2232 -3.3160 -0.8641\n(Intercept)-Mazama americana               -1.2148 0.4507 -2.1808 -1.1787\n(Intercept)-Mazama nemorivaga              -0.9447 0.5274 -2.0324 -0.9360\n(Intercept)-Myoprocta pratti               -0.8308 1.2129 -3.2057 -0.8206\n(Intercept)-Myrmecophaga tridactyla        -1.0630 0.9677 -2.8595 -1.1013\n(Intercept)-Nasua nasua                     0.0876 0.9003 -1.5458  0.0446\n(Intercept)-Panthera onca                  -0.6588 0.9373 -2.3551 -0.7068\n(Intercept)-Pecari tajacu                   1.1646 0.4373  0.3901  1.1253\n(Intercept)-Priodontes maximus             -0.3785 1.1376 -2.5436 -0.3840\n(Intercept)-Procyon cancrivorous           -0.8588 1.1699 -3.0954 -0.8554\n(Intercept)-Puma concolor                   0.1599 1.1615 -2.0084  0.1373\n(Intercept)-Puma yagouaroundi              -0.7599 1.2853 -3.3113 -0.7114\n(Intercept)-Tamandua tetradactyla          -1.0293 1.3684 -3.9129 -0.9449\n(Intercept)-Tapirus terrestris              0.1420 0.3330 -0.5219  0.1369\n(Intercept)-Tayassu pecari                 -0.4618 0.8815 -1.9087 -0.5476\nscale(elev)-Atelocynus microtis             0.3373 1.2181 -2.4807  0.4220\nscale(elev)-Coendou prehensilis             0.9450 1.3027 -1.4557  0.8509\nscale(elev)-Cuniculus paca                  1.8881 0.4404  1.1298  1.8460\nscale(elev)-Dasypus sp.                     1.5493 0.4505  0.7692  1.5093\nscale(elev)-Didelphis marsupialis          -1.1533 1.0952 -3.9850 -0.9586\nscale(elev)-Eira barbara                    0.7301 0.6605 -0.5589  0.7010\nscale(elev)-Leopardus pardalis              0.3705 0.6835 -1.0179  0.3476\nscale(elev)-Leopardus wiedii               -1.6079 1.3783 -4.8862 -1.4367\nscale(elev)-Mazama americana                0.9844 0.4688  0.1371  0.9503\nscale(elev)-Mazama nemorivaga               2.0287 0.6640  0.8966  1.9773\nscale(elev)-Myoprocta pratti                1.4417 1.1977 -0.5176  1.3295\nscale(elev)-Myrmecophaga tridactyla        -0.7306 0.9048 -2.9247 -0.5930\nscale(elev)-Nasua nasua                    -0.9478 0.7540 -2.5713 -0.9067\nscale(elev)-Panthera onca                   0.7221 0.7106 -0.5651  0.6814\nscale(elev)-Pecari tajacu                   1.8186 0.4886  0.9835  1.7787\nscale(elev)-Priodontes maximus              0.8340 1.4655 -2.0660  0.8060\nscale(elev)-Procyon cancrivorous           -0.8295 0.9372 -2.9341 -0.7581\nscale(elev)-Puma concolor                   0.0554 1.0103 -2.0081  0.0561\nscale(elev)-Puma yagouaroundi               0.9853 1.3244 -1.4848  0.9091\nscale(elev)-Tamandua tetradactyla          -1.4499 1.2893 -4.1130 -1.3635\nscale(elev)-Tapirus terrestris              0.0155 0.3348 -0.6636  0.0207\nscale(elev)-Tayassu pecari                  1.3572 0.7605  0.1034  1.2726\nscale(border_dist)-Atelocynus microtis      1.3218 0.8558 -0.1210  1.2402\nscale(border_dist)-Coendou prehensilis     -0.0172 1.0850 -2.3460  0.0324\nscale(border_dist)-Cuniculus paca           0.5570 0.3872 -0.2293  0.5518\nscale(border_dist)-Dasypus sp.              1.3508 0.4526  0.5792  1.3117\nscale(border_dist)-Didelphis marsupialis    0.4683 0.8379 -0.9826  0.4092\nscale(border_dist)-Eira barbara             1.3920 0.6403  0.2657  1.3481\nscale(border_dist)-Leopardus pardalis      -0.3747 0.6284 -1.7776 -0.3179\nscale(border_dist)-Leopardus wiedii         0.1435 0.9962 -1.9433  0.1472\nscale(border_dist)-Mazama americana        -0.8696 0.5058 -1.9791 -0.8330\nscale(border_dist)-Mazama nemorivaga       -0.2786 0.5102 -1.3296 -0.2784\nscale(border_dist)-Myoprocta pratti        -0.5412 0.9327 -2.6790 -0.4634\nscale(border_dist)-Myrmecophaga tridactyla  1.2417 0.7439 -0.0125  1.1613\nscale(border_dist)-Nasua nasua              0.0800 0.6736 -1.3288  0.0898\nscale(border_dist)-Panthera onca           -0.6199 0.8005 -2.4052 -0.5345\nscale(border_dist)-Pecari tajacu           -0.9089 0.4707 -1.9198 -0.8966\nscale(border_dist)-Priodontes maximus       0.6755 1.0336 -1.3001  0.6410\nscale(border_dist)-Procyon cancrivorous     0.7109 0.9163 -1.0600  0.6631\nscale(border_dist)-Puma concolor            0.1368 0.8585 -1.6193  0.1302\nscale(border_dist)-Puma yagouaroundi        0.7133 1.0798 -1.2917  0.6555\nscale(border_dist)-Tamandua tetradactyla    0.0674 0.9610 -1.8273  0.0784\nscale(border_dist)-Tapirus terrestris      -0.1902 0.3394 -0.8848 -0.1847\nscale(border_dist)-Tayassu pecari           0.3731 0.5584 -0.7426  0.3707\n                                             97.5%   Rhat  ESS\n(Intercept)-Atelocynus microtis             1.4008 1.0292  222\n(Intercept)-Coendou prehensilis             1.2957 1.1721  136\n(Intercept)-Cuniculus paca                  1.8220 1.0230  421\n(Intercept)-Dasypus sp.                     0.7799 1.0140 1477\n(Intercept)-Didelphis marsupialis           0.6826 1.0057  179\n(Intercept)-Eira barbara                    1.1329 1.0140  700\n(Intercept)-Leopardus pardalis              1.8932 1.0224  371\n(Intercept)-Leopardus wiedii                1.4460 1.0546  290\n(Intercept)-Mazama americana               -0.4133 1.0046  466\n(Intercept)-Mazama nemorivaga               0.0361 1.0222  902\n(Intercept)-Myoprocta pratti                1.5208 1.0287  246\n(Intercept)-Myrmecophaga tridactyla         0.9380 1.0321  300\n(Intercept)-Nasua nasua                     2.0009 1.0362  431\n(Intercept)-Panthera onca                   1.3534 1.0022  352\n(Intercept)-Pecari tajacu                   2.1109 1.0140 1149\n(Intercept)-Priodontes maximus              1.9408 1.0489  230\n(Intercept)-Procyon cancrivorous            1.5477 1.0404  268\n(Intercept)-Puma concolor                   2.5177 1.0254  302\n(Intercept)-Puma yagouaroundi               1.7324 1.0443  274\n(Intercept)-Tamandua tetradactyla           1.5637 1.0396  194\n(Intercept)-Tapirus terrestris              0.8488 1.0035  956\n(Intercept)-Tayassu pecari                  1.5402 1.0587  319\nscale(elev)-Atelocynus microtis             2.6489 1.0095  336\nscale(elev)-Coendou prehensilis             3.8612 1.0034  336\nscale(elev)-Cuniculus paca                  2.8288 1.0271  952\nscale(elev)-Dasypus sp.                     2.5567 1.0069 1485\nscale(elev)-Didelphis marsupialis           0.4112 1.0150  283\nscale(elev)-Eira barbara                    2.1215 1.0127 1273\nscale(elev)-Leopardus pardalis              1.8257 1.0051  914\nscale(elev)-Leopardus wiedii                0.6994 1.0265  336\nscale(elev)-Mazama americana                1.9823 1.0175  720\nscale(elev)-Mazama nemorivaga               3.4969 1.0221 1201\nscale(elev)-Myoprocta pratti                4.2427 1.0150  488\nscale(elev)-Myrmecophaga tridactyla         0.7193 1.0156  351\nscale(elev)-Nasua nasua                     0.3587 1.0050  835\nscale(elev)-Panthera onca                   2.2607 1.0021  992\nscale(elev)-Pecari tajacu                   2.8962 1.0214 1776\nscale(elev)-Priodontes maximus              3.9618 1.0162  307\nscale(elev)-Procyon cancrivorous            0.8440 1.0053  636\nscale(elev)-Puma concolor                   1.9917 1.0087  508\nscale(elev)-Puma yagouaroundi               3.8818 1.0574  287\nscale(elev)-Tamandua tetradactyla           0.8064 1.0633  325\nscale(elev)-Tapirus terrestris              0.6740 1.0020 1395\nscale(elev)-Tayassu pecari                  3.1142 1.0314  436\nscale(border_dist)-Atelocynus microtis      3.2022 1.0106  745\nscale(border_dist)-Coendou prehensilis      2.0492 1.0136  484\nscale(border_dist)-Cuniculus paca           1.3444 0.9999 2539\nscale(border_dist)-Dasypus sp.              2.3358 1.0044 1391\nscale(border_dist)-Didelphis marsupialis    2.2919 1.0058  709\nscale(border_dist)-Eira barbara             2.8181 1.0094  934\nscale(border_dist)-Leopardus pardalis       0.7574 1.0302  796\nscale(border_dist)-Leopardus wiedii         2.1298 1.0220  643\nscale(border_dist)-Mazama americana         0.0502 1.0067  440\nscale(border_dist)-Mazama nemorivaga        0.7226 1.0035 2029\nscale(border_dist)-Myoprocta pratti         1.0922 1.0168  614\nscale(border_dist)-Myrmecophaga tridactyla  2.9128 1.0053 1128\nscale(border_dist)-Nasua nasua              1.4228 1.0062 1091\nscale(border_dist)-Panthera onca            0.7058 1.0208  715\nscale(border_dist)-Pecari tajacu           -0.0563 1.0047 1449\nscale(border_dist)-Priodontes maximus       2.9200 1.0014  597\nscale(border_dist)-Procyon cancrivorous     2.8140 1.0057  790\nscale(border_dist)-Puma concolor            1.8218 1.0175  751\nscale(border_dist)-Puma yagouaroundi        2.9814 1.0518  489\nscale(border_dist)-Tamandua tetradactyla    1.9902 1.0309  638\nscale(border_dist)-Tapirus terrestris       0.4672 1.0089  992\nscale(border_dist)-Tayassu pecari           1.5104 1.0021 1777\n\nDetection (logit scale): \n                                         Mean     SD    2.5%     50%   97.5%\n(Intercept)-Atelocynus microtis       -4.5888 0.7445 -5.9317 -4.6402 -2.9912\n(Intercept)-Coendou prehensilis       -5.5417 0.9690 -7.4619 -5.5487 -3.4510\n(Intercept)-Cuniculus paca            -0.9549 0.0840 -1.1268 -0.9543 -0.7948\n(Intercept)-Dasypus sp.               -1.4704 0.1179 -1.7049 -1.4687 -1.2476\n(Intercept)-Didelphis marsupialis     -3.4895 0.8207 -4.8976 -3.5541 -1.7716\n(Intercept)-Eira barbara              -3.0863 0.3180 -3.6973 -3.0981 -2.4480\n(Intercept)-Leopardus pardalis        -3.0118 0.3558 -3.6791 -3.0241 -2.2923\n(Intercept)-Leopardus wiedii          -4.7005 0.6577 -5.9322 -4.7333 -3.3357\n(Intercept)-Mazama americana          -1.0867 0.1316 -1.3513 -1.0818 -0.8394\n(Intercept)-Mazama nemorivaga         -2.0420 0.1886 -2.4147 -2.0385 -1.6865\n(Intercept)-Myoprocta pratti          -4.5143 0.6028 -5.6506 -4.5378 -3.2955\n(Intercept)-Myrmecophaga tridactyla   -3.4486 0.5005 -4.3156 -3.5046 -2.3627\n(Intercept)-Nasua nasua               -3.4019 0.3325 -4.0567 -3.4086 -2.7478\n(Intercept)-Panthera onca             -3.2869 0.4022 -4.0052 -3.3023 -2.4822\n(Intercept)-Pecari tajacu             -1.4630 0.1009 -1.6590 -1.4615 -1.2670\n(Intercept)-Priodontes maximus        -4.8817 0.6055 -6.0519 -4.8955 -3.5851\n(Intercept)-Procyon cancrivorous      -4.3181 0.6229 -5.4294 -4.3659 -2.9104\n(Intercept)-Puma concolor             -4.5334 0.5106 -5.5074 -4.5441 -3.4296\n(Intercept)-Puma yagouaroundi         -4.9881 0.6843 -6.3267 -5.0013 -3.5473\n(Intercept)-Tamandua tetradactyla     -4.8762 0.7575 -6.2181 -4.9161 -3.2053\n(Intercept)-Tapirus terrestris        -1.2094 0.1075 -1.4263 -1.2100 -1.0044\n(Intercept)-Tayassu pecari            -2.9836 0.3465 -3.6653 -2.9859 -2.3190\nscale(effort)-Atelocynus microtis      0.3683 0.2436 -0.0796  0.3567  0.9053\nscale(effort)-Coendou prehensilis      0.3595 0.2551 -0.1096  0.3540  0.9083\nscale(effort)-Cuniculus paca           0.2249 0.0881  0.0549  0.2243  0.3958\nscale(effort)-Dasypus sp.              0.3999 0.1380  0.1547  0.3917  0.6915\nscale(effort)-Didelphis marsupialis    0.4088 0.2463 -0.0387  0.3951  0.9427\nscale(effort)-Eira barbara             0.4538 0.2198  0.0771  0.4329  0.9444\nscale(effort)-Leopardus pardalis       0.2772 0.1913 -0.0664  0.2681  0.6675\nscale(effort)-Leopardus wiedii         0.3730 0.2442 -0.0854  0.3646  0.8998\nscale(effort)-Mazama americana         0.4231 0.1540  0.1452  0.4155  0.7532\nscale(effort)-Mazama nemorivaga        0.2438 0.1487 -0.0276  0.2379  0.5527\nscale(effort)-Myoprocta pratti         0.3323 0.2380 -0.1163  0.3205  0.8364\nscale(effort)-Myrmecophaga tridactyla  0.4431 0.2367  0.0355  0.4259  0.9632\nscale(effort)-Nasua nasua              0.3797 0.2105 -0.0030  0.3668  0.8317\nscale(effort)-Panthera onca            0.3020 0.2082 -0.0800  0.2978  0.7347\nscale(effort)-Pecari tajacu            0.2249 0.1029  0.0314  0.2225  0.4321\nscale(effort)-Priodontes maximus       0.3670 0.2488 -0.0744  0.3541  0.9063\nscale(effort)-Procyon cancrivorous     0.4079 0.2493 -0.0334  0.3926  0.9398\nscale(effort)-Puma concolor            0.3924 0.2401 -0.0489  0.3753  0.9257\nscale(effort)-Puma yagouaroundi        0.3722 0.2550 -0.1100  0.3608  0.9444\nscale(effort)-Tamandua tetradactyla    0.3558 0.2450 -0.1163  0.3481  0.8566\nscale(effort)-Tapirus terrestris       0.3303 0.1212  0.1097  0.3277  0.5883\nscale(effort)-Tayassu pecari           0.4806 0.2286  0.0979  0.4582  0.9832\n                                        Rhat  ESS\n(Intercept)-Atelocynus microtis       1.0169  248\n(Intercept)-Coendou prehensilis       1.0719  182\n(Intercept)-Cuniculus paca            1.0029 3000\n(Intercept)-Dasypus sp.               1.0004 2638\n(Intercept)-Didelphis marsupialis     1.0009  204\n(Intercept)-Eira barbara              1.0049  889\n(Intercept)-Leopardus pardalis        1.0215  444\n(Intercept)-Leopardus wiedii          1.0235  428\n(Intercept)-Mazama americana          1.0079 2412\n(Intercept)-Mazama nemorivaga         1.0053 1988\n(Intercept)-Myoprocta pratti          1.0267  259\n(Intercept)-Myrmecophaga tridactyla   1.0193  331\n(Intercept)-Nasua nasua               1.0215  677\n(Intercept)-Panthera onca             1.0024  557\n(Intercept)-Pecari tajacu             1.0016 2491\n(Intercept)-Priodontes maximus        1.0339  398\n(Intercept)-Procyon cancrivorous      1.0396  413\n(Intercept)-Puma concolor             1.0220  513\n(Intercept)-Puma yagouaroundi         1.0405  370\n(Intercept)-Tamandua tetradactyla     1.0317  271\n(Intercept)-Tapirus terrestris        1.0021 3000\n(Intercept)-Tayassu pecari            1.0311  552\nscale(effort)-Atelocynus microtis     1.0017 2027\nscale(effort)-Coendou prehensilis     1.0021 2419\nscale(effort)-Cuniculus paca          1.0035 3000\nscale(effort)-Dasypus sp.             1.0053 2690\nscale(effort)-Didelphis marsupialis   1.0174 2354\nscale(effort)-Eira barbara            1.0107 2020\nscale(effort)-Leopardus pardalis      1.0009 2839\nscale(effort)-Leopardus wiedii        1.0095 2518\nscale(effort)-Mazama americana        1.0049 2409\nscale(effort)-Mazama nemorivaga       1.0031 3000\nscale(effort)-Myoprocta pratti        1.0009 1946\nscale(effort)-Myrmecophaga tridactyla 1.0031 1972\nscale(effort)-Nasua nasua             1.0050 2086\nscale(effort)-Panthera onca           0.9999 2744\nscale(effort)-Pecari tajacu           1.0028 3000\nscale(effort)-Priodontes maximus      1.0039 1982\nscale(effort)-Procyon cancrivorous    1.0024 1986\nscale(effort)-Puma concolor           1.0119 2356\nscale(effort)-Puma yagouaroundi       1.0081 2254\nscale(effort)-Tamandua tetradactyla   1.0023 2537\nscale(effort)-Tapirus terrestris      1.0019 2841\nscale(effort)-Tayassu pecari          1.0038 1970\n\n----------------------------------------\n    Spatial Covariance\n----------------------------------------\n        Mean     SD  2.5%    50%  97.5%   Rhat ESS\nphi-1 0.0126 0.0108 2e-04 0.0106 0.0326 1.0966 125\nphi-2 0.0143 0.0106 2e-04 0.0131 0.0329 1.1054 314\nphi-3 0.0160 0.0100 9e-04 0.0156 0.0328 1.0135 562\n\nCodesummary(out.sp, level = 'both')\n\n\nCall:\nsfMsPGOcc(occ.formula = ~scale(elev) + scale(border_dist), det.formula = ~scale(effort), \n    data = data_list, cov.model = \"exponential\", NNGP = TRUE, \n    n.neighbors = 15, n.factors = 3, n.batch = 600, batch.length = 25, \n    n.report = 100, n.burn = 5000, n.thin = 10, n.chains = 3)\n\nSamples per Chain: 15000\nBurn-in: 5000\nThinning Rate: 10\nNumber of Chains: 3\nTotal Posterior Samples: 3000\nRun Time (min): 15.6725\n\n----------------------------------------\n    Community Level\n----------------------------------------\nOccurrence Means (logit scale): \n                      Mean     SD    2.5%     50%  97.5%   Rhat ESS\n(Intercept)        -0.4813 0.4389 -1.3441 -0.4732 0.3708 1.1009 133\nscale(elev)         0.4093 0.3952 -0.3744  0.4200 1.1530 1.0029 744\nscale(border_dist)  0.2395 0.3068 -0.3666  0.2442 0.8393 1.0066 987\n\nOccurrence Variances (logit scale): \n                     Mean     SD   2.5%    50%  97.5%   Rhat ESS\n(Intercept)        1.5511 1.0122 0.3765 1.2966 4.1803 1.0068 212\nscale(elev)        2.3246 1.6232 0.6121 1.8939 6.5985 1.0781 223\nscale(border_dist) 1.1855 0.8933 0.2648 0.9626 3.4158 1.0541 303\n\nDetection Means (logit scale): \n                 Mean     SD    2.5%     50%   97.5%   Rhat  ESS\n(Intercept)   -3.2231 0.3668 -3.9325 -3.2249 -2.5244 1.0357  512\nscale(effort)  0.3597 0.0963  0.1835  0.3523  0.5747 1.0060 1442\n\nDetection Variances (logit scale): \n                Mean     SD   2.5%    50%  97.5%   Rhat  ESS\n(Intercept)   2.5718 0.9953 1.2223 2.3768 5.1403 1.0088 1027\nscale(effort) 0.0596 0.0401 0.0189 0.0493 0.1636 1.0100 1551\n\n----------------------------------------\n    Species Level\n----------------------------------------\nOccurrence (logit scale): \n                                              Mean     SD    2.5%     50%\n(Intercept)-Atelocynus microtis            -1.0452 1.3035 -3.5509 -0.9992\n(Intercept)-Coendou prehensilis            -1.1445 1.3975 -4.3246 -0.9900\n(Intercept)-Cuniculus paca                  1.0362 0.3804  0.3433  1.0153\n(Intercept)-Dasypus sp.                     0.0705 0.3458 -0.5906  0.0683\n(Intercept)-Didelphis marsupialis          -1.8565 1.2528 -4.0889 -1.9384\n(Intercept)-Eira barbara                   -0.4502 0.7587 -1.8812 -0.4863\n(Intercept)-Leopardus pardalis             -0.1839 0.9293 -1.7047 -0.3021\n(Intercept)-Leopardus wiedii               -0.8918 1.2232 -3.3160 -0.8641\n(Intercept)-Mazama americana               -1.2148 0.4507 -2.1808 -1.1787\n(Intercept)-Mazama nemorivaga              -0.9447 0.5274 -2.0324 -0.9360\n(Intercept)-Myoprocta pratti               -0.8308 1.2129 -3.2057 -0.8206\n(Intercept)-Myrmecophaga tridactyla        -1.0630 0.9677 -2.8595 -1.1013\n(Intercept)-Nasua nasua                     0.0876 0.9003 -1.5458  0.0446\n(Intercept)-Panthera onca                  -0.6588 0.9373 -2.3551 -0.7068\n(Intercept)-Pecari tajacu                   1.1646 0.4373  0.3901  1.1253\n(Intercept)-Priodontes maximus             -0.3785 1.1376 -2.5436 -0.3840\n(Intercept)-Procyon cancrivorous           -0.8588 1.1699 -3.0954 -0.8554\n(Intercept)-Puma concolor                   0.1599 1.1615 -2.0084  0.1373\n(Intercept)-Puma yagouaroundi              -0.7599 1.2853 -3.3113 -0.7114\n(Intercept)-Tamandua tetradactyla          -1.0293 1.3684 -3.9129 -0.9449\n(Intercept)-Tapirus terrestris              0.1420 0.3330 -0.5219  0.1369\n(Intercept)-Tayassu pecari                 -0.4618 0.8815 -1.9087 -0.5476\nscale(elev)-Atelocynus microtis             0.3373 1.2181 -2.4807  0.4220\nscale(elev)-Coendou prehensilis             0.9450 1.3027 -1.4557  0.8509\nscale(elev)-Cuniculus paca                  1.8881 0.4404  1.1298  1.8460\nscale(elev)-Dasypus sp.                     1.5493 0.4505  0.7692  1.5093\nscale(elev)-Didelphis marsupialis          -1.1533 1.0952 -3.9850 -0.9586\nscale(elev)-Eira barbara                    0.7301 0.6605 -0.5589  0.7010\nscale(elev)-Leopardus pardalis              0.3705 0.6835 -1.0179  0.3476\nscale(elev)-Leopardus wiedii               -1.6079 1.3783 -4.8862 -1.4367\nscale(elev)-Mazama americana                0.9844 0.4688  0.1371  0.9503\nscale(elev)-Mazama nemorivaga               2.0287 0.6640  0.8966  1.9773\nscale(elev)-Myoprocta pratti                1.4417 1.1977 -0.5176  1.3295\nscale(elev)-Myrmecophaga tridactyla        -0.7306 0.9048 -2.9247 -0.5930\nscale(elev)-Nasua nasua                    -0.9478 0.7540 -2.5713 -0.9067\nscale(elev)-Panthera onca                   0.7221 0.7106 -0.5651  0.6814\nscale(elev)-Pecari tajacu                   1.8186 0.4886  0.9835  1.7787\nscale(elev)-Priodontes maximus              0.8340 1.4655 -2.0660  0.8060\nscale(elev)-Procyon cancrivorous           -0.8295 0.9372 -2.9341 -0.7581\nscale(elev)-Puma concolor                   0.0554 1.0103 -2.0081  0.0561\nscale(elev)-Puma yagouaroundi               0.9853 1.3244 -1.4848  0.9091\nscale(elev)-Tamandua tetradactyla          -1.4499 1.2893 -4.1130 -1.3635\nscale(elev)-Tapirus terrestris              0.0155 0.3348 -0.6636  0.0207\nscale(elev)-Tayassu pecari                  1.3572 0.7605  0.1034  1.2726\nscale(border_dist)-Atelocynus microtis      1.3218 0.8558 -0.1210  1.2402\nscale(border_dist)-Coendou prehensilis     -0.0172 1.0850 -2.3460  0.0324\nscale(border_dist)-Cuniculus paca           0.5570 0.3872 -0.2293  0.5518\nscale(border_dist)-Dasypus sp.              1.3508 0.4526  0.5792  1.3117\nscale(border_dist)-Didelphis marsupialis    0.4683 0.8379 -0.9826  0.4092\nscale(border_dist)-Eira barbara             1.3920 0.6403  0.2657  1.3481\nscale(border_dist)-Leopardus pardalis      -0.3747 0.6284 -1.7776 -0.3179\nscale(border_dist)-Leopardus wiedii         0.1435 0.9962 -1.9433  0.1472\nscale(border_dist)-Mazama americana        -0.8696 0.5058 -1.9791 -0.8330\nscale(border_dist)-Mazama nemorivaga       -0.2786 0.5102 -1.3296 -0.2784\nscale(border_dist)-Myoprocta pratti        -0.5412 0.9327 -2.6790 -0.4634\nscale(border_dist)-Myrmecophaga tridactyla  1.2417 0.7439 -0.0125  1.1613\nscale(border_dist)-Nasua nasua              0.0800 0.6736 -1.3288  0.0898\nscale(border_dist)-Panthera onca           -0.6199 0.8005 -2.4052 -0.5345\nscale(border_dist)-Pecari tajacu           -0.9089 0.4707 -1.9198 -0.8966\nscale(border_dist)-Priodontes maximus       0.6755 1.0336 -1.3001  0.6410\nscale(border_dist)-Procyon cancrivorous     0.7109 0.9163 -1.0600  0.6631\nscale(border_dist)-Puma concolor            0.1368 0.8585 -1.6193  0.1302\nscale(border_dist)-Puma yagouaroundi        0.7133 1.0798 -1.2917  0.6555\nscale(border_dist)-Tamandua tetradactyla    0.0674 0.9610 -1.8273  0.0784\nscale(border_dist)-Tapirus terrestris      -0.1902 0.3394 -0.8848 -0.1847\nscale(border_dist)-Tayassu pecari           0.3731 0.5584 -0.7426  0.3707\n                                             97.5%   Rhat  ESS\n(Intercept)-Atelocynus microtis             1.4008 1.0292  222\n(Intercept)-Coendou prehensilis             1.2957 1.1721  136\n(Intercept)-Cuniculus paca                  1.8220 1.0230  421\n(Intercept)-Dasypus sp.                     0.7799 1.0140 1477\n(Intercept)-Didelphis marsupialis           0.6826 1.0057  179\n(Intercept)-Eira barbara                    1.1329 1.0140  700\n(Intercept)-Leopardus pardalis              1.8932 1.0224  371\n(Intercept)-Leopardus wiedii                1.4460 1.0546  290\n(Intercept)-Mazama americana               -0.4133 1.0046  466\n(Intercept)-Mazama nemorivaga               0.0361 1.0222  902\n(Intercept)-Myoprocta pratti                1.5208 1.0287  246\n(Intercept)-Myrmecophaga tridactyla         0.9380 1.0321  300\n(Intercept)-Nasua nasua                     2.0009 1.0362  431\n(Intercept)-Panthera onca                   1.3534 1.0022  352\n(Intercept)-Pecari tajacu                   2.1109 1.0140 1149\n(Intercept)-Priodontes maximus              1.9408 1.0489  230\n(Intercept)-Procyon cancrivorous            1.5477 1.0404  268\n(Intercept)-Puma concolor                   2.5177 1.0254  302\n(Intercept)-Puma yagouaroundi               1.7324 1.0443  274\n(Intercept)-Tamandua tetradactyla           1.5637 1.0396  194\n(Intercept)-Tapirus terrestris              0.8488 1.0035  956\n(Intercept)-Tayassu pecari                  1.5402 1.0587  319\nscale(elev)-Atelocynus microtis             2.6489 1.0095  336\nscale(elev)-Coendou prehensilis             3.8612 1.0034  336\nscale(elev)-Cuniculus paca                  2.8288 1.0271  952\nscale(elev)-Dasypus sp.                     2.5567 1.0069 1485\nscale(elev)-Didelphis marsupialis           0.4112 1.0150  283\nscale(elev)-Eira barbara                    2.1215 1.0127 1273\nscale(elev)-Leopardus pardalis              1.8257 1.0051  914\nscale(elev)-Leopardus wiedii                0.6994 1.0265  336\nscale(elev)-Mazama americana                1.9823 1.0175  720\nscale(elev)-Mazama nemorivaga               3.4969 1.0221 1201\nscale(elev)-Myoprocta pratti                4.2427 1.0150  488\nscale(elev)-Myrmecophaga tridactyla         0.7193 1.0156  351\nscale(elev)-Nasua nasua                     0.3587 1.0050  835\nscale(elev)-Panthera onca                   2.2607 1.0021  992\nscale(elev)-Pecari tajacu                   2.8962 1.0214 1776\nscale(elev)-Priodontes maximus              3.9618 1.0162  307\nscale(elev)-Procyon cancrivorous            0.8440 1.0053  636\nscale(elev)-Puma concolor                   1.9917 1.0087  508\nscale(elev)-Puma yagouaroundi               3.8818 1.0574  287\nscale(elev)-Tamandua tetradactyla           0.8064 1.0633  325\nscale(elev)-Tapirus terrestris              0.6740 1.0020 1395\nscale(elev)-Tayassu pecari                  3.1142 1.0314  436\nscale(border_dist)-Atelocynus microtis      3.2022 1.0106  745\nscale(border_dist)-Coendou prehensilis      2.0492 1.0136  484\nscale(border_dist)-Cuniculus paca           1.3444 0.9999 2539\nscale(border_dist)-Dasypus sp.              2.3358 1.0044 1391\nscale(border_dist)-Didelphis marsupialis    2.2919 1.0058  709\nscale(border_dist)-Eira barbara             2.8181 1.0094  934\nscale(border_dist)-Leopardus pardalis       0.7574 1.0302  796\nscale(border_dist)-Leopardus wiedii         2.1298 1.0220  643\nscale(border_dist)-Mazama americana         0.0502 1.0067  440\nscale(border_dist)-Mazama nemorivaga        0.7226 1.0035 2029\nscale(border_dist)-Myoprocta pratti         1.0922 1.0168  614\nscale(border_dist)-Myrmecophaga tridactyla  2.9128 1.0053 1128\nscale(border_dist)-Nasua nasua              1.4228 1.0062 1091\nscale(border_dist)-Panthera onca            0.7058 1.0208  715\nscale(border_dist)-Pecari tajacu           -0.0563 1.0047 1449\nscale(border_dist)-Priodontes maximus       2.9200 1.0014  597\nscale(border_dist)-Procyon cancrivorous     2.8140 1.0057  790\nscale(border_dist)-Puma concolor            1.8218 1.0175  751\nscale(border_dist)-Puma yagouaroundi        2.9814 1.0518  489\nscale(border_dist)-Tamandua tetradactyla    1.9902 1.0309  638\nscale(border_dist)-Tapirus terrestris       0.4672 1.0089  992\nscale(border_dist)-Tayassu pecari           1.5104 1.0021 1777\n\nDetection (logit scale): \n                                         Mean     SD    2.5%     50%   97.5%\n(Intercept)-Atelocynus microtis       -4.5888 0.7445 -5.9317 -4.6402 -2.9912\n(Intercept)-Coendou prehensilis       -5.5417 0.9690 -7.4619 -5.5487 -3.4510\n(Intercept)-Cuniculus paca            -0.9549 0.0840 -1.1268 -0.9543 -0.7948\n(Intercept)-Dasypus sp.               -1.4704 0.1179 -1.7049 -1.4687 -1.2476\n(Intercept)-Didelphis marsupialis     -3.4895 0.8207 -4.8976 -3.5541 -1.7716\n(Intercept)-Eira barbara              -3.0863 0.3180 -3.6973 -3.0981 -2.4480\n(Intercept)-Leopardus pardalis        -3.0118 0.3558 -3.6791 -3.0241 -2.2923\n(Intercept)-Leopardus wiedii          -4.7005 0.6577 -5.9322 -4.7333 -3.3357\n(Intercept)-Mazama americana          -1.0867 0.1316 -1.3513 -1.0818 -0.8394\n(Intercept)-Mazama nemorivaga         -2.0420 0.1886 -2.4147 -2.0385 -1.6865\n(Intercept)-Myoprocta pratti          -4.5143 0.6028 -5.6506 -4.5378 -3.2955\n(Intercept)-Myrmecophaga tridactyla   -3.4486 0.5005 -4.3156 -3.5046 -2.3627\n(Intercept)-Nasua nasua               -3.4019 0.3325 -4.0567 -3.4086 -2.7478\n(Intercept)-Panthera onca             -3.2869 0.4022 -4.0052 -3.3023 -2.4822\n(Intercept)-Pecari tajacu             -1.4630 0.1009 -1.6590 -1.4615 -1.2670\n(Intercept)-Priodontes maximus        -4.8817 0.6055 -6.0519 -4.8955 -3.5851\n(Intercept)-Procyon cancrivorous      -4.3181 0.6229 -5.4294 -4.3659 -2.9104\n(Intercept)-Puma concolor             -4.5334 0.5106 -5.5074 -4.5441 -3.4296\n(Intercept)-Puma yagouaroundi         -4.9881 0.6843 -6.3267 -5.0013 -3.5473\n(Intercept)-Tamandua tetradactyla     -4.8762 0.7575 -6.2181 -4.9161 -3.2053\n(Intercept)-Tapirus terrestris        -1.2094 0.1075 -1.4263 -1.2100 -1.0044\n(Intercept)-Tayassu pecari            -2.9836 0.3465 -3.6653 -2.9859 -2.3190\nscale(effort)-Atelocynus microtis      0.3683 0.2436 -0.0796  0.3567  0.9053\nscale(effort)-Coendou prehensilis      0.3595 0.2551 -0.1096  0.3540  0.9083\nscale(effort)-Cuniculus paca           0.2249 0.0881  0.0549  0.2243  0.3958\nscale(effort)-Dasypus sp.              0.3999 0.1380  0.1547  0.3917  0.6915\nscale(effort)-Didelphis marsupialis    0.4088 0.2463 -0.0387  0.3951  0.9427\nscale(effort)-Eira barbara             0.4538 0.2198  0.0771  0.4329  0.9444\nscale(effort)-Leopardus pardalis       0.2772 0.1913 -0.0664  0.2681  0.6675\nscale(effort)-Leopardus wiedii         0.3730 0.2442 -0.0854  0.3646  0.8998\nscale(effort)-Mazama americana         0.4231 0.1540  0.1452  0.4155  0.7532\nscale(effort)-Mazama nemorivaga        0.2438 0.1487 -0.0276  0.2379  0.5527\nscale(effort)-Myoprocta pratti         0.3323 0.2380 -0.1163  0.3205  0.8364\nscale(effort)-Myrmecophaga tridactyla  0.4431 0.2367  0.0355  0.4259  0.9632\nscale(effort)-Nasua nasua              0.3797 0.2105 -0.0030  0.3668  0.8317\nscale(effort)-Panthera onca            0.3020 0.2082 -0.0800  0.2978  0.7347\nscale(effort)-Pecari tajacu            0.2249 0.1029  0.0314  0.2225  0.4321\nscale(effort)-Priodontes maximus       0.3670 0.2488 -0.0744  0.3541  0.9063\nscale(effort)-Procyon cancrivorous     0.4079 0.2493 -0.0334  0.3926  0.9398\nscale(effort)-Puma concolor            0.3924 0.2401 -0.0489  0.3753  0.9257\nscale(effort)-Puma yagouaroundi        0.3722 0.2550 -0.1100  0.3608  0.9444\nscale(effort)-Tamandua tetradactyla    0.3558 0.2450 -0.1163  0.3481  0.8566\nscale(effort)-Tapirus terrestris       0.3303 0.1212  0.1097  0.3277  0.5883\nscale(effort)-Tayassu pecari           0.4806 0.2286  0.0979  0.4582  0.9832\n                                        Rhat  ESS\n(Intercept)-Atelocynus microtis       1.0169  248\n(Intercept)-Coendou prehensilis       1.0719  182\n(Intercept)-Cuniculus paca            1.0029 3000\n(Intercept)-Dasypus sp.               1.0004 2638\n(Intercept)-Didelphis marsupialis     1.0009  204\n(Intercept)-Eira barbara              1.0049  889\n(Intercept)-Leopardus pardalis        1.0215  444\n(Intercept)-Leopardus wiedii          1.0235  428\n(Intercept)-Mazama americana          1.0079 2412\n(Intercept)-Mazama nemorivaga         1.0053 1988\n(Intercept)-Myoprocta pratti          1.0267  259\n(Intercept)-Myrmecophaga tridactyla   1.0193  331\n(Intercept)-Nasua nasua               1.0215  677\n(Intercept)-Panthera onca             1.0024  557\n(Intercept)-Pecari tajacu             1.0016 2491\n(Intercept)-Priodontes maximus        1.0339  398\n(Intercept)-Procyon cancrivorous      1.0396  413\n(Intercept)-Puma concolor             1.0220  513\n(Intercept)-Puma yagouaroundi         1.0405  370\n(Intercept)-Tamandua tetradactyla     1.0317  271\n(Intercept)-Tapirus terrestris        1.0021 3000\n(Intercept)-Tayassu pecari            1.0311  552\nscale(effort)-Atelocynus microtis     1.0017 2027\nscale(effort)-Coendou prehensilis     1.0021 2419\nscale(effort)-Cuniculus paca          1.0035 3000\nscale(effort)-Dasypus sp.             1.0053 2690\nscale(effort)-Didelphis marsupialis   1.0174 2354\nscale(effort)-Eira barbara            1.0107 2020\nscale(effort)-Leopardus pardalis      1.0009 2839\nscale(effort)-Leopardus wiedii        1.0095 2518\nscale(effort)-Mazama americana        1.0049 2409\nscale(effort)-Mazama nemorivaga       1.0031 3000\nscale(effort)-Myoprocta pratti        1.0009 1946\nscale(effort)-Myrmecophaga tridactyla 1.0031 1972\nscale(effort)-Nasua nasua             1.0050 2086\nscale(effort)-Panthera onca           0.9999 2744\nscale(effort)-Pecari tajacu           1.0028 3000\nscale(effort)-Priodontes maximus      1.0039 1982\nscale(effort)-Procyon cancrivorous    1.0024 1986\nscale(effort)-Puma concolor           1.0119 2356\nscale(effort)-Puma yagouaroundi       1.0081 2254\nscale(effort)-Tamandua tetradactyla   1.0023 2537\nscale(effort)-Tapirus terrestris      1.0019 2841\nscale(effort)-Tayassu pecari          1.0038 1970\n\n----------------------------------------\n    Spatial Covariance\n----------------------------------------\n        Mean     SD  2.5%    50%  97.5%   Rhat ESS\nphi-1 0.0126 0.0108 2e-04 0.0106 0.0326 1.0966 125\nphi-2 0.0143 0.0106 2e-04 0.0131 0.0329 1.1054 314\nphi-3 0.0160 0.0100 9e-04 0.0156 0.0328 1.0135 562\n\n\nBayesian p-values can be inspected to check for lack of fit (overall or by species). Lack of fit at significance level = 0.05 is indicated by Bayesian p-values below 0.025 or greater than 0.975. The overall Bayesian p-value (Bpvalue) indicates no problems with lack of fit. Likewise, species-level Bayesian p-values (Bpvalue_species) indicate no lack of fit for any species.\n\nGelman and Rubin’s convergence diagnostic: Approximate convergence is diagnosed when the upper limit is close to 1.\n\nConvergence is diagnosed when the chains have ‘forgotten’ their initial values, and the output from all chains is indistinguishable. The gelman.diag diagnostic is applied to a single variable from the chain. It is based a comparison of within-chain and between-chain variances, and is similar to a classical analysis of variance.\nValues substantially above 1 indicate lack of convergence.\nModel Diagnostics\n\nCode#| eval: true\n#| echo: true\n#| code-fold: true\n#| warning: false\n#| message: false\n# Extract posterior draws for later use\nposterior1 &lt;- as.array(out.sp)\n\n# Trace plots to check chain mixing. Extract posterior samples and bind in a single matrix.\nPOSTERIOR.MATRIX &lt;- cbind(out.sp$alpha.comm.samples, \n                          out.sp$beta.comm.samples,  \n                          out.sp$alpha.samples, \n                          out.sp$beta.samples)\n\n# Matrix output is all chains combined, split into 3 chains.\nCHAIN.1 &lt;- as.mcmc(POSTERIOR.MATRIX[1:1000,])\nCHAIN.2 &lt;- as.mcmc(POSTERIOR.MATRIX[1001:2000,])\nCHAIN.3 &lt;- as.mcmc(POSTERIOR.MATRIX[2001:3000,])\n# CHAIN.4 &lt;- as.mcmc(POSTERIOR.MATRIX[8001:10000,])\n\n# Bind four chains as coda mcmc.list object.\nPOSTERIOR.CHAINS &lt;- mcmc.list(CHAIN.1, CHAIN.2, CHAIN.3)#, CHAIN.4)\n\n# Create an empty folder.\n# dir.create (\"Beetle_plots\")\n\n# Plot chain mixing of each parameter to a multi-panel plot and save to the new folder. ART 5 mins\n\n######################################\n#### SAVE Diagnostics at PDF\n# MCMCtrace(POSTERIOR.CHAINS, params = \"all\", Rhat = TRUE, n.eff = TRUE)#, pdf = TRUE, filename = \"Beetle_240909_traceplots.pdf\", wd = \"Beetle_plots\")\n\n\n\n#mcmc_trace(fit.commu, parms = c(\"beta.ranef.cont.border_dist.mean\"))\n\n#posterior2 &lt;- extract(fit.commu, inc_warmup = TRUE, permuted = FALSE)\n\n#color_scheme_set(\"mix-blue-pink\")\n#p &lt;- mcmc_trace(posterior1,  pars = c(\"mu\", \"tau\"), n_warmup = 300,\n#                facet_args = list(nrow = 2, labeller = label_parsed))\n#p + facet_text(size = 15)\n\n\n\n#outMCMC &lt;- fit.commu #Convert output to MCMC object\n#diagnostics chains \n\n# all as pdf\n# MCMCtrace(outMCMC)\n\n# MCMCtrace(outMCMC, params = c(\"alpha0\"), type = 'trace', Rhat = TRUE, n.eff = TRUE)\n\n# MCMCtrace(outMCMC, params = c(\"beta0\"), type = 'trace', Rhat = TRUE, n.eff = TRUE)\n\n# MCMCtrace(outMCMC, params = c(\"beta.ranef.cont.border_dist\"), type = 'trace', Rhat = TRUE, n.eff = TRUE)\n\n# MCMCtrace(out.sp, params = c(\"beta.ranef.cont.border_dist.mean\"), type = 'trace', pdf = F, Rhat = TRUE, n.eff = TRUE)\n\n# MCMCtrace(outMCMC, params = c(\"beta.ranef.cont.elev\"), type = 'trace', Rhat = TRUE, n.eff = TRUE)\n\n# MCMCtrace(outMCMC, params = c(\"beta.ranef.cont.elev.mean\"), type = 'trace', pdf = F, Rhat = TRUE, n.eff = TRUE)\n\n\n### density\n# MCMCtrace(outMCMC, params = c(\"Nspecies\"), ISB = FALSE, pdf = F, exact = TRUE, post_zm = TRUE, type = 'density', Rhat = TRUE, n.eff = TRUE, ind = TRUE)\n\n### density\n# MCMCtrace(outMCMC, params = c(\"beta.ranef.cont.elev.mean\"), ISB = FALSE, pdf = F, exact = TRUE, post_zm = TRUE, type = 'density', Rhat = TRUE, n.eff = TRUE, ind = TRUE)\n\n### density\n#MCMCtrace(outMCMC, params = c(\"beta.ranef.cont.border_dist.mean\"), ISB = FALSE, pdf = F, exact = TRUE, post_zm = TRUE, type = 'density', Rhat = TRUE, n.eff = TRUE, ind = TRUE)\n\n#coda::gelman.diag(outMCMC,  multivariate = FALSE, transform=FALSE)\n                    \n# coda::gelman.plot(outMCMC,  multivariate = FALSE)\n\n\n\n# \n# mcmc_intervals(outMCMC, pars = c(\"Nspecies_in_AP[1]\",\n#                                  \"Nspecies_in_AP[2]\"),\n#                point_est = \"mean\",\n#                prob = 0.75, prob_outer = 0.95) +\n#   ggtitle(\"Number of species\") + \n#   scale_y_discrete(labels = c(\"Nspecies_in_AP[1]\"=levels(sitecovs$in_AP)[1],\n#              \"Nspecies_in_AP[2]\"=levels(sitecovs$in_AP)[2]))\n# \n# #Continuous\n# p &lt;- mcmc_intervals(outMCMC, \n#                pars = c(\"beta.ranef.cont.border_dist.mean\",\n#                          #\"beta.ranef.cont.elev.mean\",\n#                         \"beta.ranef.categ.in_AP.mean[2]\"))\n# \n# # relabel parameters\n# p + scale_y_discrete(\n#   labels = c(\"beta.ranef.cont.border_dist.mean\"=\"Dist_border\",\n#                          #\"beta.ranef.cont.elev.mean\"=\"Elevation\",\n#                         \"beta.ranef.categ.in_AP.mean[2]\"=\"in_AP\")\n# ) +\n#   ggtitle(\"Treatment effect on all species\")\n# \n\n\nPosterior Summary (effect)\nCommunity effects\nCode# Create simple plot summaries using MCMCvis package.\n# Detection covariate effects --------- \nMCMCplot(out.sp$alpha.comm.samples, ref_ovl = TRUE, ci = c(50, 95))\n# Occupancy community-level effects \nMCMCplot(out.sp$beta.comm.samples, ref_ovl = TRUE, ci = c(50, 95))\n\n\n\n\n\n\n\n\n\n(a) Detection\n\n\n\n\n\n\n\n\n\n(b) Occupancy\n\n\n\n\n\n\nFigure 1: Community effects\n\n\nSpecies effects\nCode# Occupancy species-level effects \nMCMCplot(out.sp$beta.samples[,23:44], ref_ovl = TRUE, ci = c(50, 95))\n\n# Occupancy species-level effects \nMCMCplot(out.sp$beta.samples[,45:66], ref_ovl = TRUE, ci = c(50, 95))\n\n\n\n\n\n\n\n\n\n(a) elevation\n\n\n\n\n\n\n\n\n\n(b) distance border\n\n\n\n\n\n\nFigure 2: Species effects\n\n\nSpecies effects using bayesplot\n\n\nCodelibrary(bayesplot)\n#mcmc_areas(outMCMC, regex_pars = \"Nspecies_in_AP\")\n# mcmc_areas(outMCMC, regex_pars = \"Nspecies_in_AP\")\n\nmcmc_intervals(out.sp$beta.samples[,23:44] , point_est = \"mean\",\n               prob = 0.75, prob_outer = 0.95) + \n  geom_vline(xintercept = 0, color = \"red\", linetype = \"dashed\", size = 0.5)\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\n\n\nCodemcmc_intervals(out.sp$beta.samples[,45:66] , point_est = \"mean\",\n               prob = 0.75, prob_outer = 0.95) + \n  geom_vline(xintercept = 0, color = \"red\", linetype = \"dashed\", size = 0.5)\n\n\n\n\n\n\n\nPrediction as graph\nThis prediction uses the non spatial model\n\nCode# 6. Prediction -----------------------------------------------------------\n# Predict occupancy along a gradient of elev   \n# Create a set of values across the range of observed elev values\nelev.pred.vals &lt;- seq(min(data_list$occ.covs$elev), \n                              max(data_list$occ.covs$elev), \n                              length.out = 100)\n# Scale predicted values by mean and standard deviation used to fit the model\nelev.pred.vals.scale &lt;- (elev.pred.vals - mean(data_list$occ.covs$elev)) / \n                             sd(data_list$occ.covs$elev)\n# Create a set of values across the range of observed elev values\nborder_dist.pred.vals &lt;- seq(min(data_list$occ.covs$border_dist), \n                              max(data_list$occ.covs$border_dist), \n                              length.out = 100)\n# Scale predicted values by mean and standard deviation used to fit the model\nborder_dist.pred.vals.scale &lt;- (border_dist.pred.vals -\n                                  mean(data_list$occ.covs$border_dist)) /\n                                  sd(data_list$occ.covs$border_dist)\n\n# Predict occupancy across elev  values at mean values of all other variables\npred.df1 &lt;- as.matrix(data.frame(intercept = 1, elev = elev.pred.vals.scale, \n                         border_dist = 0 ))#, catchment = 0, density = 0, \n                         # slope = 0))\n# Predict occupancy across elev  values at mean values of all other variables\npred.df2 &lt;- as.matrix(data.frame(intercept = 1, elev = 0, \n                         border_dist = border_dist.pred.vals.scale ))#, catchment = 0, density = 0, \n                         # slope = 0))\n\nout.pred1 &lt;- predict(out, pred.df1) # using non spatial\nstr(out.pred1)\n\nList of 3\n $ psi.0.samples: num [1:1500, 1:22, 1:100] 0.0559 0.0515 0.2219 0.0346 0.0224 ...\n $ z.0.samples  : int [1:1500, 1:22, 1:100] 0 0 0 0 0 0 0 0 0 0 ...\n $ call         : language predict.msPGOcc(object = out, X.0 = pred.df1)\n - attr(*, \"class\")= chr \"predict.msPGOcc\"\n\nCodepsi.0.quants &lt;- apply(out.pred1$psi.0.samples, c(2, 3), quantile, \n                          prob = c(0.025, 0.5, 0.975))\nsp.codes &lt;- attr(data_list$y, \"dimnames\")[[1]]\npsi.plot.dat &lt;- data.frame(psi.med = c(t(psi.0.quants[2, , ])), \n                                 psi.low = c(t(psi.0.quants[1, , ])), \n                                 psi.high = c(t(psi.0.quants[3, , ])), \n                           elev = elev.pred.vals, \n                                 sp.codes = rep(sp.codes, \n                                                each = length(elev.pred.vals)))\n\nggplot(psi.plot.dat, aes(x = elev, y = psi.med)) + \n  geom_ribbon(aes(ymin = psi.low, ymax = psi.high), fill = 'grey70') +\n  geom_line() + \n  facet_wrap(vars(sp.codes)) + \n  theme_bw() + \n  labs(x = 'elevation (m)', y = 'Occupancy Probability') \n\n\n\n\n\n\nCodeout.pred2 &lt;- predict(out, pred.df2) # using non spatial\nstr(out.pred2)\n\nList of 3\n $ psi.0.samples: num [1:1500, 1:22, 1:100] 0.0866 0.0115 0.0288 0.0512 0.0011 ...\n $ z.0.samples  : int [1:1500, 1:22, 1:100] 0 0 0 0 0 0 0 0 0 0 ...\n $ call         : language predict.msPGOcc(object = out, X.0 = pred.df2)\n - attr(*, \"class\")= chr \"predict.msPGOcc\"\n\nCodepsi.0.quants &lt;- apply(out.pred2$psi.0.samples, c(2, 3), quantile, \n                          prob = c(0.025, 0.5, 0.975))\nsp.codes &lt;- attr(data_list$y, \"dimnames\")[[1]]\npsi.plot.dat &lt;- data.frame(psi.med = c(t(psi.0.quants[2, , ])), \n                                 psi.low = c(t(psi.0.quants[1, , ])), \n                                 psi.high = c(t(psi.0.quants[3, , ])), \n                           border_dist = border_dist.pred.vals, \n                                 sp.codes = rep(sp.codes, \n                                                each = length(border_dist.pred.vals)))\n\nggplot(psi.plot.dat, aes(x = border_dist, y = psi.med)) + \n  geom_ribbon(aes(ymin = psi.low, ymax = psi.high), fill = 'grey70') +\n  geom_line() + \n  facet_wrap(vars(sp.codes)) + \n  theme_bw() + \n  labs(x = 'border_dist (m)', y = 'Occupancy Probability') \n\n\n\n\n\n\n\nSpatial Prediction\n\nCode#aggregate  resolution to (factor = 3)\n#transform coord data to UTM\nelevation_UTM &lt;- project(elevation_17, \"EPSG:32717\")\nelevation_17.aggregate &lt;- aggregate(elevation_UTM, fact=10)\nres(elevation_17.aggregate)\n\n[1] 768.0792 768.0792\n\nCode# Convert the SpatRaster to a data frame with coordinates\ndf_coords &lt;- as.data.frame(elevation_17.aggregate, xy = TRUE)\nnames(df_coords) &lt;-c(\"X\",\"Y\",\"elev\")\n\nelev.pred &lt;- (df_coords$elev - mean(data_list$occ.covs$elev)) / sd(data_list$occ.covs$elev)\n\npredict_data &lt;- cbind(1, 0, elev.pred)# intercept=1, (border_dist), (elev)\n\n# X.0 &lt;- cbind(1, 1, elev.pred)#, elev.pred^2)\n\n# coords.0 &lt;- as.matrix(hbefElev[, c('Easting', 'Northing')])\nout.sp.ms.pred &lt;- predict(out.sp, \n                          X.0=predict_data, \n                          df_coords[,1:2],\n                          threads=4)\n\nWarning in predict.sfMsPGOcc(out.sp, X.0 = predict_data, df_coords[, 1:2], :\n'threads' is not an argument\n\n\n----------------------------------------\n    Prediction description\n----------------------------------------\nSpatial Factor NNGP Multispecies Occupancy model with Polya-Gamma latent\nvariable fit with 134 observations.\n\nNumber of covariates 3 (including intercept if specified).\n\nUsing the exponential spatial correlation model.\n\nUsing 15 nearest neighbors.\nUsing 3 latent spatial factors.\n\nNumber of MCMC samples 3000.\n\nPredicting at 5073 non-sampled locations.\n\n\nSource compiled with OpenMP support and model fit using 1 threads.\n-------------------------------------------------\n        Predicting\n-------------------------------------------------\nLocation: 100 of 5073, 1.97%\nLocation: 200 of 5073, 3.94%\nLocation: 300 of 5073, 5.91%\nLocation: 400 of 5073, 7.88%\nLocation: 500 of 5073, 9.86%\nLocation: 600 of 5073, 11.83%\nLocation: 700 of 5073, 13.80%\nLocation: 800 of 5073, 15.77%\nLocation: 900 of 5073, 17.74%\nLocation: 1000 of 5073, 19.71%\nLocation: 1100 of 5073, 21.68%\nLocation: 1200 of 5073, 23.65%\nLocation: 1300 of 5073, 25.63%\nLocation: 1400 of 5073, 27.60%\nLocation: 1500 of 5073, 29.57%\nLocation: 1600 of 5073, 31.54%\nLocation: 1700 of 5073, 33.51%\nLocation: 1800 of 5073, 35.48%\nLocation: 1900 of 5073, 37.45%\nLocation: 2000 of 5073, 39.42%\nLocation: 2100 of 5073, 41.40%\nLocation: 2200 of 5073, 43.37%\nLocation: 2300 of 5073, 45.34%\nLocation: 2400 of 5073, 47.31%\nLocation: 2500 of 5073, 49.28%\nLocation: 2600 of 5073, 51.25%\nLocation: 2700 of 5073, 53.22%\nLocation: 2800 of 5073, 55.19%\nLocation: 2900 of 5073, 57.17%\nLocation: 3000 of 5073, 59.14%\nLocation: 3100 of 5073, 61.11%\nLocation: 3200 of 5073, 63.08%\nLocation: 3300 of 5073, 65.05%\nLocation: 3400 of 5073, 67.02%\nLocation: 3500 of 5073, 68.99%\nLocation: 3600 of 5073, 70.96%\nLocation: 3700 of 5073, 72.94%\nLocation: 3800 of 5073, 74.91%\nLocation: 3900 of 5073, 76.88%\nLocation: 4000 of 5073, 78.85%\nLocation: 4100 of 5073, 80.82%\nLocation: 4200 of 5073, 82.79%\nLocation: 4300 of 5073, 84.76%\nLocation: 4400 of 5073, 86.73%\nLocation: 4500 of 5073, 88.70%\nLocation: 4600 of 5073, 90.68%\nLocation: 4700 of 5073, 92.65%\nLocation: 4800 of 5073, 94.62%\nLocation: 4900 of 5073, 96.59%\nLocation: 5000 of 5073, 98.56%\nLocation: 5073 of 5073, 100.00%\nGenerating latent occupancy state\n\nCode# extract the array of interest= occupancy\npredicted_array &lt;- out.sp.ms.pred$psi.0.samples\n\ndim(predicted_array)\n\n[1] 3000   22 5073\n\nCodedf_plot &lt;- NA\npredicted_raster_list &lt;- list() # rast(nrows = 52, ncols = 103,\n                         #ext(elevation_17.aggregate), \n                         # crs = \"EPSG:32717\")\n\n#### Loop to extract rasters to a list\n#array order: itera=3000, sp=22, pixels=5202\nfor (i in 1:dim(predicted_array)[2]){\n # Convert array slice to data frame\n df_plot[i] &lt;- as.data.frame(predicted_array[1, i, ]) # sp_i\n # Producing an SDM for all (posterior mean)\n plot.dat &lt;- data.frame(x = df_coords$X, \n                        y = df_coords$Y, \n                        psi.sp = df_plot[i])\n pred_rast &lt;- rast(plot.dat, \n                   type = \"xyz\", \n                   crs = \"EPSG:32717\") # Replace EPSG:4326 with your CRS\n predicted_raster_list[[i]] &lt;- pred_rast\n}\n\n# Convert the list to a SpatRaster stack\npredictad_raster_stack &lt;- rast(predicted_raster_list)\n# put species names\nnames(predictad_raster_stack) &lt;- selected.sp\n\nplot(predictad_raster_stack)\n\n\n\n\n\n\nCode# get the mean\npredicted_mean &lt;- mean(predictad_raster_stack)\n\nplot(predicted_mean, main=\"mean occupancy\")\n\n\n\n\n\n\nCode# \n#     \n# dat.stars &lt;- st_as_stars(plot.dat.1, dims = c('x', 'y'))\n# ggplot() + \n#   geom_stars(data = dat.stars, aes(x = x, y = y, fill = psi.sp1)) +\n#   scale_fill_viridis_c(na.value = 'transparent') + \n#   labs(x = 'Easting', y = 'Northing', fill = '', \n#        title = 'Mean OVEN occurrence probability using intPGOcc') +\n#   theme_bw()\n# \n# \n# \n# \n# # Producing an SDM for all (posterior mean)\n# plot.dat &lt;- data.frame(x = df_coords$X, \n#                        y = df_coords$Y, \n#                        mean.psi = apply(out.sp.ms.pred$psi.0.samples, c(2,3), mean)[1:5202], \n#                        sd.psi = apply(out.sp.ms.pred$psi.0.samples, c(2,3), sd)[1:5202])\n# \n# \n# library(stars)\n# dat.stars &lt;- st_as_stars(plot.dat.1, dims = c('x', 'y'))\n# ggplot() + \n#   geom_stars(data = dat.stars, aes(x = x, y = y, fill = psi.sp1)) +\n#   scale_fill_viridis_c(na.value = 'transparent') + \n#   labs(x = 'Easting', y = 'Northing', fill = '', \n#        title = 'Mean OVEN occurrence probability using intPGOcc') +\n#   theme_bw()"
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html#package-citation",
    "href": "blog/2025-10-15-analysis/index.html#package-citation",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "Package Citation",
    "text": "Package Citation\n\nCodepkgs &lt;- cite_packages(output = \"paragraph\", pkgs=\"Session\", out.dir = \".\")\n# knitr::kable(pkgs)\npkgs\n\nWe used R v. 4.4.2 (R Core Team 2024) and the following R packages: abind v. 1.4.8 (Plate and Heiberger 2024), bayesplot v. 1.11.1 (Gabry et al. 2019; Gabry and Mahr 2024), beepr v. 2.0 (Bååth 2024), camtrapR v. 2.3.1 (Niedballa et al. 2016), coda v. 0.19.4.1 (Plummer et al. 2006), DT v. 0.34.0 (Xie et al. 2025), elevatr v. 0.99.0 (Hollister et al. 2023), maps v. 3.4.3 (Becker et al. 2025), mapview v. 2.11.4 (Appelhans et al. 2025), MCMCvis v. 0.16.3 (Youngflesh 2018), sf v. 1.0.21 (Pebesma 2018; Pebesma and Bivand 2023), snow v. 0.4.4 (Tierney et al. 2021), snowfall v. 1.84.6.3 (Knaus 2023), spOccupancy v. 0.8.0 (Doser et al. 2022, 2024; Doser, Finley, and Banerjee 2023), terra v. 1.8.60 (Hijmans 2025), tictoc v. 1.2.1 (Izrailev 2024), tidyverse v. 2.0.0 (Wickham et al. 2019), tmap v. 4.2 (Tennekes 2018)."
  },
  {
    "objectID": "blog/2025-10-15-analysis/index.html#sesion-info",
    "href": "blog/2025-10-15-analysis/index.html#sesion-info",
    "title": "Fitting a Spatial Factor Multi-Species Occupancy Model",
    "section": "Sesion info",
    "text": "Sesion info\n\n\n\n\n\n\nNote\n\n\n\n\n\n\nCodeprint(sessionInfo(), locale = FALSE)\n\nR version 4.4.2 (2024-10-31 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 10 x64 (build 19045)\n\nMatrix products: internal\n\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] abind_1.4-8       lubridate_1.9.4   forcats_1.0.0     stringr_1.5.2    \n [5] dplyr_1.1.4       purrr_1.1.0       readr_2.1.5       tidyr_1.3.1      \n [9] tibble_3.2.1      ggplot2_4.0.0     tidyverse_2.0.0   spOccupancy_0.8.0\n[13] camtrapR_2.3.1    snowfall_1.84-6.3 snow_0.4-4        beepr_2.0        \n[17] coda_0.19-4.1     MCMCvis_0.16.3    tictoc_1.2.1      bayesplot_1.11.1 \n[21] elevatr_0.99.0    terra_1.8-60      tmap_4.2          maps_3.4.3       \n[25] mapview_2.11.4    sf_1.0-21         DT_0.34.0         readxl_1.4.3     \n[29] grateful_0.3.0   \n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3      tensorA_0.36.2.1        rstudioapi_0.17.1      \n  [4] audio_0.1-11            jsonlite_2.0.0          wk_0.9.4               \n  [7] magrittr_2.0.3          farver_2.1.2            nloptr_2.1.1           \n [10] rmarkdown_2.29          vctrs_0.6.5             minqa_1.2.8            \n [13] base64enc_0.1-3         RcppNumerical_0.6-0     htmltools_0.5.8.1      \n [16] leafsync_0.1.0          progress_1.2.3          distributional_0.5.0   \n [19] curl_7.0.0              raster_3.6-32           cellranger_1.1.0       \n [22] s2_1.1.9                sass_0.4.10             bslib_0.9.0            \n [25] slippymath_0.3.1        KernSmooth_2.23-24      htmlwidgets_1.6.4      \n [28] plyr_1.8.9              cachem_1.1.0            stars_0.6-8            \n [31] uuid_1.2-1              lifecycle_1.0.4         iterators_1.0.14       \n [34] pkgconfig_2.0.3         cols4all_0.8-1          Matrix_1.7-1           \n [37] R6_2.6.1                fastmap_1.2.0           digest_0.6.37          \n [40] colorspace_2.1-1        leafem_0.2.4            crosstalk_1.2.1        \n [43] labeling_0.4.3          lwgeom_0.2-14           progressr_0.15.0       \n [46] spacesXYZ_1.6-0         timechange_0.3.0        httr_1.4.7             \n [49] mgcv_1.9-1              compiler_4.4.2          microbenchmark_1.5.0   \n [52] proxy_0.4-27            withr_3.0.2             doParallel_1.0.17      \n [55] backports_1.5.0         brew_1.0-10             S7_0.2.0               \n [58] DBI_1.2.3               logger_0.4.0            MASS_7.3-61            \n [61] maptiles_0.10.0         tmaptools_3.3           leaflet_2.2.3          \n [64] classInt_0.4-11         tools_4.4.2             units_0.8-7            \n [67] leaflegend_1.2.1        glue_1.8.0              satellite_1.0.5        \n [70] nlme_3.1-166            grid_4.4.2              checkmate_2.3.2        \n [73] reshape2_1.4.4          generics_0.1.3          leaflet.providers_2.0.0\n [76] gtable_0.3.6            tzdb_0.4.0              class_7.3-22           \n [79] data.table_1.17.8       hms_1.1.3               sp_2.2-0               \n [82] RANN_2.6.2              foreach_1.5.2           pillar_1.11.1          \n [85] posterior_1.6.1         splines_4.4.2           lattice_0.22-6         \n [88] tidyselect_1.2.1        knitr_1.50              svglite_2.1.3          \n [91] stats4_4.4.2            xfun_0.52               leafpop_0.1.0          \n [94] stringi_1.8.4           rematch_2.0.0           yaml_2.3.10            \n [97] boot_1.3-31             evaluate_1.0.4          codetools_0.2-20       \n[100] cli_3.6.5               RcppParallel_5.1.9      systemfonts_1.1.0      \n[103] jquerylib_0.1.4         secr_5.1.0              dichromat_2.0-0.1      \n[106] Rcpp_1.1.0              spAbundance_0.2.1       png_0.1-8              \n[109] XML_3.99-0.18           parallel_4.4.2          prettyunits_1.2.0      \n[112] lme4_1.1-35.5           mvtnorm_1.3-2           scales_1.4.0           \n[115] e1071_1.7-16            crayon_1.5.3            rlang_1.1.6"
  }
]